----------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  psweight_example
       log:  C:\Users\kkranker\Documents\Stata\Ado\Devel\gmatch\psweight_example.log
  log type:  text
 opened on:   7 Mar 2019, 22:10:19

. 
. // ***************************************************************************
. *! $Id: psweight_example.do,v e03361461984 2019/03/08 05:09:09 kkranker $
. *! Generalization of IPW and CBPS estimators
. *! Example files
. //
. *! By Keith Kranker
. // Last updated $Date: 2019/03/08 05:09:09 $
. //
. // Copyright (C) Mathematica Policy Research, Inc.
. // This code cannot be copied, distributed or used without the express written
. // permission of Mathematica Policy Research, Inc.
. // ***************************************************************************
. 
. version 15.1

. set type double

. di as txt "Current user: `c(username)'" _n "Environment: `c(os)' `c(machine_type)' `: environment computername'" _n "Stata: `c(stata_version)'" cond(c(stata_v
> ersion)==c(version),""," (set to version `c(version)')") _n "Date: " c(current_date) " " c(current_time)
Current user: KKranker
Environment: Windows PC (64-bit x86-64) KKRANKER
Stata: 15.1
Date:  7 Mar 2019 22:10:19

. 
. which psweight
.\psweight.ado
*! $Id: psweight.ado,v e03361461984 2019/03/08 05:09:09 kkranker $
*! IPW- and CBPS-type propensity score reweighting, with extentions
*! Stata command to estimate models
*! By Keith Kranker

. mata: mata describe using lpsweight
(library contains 54 members)


      # bytes   type                        name and extent
-------------------------------------------------------------------------------
        2,276   auto void                   optimize_init_mlopts()
        4,312   auto classdef scalar        psweight()
          852   auto real matrix             ::Ct()
          208   auto real rowvector          ::asd()
        1,500   auto void                    ::balanceresults()
        1,852   auto real matrix             ::balancetable()
          628   auto void                    ::calcN()
          816   auto void                    ::calccovariances()
          320   auto void                    ::calcmeans()
          576   auto void                    ::calcvariances()
          348   auto real rowvector          ::cbps()
        2,136   auto void                    ::cbps_port_r()
          768   auto void                    ::cbps_port_stata()
          676   auto real matrix             ::cbps_port_stata_gradient()
          752   auto real colvector          ::cbps_port_stata_moments()
        1,668   auto real matrix             ::cbps_port_stata_wgt_matrix()
        3,312   auto void                    ::cbpseval()
          348   auto real rowvector          ::cbpsoid()
          592   auto void                    ::clone()
          568   auto real rowvector          ::diagvariance()
          168   auto real rowvector          ::diff()
          336   auto real scalar             ::entropydistance()
          968   auto void                    ::get_scores()
          712   auto real rowvector          ::ipw()
        1,900   auto real rowvector          ::logitbeta()
          524   auto real colvector          ::logitpredict()
        1,296   auto real colvector          ::logitweights()
          320   auto real scalar             ::max_asd()
          328   auto real scalar             ::mean_asd()
          428   auto real scalar             ::mean_sd_sq()
           96   auto void                    ::new()
          688   auto real rowvector          ::olsbeta()
          468   auto real colvector          ::olspredict()
          268   auto real rowvector          ::pomean()
          756   auto void                    ::postbeta()
        1,960   auto real rowvector          ::progdiff()
        6,564   auto real rowvector          ::psweight()
          728   auto void                    ::reweight()
          224   auto real rowvector          ::sd_sq()
        1,616   auto void                    ::set()
          264   auto void                    ::set_Y()
          852   auto real rowvector          ::stddiff()
        2,052   auto real rowvector          ::stdprogdiff()
          512   auto real colvector          ::trim()
          636   auto void                    ::userweight()
          168   auto real rowvector          ::varratio()
          288   auto real scalar             ::wgt_cv()
          356   auto real scalar             ::wgt_kurtosis()
          580   auto real scalar             ::wgt_max()
          784   auto real rowvector          ::wgt_moments()
          228   auto real scalar             ::wgt_sd()
          372   auto real scalar             ::wgt_skewness()
          412   auto void                   psweight_cbps_eval()
          504   auto void                   psweight_logit_eval()
-------------------------------------------------------------------------------

. 
. ************************************************************************************
. * Describe/summarize the example datasets
. ************************************************************************************
. 
. *** Input data file (simple_cattaneo_data) comes from the program named Make_example_datasets.do (in C:\Users\kkranker\Documents\Stata\Multiple-Equation-Model
> s)
. 
. use "C:\Users\kkranker\Documents\Stata\Multiple-Equation-Models\simple_cattaneo_data.dta"
(Cattaneo (2010) study on the effect of maternal smoking on birth weight)

. desc, short

Contains data from C:\Users\kkranker\Documents\Stata\Multiple-Equation-Models\simple_cattaneo_data.dta
  obs:         4,642                          Cattaneo (2010) study on the effect of maternal smoking on birth weight
 vars:            11                          8 Apr 2015 05:07
 size:        55,704                          
Sorted by: 

. notes _dta

_dta:
  1.  Cattaneo (2010) study on the effect of maternal smoking on birth weight
  2.  Dataset created by Keith Kranker (program name: make_example_datasets.do)
  3.  Source: Cattaneo, M. D. 2010. "Efficient Semiparametric Estimation of Multi-Valued Treatment Effects under Ignorability." Journal of Econometrics, 155(2):
      138–154, doi:10.1016/j.jeconom.2009.09.023.
  4.  Source: Almond, D., Chay, K.Y., Lee, D.S., 2005. "The costs of low birth weight." Quarterly Journal of Economics, 120: 1031-1083.
  5.  Original dataset downloaded 4/3/2015 via Stata command ". webuse cattaneo2"
  6.  The variable names in the original datasets are replaced with "generic" names: (1) The outcome variables are named y1 y2 y3... (2) The treatment variable
      is named treat (binary) or treat_cat (categorical). (3) The control variables are named x1 x2 x3...

. summ, sep(0)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       treat |      4,642    .1861267    .3892508          0          1
   treat_cat |      4,642    .3996122    .8988632          0          3
          x1 |      4,642    .6996984    .4584385          0          1
          x2 |      4,642    .0340371    .1813439          0          1
          x3 |      4,642    .0534252    .2249042          0          1
          x4 |      4,642    .4379578    .4961893          0          1
          x5 |      4,642    26.50452    5.619026         13         45
          x6 |      4,642    12.68957    2.520661          0         17
          x7 |      4,642    6.540069    3.359167          1         12
          y1 |      4,642     3361.68    578.8196        340       5500
   y1_binary |      4,642    .9396812    .2381022          0          1

. tab treat treat_cat, mi

           |                  treat_cat
     treat | Untreated  1st Treat  2nd Treat  3rd Treat |     Total
-----------+--------------------------------------------+----------
 Untreated |     3,778          0          0          0 |     3,778 
   Treated |         0        200        337        327 |       864 
-----------+--------------------------------------------+----------
     Total |     3,778        200        337        327 |     4,642 

. corr treat y1 y1_binary
(obs=4,642)

             |    treat       y1 y1_bin~y
-------------+---------------------------
       treat |   1.0000
          y1 |  -0.1851   1.0000
   y1_binary |  -0.0997   0.5924   1.0000


. 
. local if if _n<=500

. set seed 1

. gen wgt = max(.1,rnormal(2,.4))

. gen fwgt = round(rnormal(2,.4))

. // forvalues i = 20/200 {
. forvalues i = 90/95 {
  2.   gen x`i' = rnormal()
  3. }

. 
. local depvars = "y1 y1_binary"

. local treatvar = "treat"

. local varlist = "x1 i.x2 i.x3 x4 x5 x6 x7 x9*"

. local wgtvar = "wgt"

. local tousevar = "touse"

. local estimate = "atet"

. 
. 
. // some automatic parsing based on options above, since Mata doesn't have this stuff
. if "`wgtvar'"!="" local wgtexp "[iw=`wgtvar']"

. mark    `tousevar' `if' `in' `wgtexp'

. markout `tousevar' `depvars' `treatvar' `varlist'

. local varlist_orig : copy local varlist

. 
. _rmcoll `treatvar' `varlist' if `tousevar' `wgtexp', expand logit touse(`tousevar')


. local varlist `r(varlist)'

. gettoken trash varlist : varlist

. 
. 
. // *******************************
. // * RUN MODELS DIRECTLY IN MATA *
. // *******************************
. 
. mata:
------------------------------------------------- mata (type end to exit) --------------------------------------------------------------------------------------
: 
: depvars  = st_local("depvars" )

: treatvar = st_local("treatvar")

: wgtvar   = st_local("wgtvar"  )

: varlist  = st_local("varlist" )

: tousevar = st_local("tousevar")

: estimate = st_local("estimate")

: // * UNWEIGHTED DATA EXAMPLES *
: 
: D = psweight()

: D.set(treatvar, varlist, tousevar)
  408 control obs
  92 treatment obs
  (Data are unweighted.)

: if (depvars!="") D.set_Y(depvars,tousevar)
> 
> // Misc balance measures
>   D.diff()
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -.2826086957              0   -.0160912191              0   -.0223785166   -.0603154305   -1.101236147   -1.289748508    .1626172208    .1457104569
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15
     ----------------------------------------------------------------------------+
  1    -.0812723301    .0681588142    .0461833248   -.1459731942   -.0148968728  |
     ----------------------------------------------------------------------------+

:   D.stddiff()
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |   -.563336463              .   -.1543415516              .   -.1526193687   -.1210072453    -.202287272   -.8035533326    .0457213254    .1527707004
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15
     ----------------------------------------------------------------------------+
  1      -.08618905    .0648405717    .0493954389   -.1578414414    -.016298459  |
     ----------------------------------------------------------------------------+

:   D.mean_asd()
  .1977078631

:   D.stddiff(1)
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |   -.563336463              .   -.1543415516              .   -.1526193687   -.1210072453    -.202287272   -.8035533326    .0457213254    .1527707004
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15
     ----------------------------------------------------------------------------+
  1      -.08618905    .0648405717    .0493954389   -.1578414414    -.016298459  |
     ----------------------------------------------------------------------------+

:   D.stddiff(0)
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -.6518565108              .   -.0992258067              .   -.1088403741    -.120488729   -.1874830308   -.5658268397    .0492441608    .1472428581
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15
     ----------------------------------------------------------------------------+
  1    -.0808153611    .0677010963    .0466680215   -.1471098503   -.0148355423  |
     ----------------------------------------------------------------------------+

:   D.varratio()
                 1             2             3             4             5             6             7             8             9            10
    +---------------------------------------------------------------------------------------------------------------------------------------------
  1 |  1.338962118             .   .4133172708             .   .5085817193   .9914483579   .8589874442   .4958355659   1.160037045   .9289414423
    +---------------------------------------------------------------------------------------------------------------------------------------------
                11            12            13            14            15
     -----------------------------------------------------------------------+
  1    .8791918375   1.090178798   .8926168505   .8686432131   .8285405428  |
     -----------------------------------------------------------------------+

:   D.progdiff()
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3444.538     3460.475  -15.93746  -.1234546   3460.475
   y1_binary |    .9482656     .9607843  -.0125187  -.3307945   .9607843
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.
                  1              2
    +-------------------------------+
  1 |  -15.93745522   -.0125187159  |
    +-------------------------------+

: 
:   "Balance table before matching"
  Balance table before matching

:   table = D.balancetable(1)
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913        .75  -.2826087  -.5633365   .5016695   1.338962
             |
          x2 |
          0  |  (empty)
          1  |  .0108696   .0269608  -.0160912  -.1543416   .1042572   .4133173
             |
          x3 |
          0  |  (empty)
          1  |  .0217391   .0441176  -.0223785  -.1526194   .1466296   .5085817
             |
          x4 |  .4347826    .495098  -.0603154  -.1210072   .4984448   .9914484
          x5 |  25.46739   26.56863  -1.101236  -.2022873   5.443922   .8589874
          x6 |  11.86957   13.15931  -1.289749  -.8035533   1.605057   .4958356
          x7 |  6.858696   6.696078   .1626172   .0457213   3.556704   1.160037
         x90 |  .0972024   -.048508   .1457105   .1527707   .9537854   .9289414
         x91 | -.0890157  -.0077434  -.0812723  -.0861891   .9429542   .8791918
         x92 |  .0453787  -.0227801   .0681588   .0648406   1.051175   1.090179
         x93 |  .0865687   .0403853   .0461833   .0493954   .9349714   .8926169
         x94 | -.1299173   .0160559  -.1459732  -.1578414   .9248091   .8686432
         x95 | -.0807251  -.0658282  -.0148969  -.0162985    .914005   .8285405
-------------------------------------------------------------------------------
  

: 
: // Replicate CBPS
: 
:   "--- ATE (not overidentified) ---"; ""; ""
  --- ATE (not overidentified) ---
  
  

:     stata(`"cbps `treatvar' `varlist' if `tousevar' , ate      logit optimization_technique("nr") evaluator_type("gf1")"')
Iteration 0:   f(p) =  .00647386  
Iteration 1:   f(p) =  .00451406  
Iteration 2:   f(p) =   .0005336  
Iteration 3:   f(p) =  .00001373  
Iteration 4:   f(p) =  2.637e-08  
Iteration 5:   f(p) =  6.777e-13  
Iteration 6:   f(p) =  1.066e-21  
------------------------------------------------------------------------------
       treat |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
treat        |
          x1 |  -1.441064   .5046768    -2.86   0.004    -2.430213   -.4519161
        1.x2 |  -2.548784   3.501511    -0.73   0.467     -9.41162    4.314051
        1.x3 |   -1.02318   2.005094    -0.51   0.610    -4.953091    2.906732
          x4 |  -.2320966   .5678014    -0.41   0.683    -1.344967    .8807737
          x5 |   .0736983    .042799     1.72   0.085    -.0101862    .1575829
          x6 |  -.4863391   .1923869    -2.53   0.011    -.8634106   -.1092676
          x7 |   .0655415   .0720901     0.91   0.363    -.0757525    .2068354
         x90 |   .0303861    .203675     0.15   0.881    -.3688096    .4295819
         x91 |  -.0236437   .2499136    -0.09   0.925    -.5134655     .466178
         x92 |   .2014652   .2092517     0.96   0.336    -.2086606    .6115911
         x93 |  -.0067202   .2511949    -0.03   0.979    -.4990531    .4856126
         x94 |  -.3662317   .2431817    -1.51   0.132     -.842859    .1103956
         x95 |  -.0080118   .2531324    -0.03   0.975    -.5041423    .4881187
       _cons |   3.127763   1.826429     1.71   0.087    -.4519713    6.707497
------------------------------------------------------------------------------

:     stata(`"cbps_imbalance"')
Total average covariate imbalance: 1.5e-10
Average covariate imbalance on the treated: 1.26

:     D.cbps("ate", 2)
  Step 1 (initial values from logit model):
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  2.590e-08  
Iteration 1:   f(p) =  2.548e-08  (backed up)
Iteration 2:   f(p) =  1.980e-08  
Iteration 3:   f(p) =  1.652e-08  
Iteration 4:   f(p) =  1.627e-08  
Iteration 5:   f(p) =  1.540e-08  
Iteration 6:   f(p) =  1.451e-08  
Iteration 7:   f(p) =  1.377e-08  
Iteration 8:   f(p) =  1.290e-08  
Iteration 9:   f(p) =  1.195e-08  
Iteration 10:  f(p) =  1.168e-08  
Iteration 11:  f(p) =  1.075e-08  
Iteration 12:  f(p) =  1.026e-08  
Iteration 13:  f(p) =  1.005e-08  
Iteration 14:  f(p) =  9.508e-09  
Iteration 15:  f(p) =  9.073e-09  
Iteration 16:  f(p) =  6.349e-09  
Iteration 17:  f(p) =  2.695e-09  
Iteration 18:  f(p) =  2.271e-09  
Iteration 19:  f(p) =  1.849e-09  
Iteration 20:  f(p) =  1.334e-09  
Iteration 21:  f(p) =  1.242e-09  
Iteration 22:  f(p) =  1.145e-09  
Iteration 23:  f(p) =  9.775e-10  
Iteration 24:  f(p) =  9.423e-10  
Iteration 25:  f(p) =  9.361e-10  
Iteration 26:  f(p) =  9.197e-10  
Iteration 27:  f(p) =  9.148e-10  
Iteration 28:  f(p) =  9.029e-10  
Iteration 29:  f(p) =  6.204e-10  
Iteration 30:  f(p) =  3.414e-10  
Iteration 31:  f(p) =  2.995e-10  
Iteration 32:  f(p) =  2.968e-10  
Iteration 33:  f(p) =  2.571e-10  
Iteration 34:  f(p) =  4.385e-11  
Iteration 35:  f(p) =  4.794e-13  
Iteration 36:  f(p) =  6.223e-14  
Iteration 37:  f(p) =  3.066e-15  
Iteration 38:  f(p) =  8.784e-17  
Iteration 39:  f(p) =  2.421e-19  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.441064112              0   -2.548781733              0   -1.023177716   -.2320966662    .0736982739   -.4863389643     .065541507    .0303862407
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.0236434642    .2014653947   -.0067199499   -.3662316718   -.0080121031    3.127762113  |
     -------------------------------------------------------------------------------------------+

:     D.balanceresults("ate",2)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff    sd_pool  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .6750468   .6750468   5.14e-08   1.10e-07   .4688264   1.008511
             |
          x2 |
          0  |  (empty)
          1  |  .0219356   .0219357  -6.56e-08  -4.48e-07   .1466203   1.008508
             |
          x3 |
          0  |  (empty)
          1  |  .0370066   .0370067  -6.07e-08  -3.21e-07   .1889672    1.00851
             |
          x4 |  .4861037   .4861037  -2.26e-08  -4.52e-08   .5003074   1.008511
          x5 |  26.25386   26.25386   8.04e-07   1.28e-07   6.268993   .6747772
          x6 |  12.63471   12.63471  -3.12e-07  -1.33e-07   2.343236   .5637225
          x7 |  6.724952   6.724952  -4.63e-07  -1.38e-07   3.360602   1.190087
         x90 | -.0592248  -.0592245  -2.43e-07  -2.33e-07   1.042785   1.206643
         x91 |  .0116972   .0116974  -1.62e-07  -1.65e-07   .9810721   .9436963
         x92 | -.0041247  -.0041245  -2.73e-07  -2.67e-07   1.020036   1.339887
         x93 |  .0443807    .044381  -2.77e-07  -2.86e-07   .9681889   .8469646
         x94 | -.0856688  -.0856689   8.21e-08   8.08e-08   1.015864   .7767335
         x95 | -.0859152  -.0859155   2.90e-07   2.97e-07   .9766878   .8347647
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  1.19407e-14
  Mean absolute standardized diff.
  2.03999e-07
  Maximum absolute standardized diff.
  4.47721e-07
  C.V. of matching weights:
  .5275372126
  S.D. of matching weights:
  .5275372126
  Skewness of matching weights:
  .2158746778
  Kurtosis of matching weights:
  .0860728677
  Maximum matching weight:
  6.906396288
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3444.163     3444.163   .0000629   4.36e-07   3444.163
   y1_binary |    .9544751     .9544751   2.97e-09   7.35e-08   .9544751
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   "--- ATE overidentified ---"; ""; ""
  --- ATE overidentified ---
  
  

:     stata(`"cbps `treatvar' `varlist' if `tousevar' , ate over logit optimization_technique("nr") evaluator_type("gf1")"')
Iteration 0:   f(p) =  .02441999  (not concave)
Iteration 1:   f(p) =    .020112  
Iteration 2:   f(p) =  .01484746  
Iteration 3:   f(p) =   .0142955  
Iteration 4:   f(p) =  .01428412  
Iteration 5:   f(p) =  .01428407  
Iteration 6:   f(p) =  .01428407  
------------------------------------------------------------------------------
       treat |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
treat        |
          x1 |  -1.074574   .2572873    -4.18   0.000    -1.578848      -.5703
        1.x2 |  -1.732571    .847337    -2.04   0.041    -3.393321   -.0718214
        1.x3 |   -.535995   .6259896    -0.86   0.392    -1.762912    .6909221
          x4 |  -.2389831   .2458124    -0.97   0.331    -.7207666    .2428004
          x5 |   .0484453   .0243181     1.99   0.046     .0007828    .0961078
          x6 |  -.2519975   .0459113    -5.49   0.000    -.3419819    -.162013
          x7 |   .0081703   .0322545     0.25   0.800    -.0550474    .0713879
         x90 |    .120204   .1075227     1.12   0.264    -.0905366    .3309445
         x91 |  -.1467757   .1099013    -1.34   0.182    -.3621782    .0686269
         x92 |   .1315867   .1151671     1.14   0.253    -.0941367    .3573101
         x93 |    .086207   .1113523     0.77   0.439    -.1320395    .3044534
         x94 |  -.1702521    .103099    -1.65   0.099    -.3723225    .0318183
         x95 |   .0217906    .112224     0.19   0.846    -.1981643    .2417456
       _cons |   1.206345   .6074599     1.99   0.047      .015746    2.396945
------------------------------------------------------------------------------
J test for overidentifying restrictions: P(chisq>7.142, 14) = 0.929

:     stata(`"cbps_imbalance"')
Total average covariate imbalance: .313
Average covariate imbalance on the treated: .168

:     D.cbpsoid("ate", 2)
  Step 1 (initial values from logit model):
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  9.768e-08  
Iteration 1:   f(p) =  9.599e-08  (backed up)
Iteration 2:   f(p) =  7.672e-08  
Iteration 3:   f(p) =  6.399e-08  
Iteration 4:   f(p) =  6.304e-08  
Iteration 5:   f(p) =  6.026e-08  
Iteration 6:   f(p) =  5.854e-08  
Iteration 7:   f(p) =  5.801e-08  
Iteration 8:   f(p) =  5.780e-08  
Iteration 9:   f(p) =  5.775e-08  
Iteration 10:  f(p) =  5.764e-08  
Iteration 11:  f(p) =  5.743e-08  
Iteration 12:  f(p) =  5.722e-08  
Iteration 13:  f(p) =  5.718e-08  
Iteration 14:  f(p) =  5.716e-08  
Iteration 15:  f(p) =  5.715e-08  
Iteration 16:  f(p) =  5.715e-08  
Iteration 17:  f(p) =  5.715e-08  
Iteration 18:  f(p) =  5.715e-08  
Iteration 19:  f(p) =  5.714e-08  
Iteration 20:  f(p) =  5.714e-08  
Iteration 21:  f(p) =  5.714e-08  
Iteration 22:  f(p) =  5.714e-08  
Iteration 23:  f(p) =  5.714e-08  
Iteration 24:  f(p) =  5.714e-08  
Iteration 25:  f(p) =  5.714e-08  
Iteration 26:  f(p) =  5.714e-08  
Iteration 27:  f(p) =  5.714e-08  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.074574212              0   -1.732572281              0   -.5359933597   -.2389832282    .0484453449   -.2519975805    .0081703365    .1202040215
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1467758692    .1315865104    .0862071499   -.1702520455    .0217912539    1.206345699  |
     -------------------------------------------------------------------------------------------+

:     D.balanceresults("ate",2)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff    sd_pool  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .6406563   .7027892  -.0621329  -.1343717   .4623962   1.111543
             |
          x2 |
          0  |  (empty)
          1  |  .0157701   .0233767  -.0076066  -.0518321   .1467555   .6856468
             |
          x3 |
          0  |  (empty)
          1  |  .0248069   .0398362  -.0150293  -.0794677   .1891246   .6378532
             |
          x4 |  .4886895   .4862356   .0024538   .0049045   .5003233   1.008759
          x5 |  25.82556   26.34781  -.5222466   -.087499   5.968599     .75999
          x6 |  12.33004    12.9064  -.5763636  -.2576162   2.237296   .5881094
          x7 |  6.884519   6.669732   .2147874   .0639212   3.360189   1.180429
         x90 | -.0713185  -.0265029  -.0448156  -.0441807   1.014371   1.157748
         x91 |  .0200092   -.022611   .0426201   .0430283   .9905145   .9174008
         x92 |  .0040224  -.0083768   .0123991   .0121514   1.020391   1.200576
         x93 |   .022949   .0551791  -.0322301    -.03319   .9710768   .8891007
         x94 | -.1215951  -.0231316  -.0984635  -.0994522    .990058   .8143466
         x95 |  -.095014  -.0715949  -.0234192  -.0239414   .9781896   .8041465
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  .0027971537
  Mean absolute standardized diff.
  .0719658737
  Maximum absolute standardized diff.
  .257616171
  C.V. of matching weights:
  .2958977283
  S.D. of matching weights:
  .2958977283
  Skewness of matching weights:
  .1574499131
  Kurtosis of matching weights:
  .0654319377
  Maximum matching weight:
  4.204591911
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3443.444     3453.946  -10.50206  -.0797226   3453.946
   y1_binary |    .9509072     .9588221  -.0079149  -.2079758   .9588221
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   "--- ATET (not overidentified) ---"; ""; ""
  --- ATET (not overidentified) ---
  
  

:     stata(`"cbps `treatvar' `varlist' if `tousevar' , att      logit optimization_technique("nr") evaluator_type("gf1")"')
Iteration 0:   f(p) =  .00197031  
Iteration 1:   f(p) =  .00006892  
Iteration 2:   f(p) =  1.777e-07  
Iteration 3:   f(p) =  2.570e-12  
Iteration 4:   f(p) =  6.940e-22  
------------------------------------------------------------------------------
       treat |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
treat        |
          x1 |  -1.339291   .3615444    -3.70   0.000    -2.047905   -.6306769
        1.x2 |  -1.525175    1.19071    -1.28   0.200    -3.858923    .8085728
        1.x3 |  -.5996277   .8424377    -0.71   0.477    -2.250775     1.05152
          x4 |  -.3183658   .3103113    -1.03   0.305    -.9265647    .2898331
          x5 |   .0587883     .02835     2.07   0.038     .0032234    .1143533
          x6 |  -.2435676   .0675718    -3.60   0.000    -.3760059   -.1111292
          x7 |   .0341034   .0400884     0.85   0.395    -.0444685    .1126752
         x90 |    .158599   .1286436     1.23   0.218    -.0935378    .4107357
         x91 |  -.1617619    .131618    -1.23   0.219    -.4197284    .0962045
         x92 |   .1391156   .1358437     1.02   0.306    -.1271333    .4053644
         x93 |   .0571151    .134574     0.42   0.671    -.2066451    .3208752
         x94 |  -.1175052   .1193236    -0.98   0.325    -.3513752    .1163649
         x95 |    .011505   .1383574     0.08   0.934    -.2596705    .2826805
       _cons |    .782858    .962964     0.81   0.416    -1.104517    2.670233
------------------------------------------------------------------------------

:     stata(`"cbps_imbalance"')
Total average covariate imbalance: .374
Average covariate imbalance on the treated: 1.1e-10

:     D.cbps("atet", 2)
  Step 1 (initial values from logit model):
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  7.881e-09  
Iteration 1:   f(p) =  7.799e-09  (backed up)
Iteration 2:   f(p) =  7.301e-09  
Iteration 3:   f(p) =  5.045e-09  
Iteration 4:   f(p) =  4.162e-09  
Iteration 5:   f(p) =  3.700e-09  
Iteration 6:   f(p) =  3.063e-09  
Iteration 7:   f(p) =  2.655e-09  
Iteration 8:   f(p) =  2.353e-09  
Iteration 9:   f(p) =  2.232e-09  
Iteration 10:  f(p) =  1.928e-09  
Iteration 11:  f(p) =  1.687e-09  
Iteration 12:  f(p) =  1.155e-09  
Iteration 13:  f(p) =  8.603e-10  
Iteration 14:  f(p) =  7.497e-10  
Iteration 15:  f(p) =  4.770e-10  
Iteration 16:  f(p) =  2.775e-10  
Iteration 17:  f(p) =  7.322e-11  
Iteration 18:  f(p) =  4.498e-11  
Iteration 19:  f(p) =  4.378e-11  
Iteration 20:  f(p) =  3.530e-11  
Iteration 21:  f(p) =  2.766e-11  
Iteration 22:  f(p) =  4.069e-12  
Iteration 23:  f(p) =  1.178e-12  
Iteration 24:  f(p) =  1.153e-12  
Iteration 25:  f(p) =  1.026e-12  
Iteration 26:  f(p) =  7.702e-13  
Iteration 27:  f(p) =  4.187e-13  
Iteration 28:  f(p) =  2.188e-14  
Iteration 29:  f(p) =  2.709e-17  
Iteration 30:  f(p) =  8.507e-20  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.339291259              0   -1.525177249              0   -.5996257473    -.318365882    .0587883581   -.2435674989    .0341033206    .1585989379
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1617619526    .1391154892     .057115033   -.1175051709     .011504942    .7828569769  |
     -------------------------------------------------------------------------------------------+

:     D.balanceresults("atet",2)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff    sd_pool  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913   .4673913  -1.05e-08  -2.10e-08   .4994352   1.008511
             |
          x2 |
          0  |  (empty)
          1  |  .0108696   .0108696   1.35e-08   1.30e-07   .1037928   1.008512
             |
          x3 |
          0  |  (empty)
          1  |  .0217391   .0217392  -3.35e-08  -2.30e-07   .1459767    1.00851
             |
          x4 |  .4347826   .4347826   4.50e-08   9.06e-08   .4962249   1.008511
          x5 |  25.46739   25.46739  -1.03e-06  -1.54e-07   6.664728   .6195799
          x6 |  11.86957   11.86957  -2.86e-07  -1.40e-07   2.043536   .5669465
          x7 |  6.858696   6.858695   3.44e-07   1.02e-07   3.363971   1.145237
         x90 |  .0972024   .0972024   5.59e-08   5.47e-08   1.021603    .845302
         x91 | -.0890157  -.0890157   1.15e-08   1.21e-08   .9556678   .9654928
         x92 |  .0453787   .0453787   2.30e-08   2.30e-08   .9971708   1.136731
         x93 |  .0865687   .0865686   2.88e-08   3.02e-08     .95074   .9577067
         x94 | -.1299173  -.1299172  -2.89e-08  -2.82e-08    1.02511   .7795321
         x95 | -.0807251  -.0807251   7.57e-09   7.89e-09   .9586344   .8888005
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  8.85595e-17
  Mean absolute standardized diff.
  7.87875e-08
  Maximum absolute standardized diff.
  2.29714e-07
  C.V. of matching weights:
  .9884370736
  S.D. of matching weights:
  .9884370736
  Skewness of matching weights:
  .1100078155
  Kurtosis of matching weights:
  .0225364334
  Maximum matching weight:
  7.032259837
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3424.753     3424.753  -.0000267  -1.75e-07   3424.753
   y1_binary |    .9470393     .9470393  -8.59e-09  -1.64e-07   .9470393
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   "--- ATET overidentified ---"; ""; ""
  --- ATET overidentified ---
  
  

:     stata(`"cbps `treatvar' `varlist' if `tousevar' , att over logit optimization_technique("nr") evaluator_type("gf1")"')
Iteration 0:   f(p) =  .04521356  
Iteration 1:   f(p) =  .03210384  
Iteration 2:   f(p) =   .0303286  
Iteration 3:   f(p) =   .0302734  
Iteration 4:   f(p) =  .03027339  
Iteration 5:   f(p) =  .03027339  
------------------------------------------------------------------------------
       treat |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
treat        |
          x1 |  -1.171988   .2187737    -5.36   0.000    -1.600776   -.7431991
        1.x2 |  -1.909814   .6607307    -2.89   0.004    -3.204822   -.6148052
        1.x3 |  -.4402667   .7269474    -0.61   0.545    -1.865057     .984524
          x4 |  -.3130788   .2251092    -1.39   0.164    -.7542848    .1281272
          x5 |   .0503881   .0191417     2.63   0.008     .0128711    .0879051
          x6 |  -.2393185   .0575186    -4.16   0.000     -.352053   -.1265841
          x7 |   .0261168   .0311563     0.84   0.402    -.0349484    .0871821
         x90 |   .1425533   .1007579     1.41   0.157    -.0549285    .3400351
         x91 |  -.1282785   .1127153    -1.14   0.255    -.3491964    .0926393
         x92 |      .1073   .1112316     0.96   0.335    -.1107099    .3253099
         x93 |   .0527165   .1101053     0.48   0.632    -.1630859    .2685189
         x94 |  -.1248021   .0971592    -1.28   0.199    -.3152305    .0656263
         x95 |   .0220743   .1115296     0.20   0.843    -.1965196    .2406683
       _cons |   .9132207   .6048419     1.51   0.131    -.2722476    2.098689
------------------------------------------------------------------------------
J test for overidentifying restrictions: P(chisq>15.137, 14) = 0.369

:     stata(`"cbps_imbalance"')
Total average covariate imbalance:  .34
Average covariate imbalance on the treated: .073

:     D.cbpsoid("atet", 2)
  Step 1 (initial values from logit model):
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  1.809e-07  
Iteration 1:   f(p) =  1.775e-07  (backed up)
Iteration 2:   f(p) =  1.749e-07  
Iteration 3:   f(p) =  1.665e-07  
Iteration 4:   f(p) =  1.593e-07  
Iteration 5:   f(p) =  1.436e-07  
Iteration 6:   f(p) =  1.400e-07  
Iteration 7:   f(p) =  1.356e-07  
Iteration 8:   f(p) =  1.328e-07  
Iteration 9:   f(p) =  1.272e-07  
Iteration 10:  f(p) =  1.231e-07  
Iteration 11:  f(p) =  1.224e-07  
Iteration 12:  f(p) =  1.220e-07  
Iteration 13:  f(p) =  1.219e-07  
Iteration 14:  f(p) =  1.218e-07  
Iteration 15:  f(p) =  1.217e-07  
Iteration 16:  f(p) =  1.213e-07  
Iteration 17:  f(p) =  1.212e-07  
Iteration 18:  f(p) =  1.212e-07  
Iteration 19:  f(p) =  1.212e-07  
Iteration 20:  f(p) =  1.211e-07  
Iteration 21:  f(p) =  1.211e-07  
Iteration 22:  f(p) =  1.211e-07  
Iteration 23:  f(p) =  1.211e-07  
Iteration 24:  f(p) =  1.211e-07  
Iteration 25:  f(p) =  1.211e-07  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.171987645              0   -1.909810926              0   -.4402665865    -.313078715    .0503880742     -.23931849    .0261168193    .1425532856
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1282784975    .1072999568     .052716481   -.1248021071    .0220743372    .9132204078  |
     -------------------------------------------------------------------------------------------+

:     D.balanceresults("atet",2)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff    sd_pool  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913   .4923282  -.0249369  -.0498389   .5003503   1.004458
             |
          x2 |
          0  |  (empty)
          1  |  .0108696   .0074884   .0033811   .0376593   .0897825   1.458884
             |
          x3 |
          0  |  (empty)
          1  |  .0217391    .023711  -.0019719  -.0130452    .151158   .9265074
             |
          x4 |  .4347826    .438673  -.0038904  -.0078335   .4966326   1.006495
          x5 |  25.46739   25.45801   .0093786   .0014149   6.628535   .6273162
          x6 |  11.86957   11.89491  -.0253428  -.0123239     2.0564    .559006
          x7 |  6.858696   6.790863   .0678325    .020134    3.36906   1.140985
         x90 |  .0972024   .0826851   .0145173    .014215   1.021263   .8460037
         x91 | -.0890157  -.0671192  -.0218965  -.0227622   .9619657   .9503048
         x92 |  .0453787   .0235132   .0218655   .0219385   .9966695   1.138269
         x93 |  .0865687   .0849356    .001633   .0017143   .9526181   .9531308
         x94 | -.1299173  -.1339674   .0040502   .0039553   1.023979   .7815571
         x95 | -.0807251  -.0745052  -.0062199  -.0064787   .9600495   .8856706
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  7.49043e-07
  Mean absolute standardized diff.
  .0164087554
  Maximum absolute standardized diff.
  .0498389405
  C.V. of matching weights:
  .9155855656
  S.D. of matching weights:
  .9155855656
  Skewness of matching weights:
  .1040781343
  Kurtosis of matching weights:
  .0213436959
  Maximum matching weight:
  6.683350183
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3424.722     3428.063  -3.341103  -.0220556   3428.063
   y1_binary |    .9470466     .9484255  -.0013789  -.0271541   .9484255
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
: // Other objective functions
:   st_local("mlopts", "difficult nonrtolerance")

:   D.psweight("atet","mean_sd_sq",1)
  Step 1 (initial values from logit model):
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
  
  Step 2 (CBPS) :
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 0:   f(p) =  .00032638  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 1:   f(p) =  8.089e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 2:   f(p) =  5.298e-09  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 3:   f(p) =  1.465e-13  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 4:   f(p) =  2.512e-21  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.206443371              0   -1.628676261              0   -.5803099403   -.2832336977    .0694163114   -.2787869247    .0283208975    .1446874448
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1322012753    .1288212844    .0633599597   -.1645468354    .0190734619    1.379530325  |
     -------------------------------------------------------------------------------------------+

:   D.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913   .5065707  -.0391794   -.078098   .5016695   1.004395
             |
          x2 |
          0  |  (empty)
          1  |  .0108696   .0094032   .0014663   .0140645   .1042572   1.164051
             |
          x3 |
          0  |  (empty)
          1  |  .0217391   .0217076   .0000315   .0002149   .1466296   1.009942
             |
          x4 |  .4347826   .4181832   .0165994   .0333023   .4984448   1.018628
          x5 |  25.46739   26.05541  -.5880199   -.108014   5.443922    .583267
          x6 |  11.86957   11.79935   .0702179   .0437479   1.605057   .5528994
          x7 |  6.858696   6.775281   .0834143   .0234527   3.556704   1.141156
         x90 |  .0972024   .0569965    .040206   .0421541   .9537854   .8487821
         x91 | -.0890157   -.062197  -.0268186  -.0284411   .9429542   .9668971
         x92 |  .0453787   .0391246   .0062541   .0059496   1.051175   1.151879
         x93 |  .0865687   .1044402  -.0178716  -.0191146   .9349714   .9622808
         x94 | -.1299173  -.1873487   .0574315   .0621009   .9248091   .7465145
         x95 | -.0807251  -.0886593   .0079342   .0086807    .914005    .892775
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  2.51158e-21
  Mean absolute standardized diff.
  .0359488717
  Maximum absolute standardized diff.
  .1080140263
  C.V. of matching weights:
  1.041361438
  S.D. of matching weights:
  1.041361438
  Skewness of matching weights:
  .1710882109
  Kurtosis of matching weights:
  .0624918326
  Maximum matching weight:
  11.09499509
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3424.964     3426.474  -1.509908  -.0096045   3426.474
   y1_binary |    .9468831     .9481476  -.0012646  -.0236201   .9481476
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   D.psweight("atet","sd_sq",1)
  Step 1 (initial values from logit model):
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
  
  Step 2 (CBPS) :
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 0:   f(p) =  .02141594  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 1:   f(p) =  .02005607  (backed up)
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 2:   f(p) =  .01097598  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 3:   f(p) =  .00782372  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 4:   f(p) =  .00292673  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 5:   f(p) =  .00193285  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 6:   f(p) =  .00085471  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 7:   f(p) =  .00063406  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 8:   f(p) =  .00028285  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 9:   f(p) =  .00013476  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 10:  f(p) =  .00008047  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 11:  f(p) =  .00006325  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 12:  f(p) =   .0000443  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 13:  f(p) =  .00003941  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 14:  f(p) =  .00003494  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 15:  f(p) =  .00001414  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 16:  f(p) =  9.450e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 17:  f(p) =  8.233e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 18:  f(p) =  4.845e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 19:  f(p) =  1.918e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 20:  f(p) =  1.597e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 21:  f(p) =  1.597e-07  (backed up)
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.339093652              0   -1.522717609              0   -.6024628488   -.3184010774    .0587700712   -.2435593968    .0341082902    .1586103724
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1617896689    .1392853356    .0571801245   -.1174440772    .0116347969    1.412922783  |
     -------------------------------------------------------------------------------------------+

:   D.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913   .4673974  -6.08e-06  -.0000121   .5016695   1.008509
             |
          x2 |
          0  |  (empty)
          1  |  .0108696    .010884  -.0000145  -.0001389   .1042572   1.007184
             |
          x3 |
          0  |  (empty)
          1  |  .0217391   .0216918   .0000474   .0003231   .1466296   1.010665
             |
          x4 |  .4347826   .4347917  -9.14e-06  -.0000183   .4984448   1.008506
          x5 |  25.46739   25.46699   .0004057   .0000745   5.443922   .6196141
          x6 |  11.86957   11.86965  -.0000811  -.0000505   1.605057   .5669426
          x7 |  6.858696   6.858709  -.0000131  -3.67e-06   3.556704   1.145253
         x90 |  .0972024   .0972214   -.000019  -.0000199   .9537854   .8453063
         x91 | -.0890157  -.0890341   .0000185   .0000196   .9429542   .9654774
         x92 |  .0453787   .0455054  -.0001267  -.0001205   1.051175   1.136737
         x93 |  .0865687   .0866238  -.0000552   -.000059   .9349714   .9577098
         x94 | -.1299173  -.1298667  -.0000506  -.0000547   .9248091   .7795587
         x95 | -.0807251  -.0806563  -.0000688  -.0000753    .914005   .8888531
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  1.09082e-10
  Mean absolute standardized diff.
  .0000746269
  Maximum absolute standardized diff.
  .0003230882
  C.V. of matching weights:
  .9883930978
  S.D. of matching weights:
  .9883930978
  Skewness of matching weights:
  .1100109822
  Kurtosis of matching weights:
  .0225378377
  Maximum matching weight:
  7.031258646
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3424.753     3424.752   .0006725   4.41e-06   3424.752
   y1_binary |    .9470393     .9470403  -1.04e-06  -.0000198   .9470403
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   if (depvars!="") {
>     D.psweight("atet","stdprogdiff",1)
>     D.balanceresults("atet",1)
>   }
>   st_local("mlopts", "")
  Step 1 (initial values from logit model):
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
  
  Step 2 (CBPS) :
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 0:   f(p) =  .00185472  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 1:   f(p) =  .00101577  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 2:   f(p) =   .0002704  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 3:   f(p) =  7.072e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 4:   f(p) =  1.219e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 5:   f(p) =  2.602e-12  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 6:   f(p) =  2.535e-16  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.206433971              0   -1.628882657              0   -.5801519123   -.2842213062    .0680367247   -.2812704152    .0362353508    .1401283403
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1333669581    .1293804005    .0654367018   -.1708389949    .0205356918    1.379492684  |
     -------------------------------------------------------------------------------------------+
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913   .5034076  -.0360163  -.0717928   .5016695   1.004268
             |
          x2 |
          0  |  (empty)
          1  |  .0108696   .0094204   .0014491   .0138997   .1042572   1.161948
             |
          x3 |
          0  |  (empty)
          1  |  .0217391   .0216619   .0000772   .0005268   .1466296   1.012028
             |
          x4 |  .4347826   .4201252   .0146574   .0294062   .4984448   1.017315
          x5 |  25.46739   25.99281  -.5254175  -.0965145   5.443922   .5838652
          x6 |  11.86957   11.78734   .0822302   .0512319   1.605057   .5554978
          x7 |  6.858696   6.858079   .0006171   .0001735   3.556704   1.143915
         x90 |  .0972024   .0536862   .0435163   .0456248   .9537854    .847646
         x91 | -.0890157  -.0631464  -.0258693  -.0274343   .9429542    .968103
         x92 |  .0453787   .0348442   .0105345   .0100216   1.051175   1.154518
         x93 |  .0865687   .1037557   -.017187  -.0183824   .9349714   .9597356
         x94 | -.1299173  -.1918307   .0619134   .0669473   .9248091   .7493635
         x95 | -.0807251  -.0849593   .0042342   .0046326    .914005   .8909529
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  4.11614e-07
  Mean absolute standardized diff.
  .0335837223
  Maximum absolute standardized diff.
  .0965145126
  C.V. of matching weights:
  1.045817005
  S.D. of matching weights:
  1.045817005
  Skewness of matching weights:
  .1663221078
  Kurtosis of matching weights:
  .0587525915
  Maximum matching weight:
  10.93728965
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3424.984     3424.984   2.41e-06   1.52e-08   3424.984
   y1_binary |    .9469116     .9469116   2.49e-10   4.59e-09   .9469116
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
: // IPW
:   stata("teffects ipw (`:word 1 of `depvars'') (`treatvar' `varlist') if `tousevar' , atet aequations")

Iteration 0:   EE criterion =  5.570e-18  
Iteration 1:   EE criterion =  4.891e-26  

Treatment-effects estimation                    Number of obs     =        500
Estimator      : inverse-probability weights
Outcome model  : weighted mean
Treatment model: logit
-----------------------------------------------------------------------------------------
                        |               Robust
                     y1 |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
ATET                    |
                  treat |
(Treated vs Untreated)  |  -365.5251   68.93598    -5.30   0.000    -500.6371   -230.4131
------------------------+----------------------------------------------------------------
POmean                  |
                  treat |
             Untreated  |   3417.895   43.41569    78.72   0.000     3332.801    3502.988
------------------------+----------------------------------------------------------------
TME1                    |
                     x1 |  -1.207512   .3268258    -3.69   0.000    -1.848079   -.5669452
                        |
                     x2 |
                     1  |  -1.628792   1.054719    -1.54   0.123    -3.696005    .4384199
                        |
                     x3 |
                     1  |  -.5805318   .8259794    -0.70   0.482    -2.199422    1.038358
                     x4 |  -.2831153   .2838113    -1.00   0.318    -.8393752    .2731445
                     x5 |   .0545179   .0270259     2.02   0.044     .0015481    .1074878
                     x6 |  -.2844593   .0688093    -4.13   0.000     -.419323   -.1495955
                     x7 |    .023871   .0390129     0.61   0.541    -.0525929    .1003349
                    x90 |   .1439494   .1292697     1.11   0.265    -.1094145    .3973133
                    x91 |  -.1331182   .1248073    -1.07   0.286    -.3777361    .1114997
                    x92 |   .1277527    .133834     0.95   0.340    -.1345572    .3900625
                    x93 |   .0623585   .1243317     0.50   0.616    -.1813271    .3060441
                    x94 |  -.1663354   .1194682    -1.39   0.164    -.4004887    .0678179
                    x95 |    .017776   .1254901     0.14   0.887    -.2281801     .263732
                  _cons |   1.379538   .9297905     1.48   0.138    -.4428177    3.201894
-----------------------------------------------------------------------------------------

:   stata("di _b[POmean:0.treat]")
3417.8947

:   stata("tebalance summarize")

  Covariate balance summary
                                                   Raw     Weighted
                          -----------------------------------------
                          Number of obs =          500        500.0
                          Treated obs   =           92        247.8
                          Control obs   =          408        252.2
                          -----------------------------------------

  -----------------------------------------------------------------
                  |Standardized differences          Variance ratio
                  |        Raw    Weighted           Raw   Weighted
  ----------------+------------------------------------------------
               x1 |  -.6027752   -.0090577      1.338962   .9989677
                  |
               x2 |
               1  |  -.1180374    .0096998      .4133173   1.098626
                  |
               x3 |
               1  |  -.1253201    .0022927      .5085817   1.015318
                  |
               x4 |  -.1207472   -.0222549      .9914484   .9947225
               x5 |  -.1944638    .0308855      .8589874   .5917507
               x6 |  -.6542694    .0952268      .4958356   .5601212
               x7 |   .0473848    .0429284      1.160037   1.132231
              x90 |   .1499304    .0130255      .9289414   .8182649
              x91 |  -.0833726   -.0288848      .8791918   .9584288
              x92 |   .0662245    .0110605      1.090179   1.139468
              x93 |   .0479737   -.0087695      .8926169   .9659809
              x94 |  -.1521926    .0562648      .8686432   .7583723
              x95 |  -.0155155     .017858      .8285405   .8879817
  -----------------------------------------------------------------

:   stata("tebalance summarize, baseline")

  Covariate balance summary
                                                   Raw     Weighted
                          -----------------------------------------
                          Number of obs =          500        500.0
                          Treated obs   =           92        247.8
                          Control obs   =          408        252.2
                          -----------------------------------------

  -----------------------------------------------------------------
                  |           Means                  Variances     
                  |    Control     Treated       Control    Treated
  ----------------+------------------------------------------------
               x1 |        .75    .4673913      .1879607   .2516722
                  |
               x2 |
               1  |   .0269608    .0108696      .0262984   .0108696
                  |
               x3 |
               1  |   .0441176    .0217391      .0422749   .0215002
                  |
               x4 |    .495098    .4347826      .2505902   .2484472
               x5 |   26.56863    25.46739      34.50142   29.63629
               x6 |   13.15931    11.86957      5.195687   2.576206
               x7 |   6.696078    6.858696      10.90495   12.65014
              x90 |   -.048508    .0972024      .9792937   .9097065
              x91 |  -.0077434   -.0890157      1.011341   .8891627
              x92 |  -.0227801    .0453787      1.013567    1.10497
              x93 |   .0403853    .0865687      .9793358   .8741716
              x94 |   .0160559   -.1299173      .9846065   .8552718
              x95 |  -.0658282   -.0807251      1.008285   .8354051
  -----------------------------------------------------------------

: 
:   D.ipw("atet")
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.207511889              0   -1.628789303              0   -.5805311787   -.2831151519    .0545179195   -.2844591547    .0238709472    .1439493409
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1331181677    .1277525867    .0623584609   -.1663353313    .0177759207    1.379537286  |
     -------------------------------------------------------------------------------------------+

:   D.balanceresults("atet")
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff    sd_pool  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913   .4719209  -.0045296  -.0090652   .4996633   1.007399
             |
          x2 |
          0  |  (empty)
          1  |  .0108696   .0098847   .0009849   .0098566   .0999227   1.107894
             |
          x3 |
          0  |  (empty)
          1  |  .0217391   .0214054   .0003337   .0023004   .1450795   1.023886
             |
          x4 |  .4347826    .445852  -.0110694  -.0222576   .4973308   1.003118
          x5 |  25.46739   25.27307   .1943233   .0286772   6.776222    .596745
          x6 |  11.86957   11.68981   .1797533   .0877664   2.048089   .5648484
          x7 |  6.858696   6.711046   .1476493   .0438323   3.368502   1.141787
         x90 |  .0972024   .0841522   .0130502    .012645   1.032043   .8251709
         x91 | -.0890157  -.0615794  -.0274362  -.0287197   .9553102   .9665176
         x92 |  .0453787   .0341522   .0112265   .0113068    .992897   1.149085
         x93 |  .0865687   .0948113  -.0082427  -.0087305     .94412   .9741335
         x94 | -.1299173  -.1857505   .0558332   .0540116   1.033726   .7647728
         x95 | -.0807251  -.0974964   .0167713   .0175493   .9556712   .8954759
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  .0002347319
  Mean absolute standardized diff.
  .0259014405
  Maximum absolute standardized diff.
  .0877663592
  C.V. of matching weights:
  1.041445134
  S.D. of matching weights:
  1.041445134
  Skewness of matching weights:
  .1334759573
  Kurtosis of matching weights:
  .0358990807
  Maximum matching weight:
  9.288959251
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3424.454     3417.895   6.559175   .0419488   3417.895
   y1_binary |    .9470413     .9465176   .0005237    .009748   .9465176
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

:   table = D.balancetable(3)
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff     sd_avg  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913   .4719209  -.0045296  -.0090456   .5007475   1.007399
             |
          x2 |
          0  |  (empty)
          1  |  .0108696   .0098847   .0009849   .0096855   .1016872   1.107894
             |
          x3 |
          0  |  (empty)
          1  |  .0217391   .0214054   .0003337   .0022895   .1457719   1.023886
             |
          x4 |  .4347826    .445852  -.0110694  -.0222252   .4980573   1.003118
          x5 |  25.46739   25.27307   .1943233   .0308606   6.296806    .596745
          x6 |  11.86957   11.68981   .1797533   .0951549   1.889059   .5648484
          x7 |  6.858696   6.711046   .1476493    .042865   3.444517   1.141787
         x90 |  .0972024   .0841522   .0130502   .0130107   1.003034   .8251709
         x91 | -.0890157  -.0615794  -.0274362  -.0288473   .9510857   .9665176
         x92 |  .0453787   .0341522   .0112265   .0110442   1.016508   1.149085
         x93 |  .0865687   .0948113  -.0082427   -.008758   .9411576   .9741335
         x94 | -.1299173  -.1857505   .0558332   .0562053   .9933796   .7647728
         x95 | -.0807251  -.0974964   .0167713   .0178362   .9402985   .8954759
-------------------------------------------------------------------------------
  

:   D.reweight()

:   table = D.balancetable(3)
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff     sd_avg  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913        .75  -.2826087  -.6027752   .4688459   1.338962
             |
          x2 |
          0  |  (empty)
          1  |  .0108696   .0269608  -.0160912  -.1180374    .136323   .4133173
             |
          x3 |
          0  |  (empty)
          1  |  .0217391   .0441176  -.0223785  -.1253201   .1785709   .5085817
             |
          x4 |  .4347826    .495098  -.0603154  -.1207472   .4995185   .9914484
          x5 |  25.46739   26.56863  -1.101236  -.1944638   5.662937   .8589874
          x6 |  11.86957   13.15931  -1.289749  -.6542694    1.97128   .4958356
          x7 |  6.858696   6.696078   .1626172   .0473848   3.431843   1.160037
         x90 |  .0972024   -.048508   .1457105   .1499304    .971854   .9289414
         x91 | -.0890157  -.0077434  -.0812723  -.0833726   .9748086   .8791918
         x92 |  .0453787  -.0227801   .0681588   .0662245   1.029208   1.090179
         x93 |  .0865687   .0403853   .0461833   .0479737   .9626805   .8926169
         x94 | -.1299173   .0160559  -.1459732  -.1521926   .9591346   .8686432
         x95 | -.0807251  -.0658282  -.0148969  -.0155155   .9601277   .8285405
-------------------------------------------------------------------------------
  

: 
:   stata("teffects ipw (`:word 1 of `depvars'') (`treatvar' `varlist') if `tousevar' , ate aequations")

Iteration 0:   EE criterion =  5.570e-18  
Iteration 1:   EE criterion =  2.096e-25  

Treatment-effects estimation                    Number of obs     =        500
Estimator      : inverse-probability weights
Outcome model  : weighted mean
Treatment model: logit
-----------------------------------------------------------------------------------------
                        |               Robust
                     y1 |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
ATE                     |
                  treat |
(Treated vs Untreated)  |   -328.878   82.21905    -4.00   0.000    -490.0244   -167.7316
------------------------+----------------------------------------------------------------
POmean                  |
                  treat |
             Untreated  |   3452.527   28.58753   120.77   0.000     3396.497    3508.558
------------------------+----------------------------------------------------------------
TME1                    |
                     x1 |  -1.207512   .3268258    -3.69   0.000    -1.848079   -.5669452
                        |
                     x2 |
                     1  |  -1.628792   1.054719    -1.54   0.123    -3.696005    .4384199
                        |
                     x3 |
                     1  |  -.5805318   .8259794    -0.70   0.482    -2.199422    1.038358
                     x4 |  -.2831153   .2838113    -1.00   0.318    -.8393752    .2731445
                     x5 |   .0545179   .0270259     2.02   0.044     .0015481    .1074878
                     x6 |  -.2844593   .0688093    -4.13   0.000     -.419323   -.1495955
                     x7 |    .023871   .0390129     0.61   0.541    -.0525929    .1003349
                    x90 |   .1439494   .1292697     1.11   0.265    -.1094145    .3973133
                    x91 |  -.1331182   .1248073    -1.07   0.286    -.3777361    .1114997
                    x92 |   .1277527    .133834     0.95   0.340    -.1345572    .3900625
                    x93 |   .0623585   .1243317     0.50   0.616    -.1813271    .3060441
                    x94 |  -.1663354   .1194682    -1.39   0.164    -.4004887    .0678179
                    x95 |    .017776   .1254901     0.14   0.887    -.2281801     .263732
                  _cons |   1.379538   .9297905     1.48   0.138    -.4428177    3.201894
-----------------------------------------------------------------------------------------

:   D.ipw("ate")
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.207511889              0   -1.628789303              0   -.5805311787   -.2831151519    .0545179195   -.2844591547    .0238709472    .1439493409
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1331181677    .1277525867    .0623584609   -.1663353313    .0177759207    1.379537286  |
     -------------------------------------------------------------------------------------------+

:   D.balanceresults("ate")
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff    sd_pool  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .6643106   .6980937  -.0337831  -.0730952   .4621798   1.067096
             |
          x2 |
          0  |  (empty)
          1  |  .0126474   .0237734   -.011126  -.0762399    .145934   .5426396
             |
          x3 |
          0  |  (empty)
          1  |  .0252967   .0398782  -.0145815  -.0769757   .1894293   .6494649
             |
          x4 |  .5035684   .4859058   .0176626   .0352982    .500383   1.009262
          x5 |  25.88638    26.3268  -.4404207  -.0736253    5.98192   .7436049
          x6 |  12.40345   12.88502  -.4815643   -.214612   2.243884   .5994444
          x7 |  6.783391   6.698872   .0845182   .0251498    3.36059   1.188955
         x90 | -.1279394  -.0237456  -.1041937  -.1022979   1.018533   1.179133
         x91 |  .0259183  -.0177924   .0437107   .0442269   .9883275   .9105384
         x92 |  .0197006  -.0121531   .0318537   .0312437   1.019527   1.201641
         x93 |  .0303493   .0505445  -.0201952  -.0208151   .9702151   .8788976
         x94 |  -.142924  -.0216133  -.1213108  -.1226343   .9892079   .7980325
         x95 | -.0930146  -.0717394  -.0212752  -.0217631   .9775833   .7971968
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  .0024703949
  Mean absolute standardized diff.
  .0706136183
  Maximum absolute standardized diff.
  .2146119669
  C.V. of matching weights:
  .3337259557
  S.D. of matching weights:
  .3337259557
  Skewness of matching weights:
  .184312389
  Kurtosis of matching weights:
  .0838509711
  Maximum matching weight:
  4.898168754
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3442.587     3452.527  -9.940045  -.0756667   3452.527
   y1_binary |    .9516224     .9581213  -.0064989  -.1701548   .9581213
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   stata("teffects ipw (`:word 1 of `depvars'') (`treatvar' `varlist') if `tousevar' , atet aequations tlevel(0) control(1)")

Iteration 0:   EE criterion =  5.570e-18  
Iteration 1:   EE criterion =  4.050e-26  

Treatment-effects estimation                    Number of obs     =        500
Estimator      : inverse-probability weights
Outcome model  : weighted mean
Treatment model: logit
-----------------------------------------------------------------------------------------
                        |               Robust
                     y1 |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
ATET                    |
                  treat |
(Untreated vs Treated)  |     319.07   91.15096     3.50   0.000     140.4174    497.7225
------------------------+----------------------------------------------------------------
POmean                  |
                  treat |
               Treated  |   3141.406   87.28586    35.99   0.000     2970.328    3312.483
------------------------+----------------------------------------------------------------
TME0                    |
                     x1 |   1.207512   .3268258     3.69   0.000     .5669452    1.848079
                        |
                     x2 |
                     1  |   1.628792   1.054719     1.54   0.123    -.4384199    3.696005
                        |
                     x3 |
                     1  |   .5805318   .8259794     0.70   0.482    -1.038358    2.199422
                     x4 |   .2831153   .2838113     1.00   0.318    -.2731445    .8393752
                     x5 |  -.0545179   .0270259    -2.02   0.044    -.1074878   -.0015481
                     x6 |   .2844593   .0688093     4.13   0.000     .1495955     .419323
                     x7 |   -.023871   .0390129    -0.61   0.541    -.1003349    .0525929
                    x90 |  -.1439494   .1292697    -1.11   0.265    -.3973133    .1094145
                    x91 |   .1331182   .1248073     1.07   0.286    -.1114997    .3777361
                    x92 |  -.1277527    .133834    -0.95   0.340    -.3900625    .1345572
                    x93 |  -.0623585   .1243317    -0.50   0.616    -.3060441    .1813271
                    x94 |   .1663354   .1194682     1.39   0.164    -.0678179    .4004887
                    x95 |   -.017776   .1254901    -0.14   0.887     -.263732    .2281801
                  _cons |  -1.379538   .9297905    -1.48   0.138    -3.201894    .4428177
-----------------------------------------------------------------------------------------

:   D.ipw("ateu")
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.207511889              0   -1.628789303              0   -.5805311787   -.2831151519    .0545179195   -.2844591547    .0238709472    .1439493409
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1331181677    .1277525867    .0623584609   -.1663353313    .0177759207    1.379537286  |
     -------------------------------------------------------------------------------------------+

:   D.balanceresults("ateu")
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff    sd_pool  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .7133644        .75  -.0366356  -.0837821   .4372727   1.099818
             |
          x2 |
          0  |  (empty)
          1  |  .0130902   .0269608  -.0138706  -.0897954   .1544686   .4966403
             |
          x3 |
          0  |  (empty)
          1  |  .0261829   .0441176  -.0179347  -.0905493   .1980657    .609761
             |
          x4 |  .5207033    .495098   .0256053   .0511594   .5005007   1.006879
          x5 |  25.99075   26.56863   -.577878  -.1002906   5.762036   .7963305
          x6 |  12.53645   13.15931  -.6228673  -.2813566     2.2138   .6382822
          x7 |  6.764632   6.696078   .0685532   .0204092   3.358927   1.200431
         x90 | -.1840235   -.048508  -.1355155  -.1337092   1.013509   1.263776
         x91 |   .054549  -.0077434   .0622924   .0625861   .9953062   .8955527
         x92 |   .013304  -.0227801   .0360842   .0351881   1.025465    1.21557
         x93 |  .0163448   .0403853  -.0240406  -.0246383   .9757395    .857822
         x94 | -.1461641   .0160559  -.1622201  -.1661874    .976127   .8119355
         x95 |  -.096076  -.0658282  -.0302478  -.0307892   .9824155   .7755988
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  .0040935914
  Mean absolute standardized diff.
  .0900339258
  Maximum absolute standardized diff.
  .2813566293
  C.V. of matching weights:
  .8301616288
  S.D. of matching weights:
  .8301616288
  Skewness of matching weights:
  .2680619565
  Kurtosis of matching weights:
  .1550433582
  Maximum matching weight:
  5.869225813
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |     3447.97     3460.475  -12.50512  -.0958312   3460.475
   y1_binary |    .9524694     .9607843  -.0083149  -.2347296   .9607843
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
: // tradeoff between CBPS-like balance and variance in weights
:   D.cbps("atet", 1)
  Step 1 (initial values from logit model):
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  7.881e-09  
Iteration 1:   f(p) =  7.799e-09  (backed up)
Iteration 2:   f(p) =  7.301e-09  
Iteration 3:   f(p) =  5.045e-09  
Iteration 4:   f(p) =  4.162e-09  
Iteration 5:   f(p) =  3.700e-09  
Iteration 6:   f(p) =  3.063e-09  
Iteration 7:   f(p) =  2.655e-09  
Iteration 8:   f(p) =  2.353e-09  
Iteration 9:   f(p) =  2.232e-09  
Iteration 10:  f(p) =  1.928e-09  
Iteration 11:  f(p) =  1.687e-09  
Iteration 12:  f(p) =  1.155e-09  
Iteration 13:  f(p) =  8.603e-10  
Iteration 14:  f(p) =  7.497e-10  
Iteration 15:  f(p) =  4.770e-10  
Iteration 16:  f(p) =  2.775e-10  
Iteration 17:  f(p) =  7.322e-11  
Iteration 18:  f(p) =  4.498e-11  
Iteration 19:  f(p) =  4.378e-11  
Iteration 20:  f(p) =  3.530e-11  
Iteration 21:  f(p) =  2.766e-11  
Iteration 22:  f(p) =  4.069e-12  
Iteration 23:  f(p) =  1.178e-12  
Iteration 24:  f(p) =  1.153e-12  
Iteration 25:  f(p) =  1.026e-12  
Iteration 26:  f(p) =  7.702e-13  
Iteration 27:  f(p) =  4.187e-13  
Iteration 28:  f(p) =  2.188e-14  
Iteration 29:  f(p) =  2.709e-17  
Iteration 30:  f(p) =  8.507e-20  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.339291259              0   -1.525177249              0   -.5996257473    -.318365882    .0587883581   -.2435674989    .0341033206    .1585989379
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1617619526    .1391154892     .057115033   -.1175051709     .011504942    .7828569769  |
     -------------------------------------------------------------------------------------------+

:   D.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913   .4673913  -1.05e-08  -2.09e-08   .5016695   1.008511
             |
          x2 |
          0  |  (empty)
          1  |  .0108696   .0108696   1.35e-08   1.30e-07   .1042572   1.008512
             |
          x3 |
          0  |  (empty)
          1  |  .0217391   .0217392  -3.35e-08  -2.29e-07   .1466296    1.00851
             |
          x4 |  .4347826   .4347826   4.50e-08   9.02e-08   .4984448   1.008511
          x5 |  25.46739   25.46739  -1.03e-06  -1.89e-07   5.443922   .6195799
          x6 |  11.86957   11.86957  -2.86e-07  -1.78e-07   1.605057   .5669465
          x7 |  6.858696   6.858695   3.44e-07   9.67e-08   3.556704   1.145237
         x90 |  .0972024   .0972024   5.59e-08   5.86e-08   .9537854    .845302
         x91 | -.0890157  -.0890157   1.15e-08   1.22e-08   .9429542   .9654928
         x92 |  .0453787   .0453787   2.30e-08   2.19e-08   1.051175   1.136731
         x93 |  .0865687   .0865686   2.88e-08   3.08e-08   .9349714   .9577067
         x94 | -.1299173  -.1299172  -2.89e-08  -3.12e-08   .9248091   .7795321
         x95 | -.0807251  -.0807251   7.57e-09   8.28e-09    .914005   .8888005
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  2.36461e-16
  Mean absolute standardized diff.
  8.43300e-08
  Maximum absolute standardized diff.
  2.28691e-07
  C.V. of matching weights:
  .9884370736
  S.D. of matching weights:
  .9884370736
  Skewness of matching weights:
  .1100078155
  Kurtosis of matching weights:
  .0225364334
  Maximum matching weight:
  7.032259837
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3424.753     3424.753  -.0000267  -1.75e-07   3424.753
   y1_binary |    .9470393     .9470393  -8.59e-09  -1.64e-07   .9470393
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   D.psweight("atet","cbps", 1, (1,.75,6))
  Step 1 (initial values from logit model):
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  .00061284  
Iteration 1:   f(p) =  2.180e-07  
Iteration 2:   f(p) =  1.269e-07  
Iteration 3:   f(p) =  1.206e-07  
Iteration 4:   f(p) =  1.176e-07  
Iteration 5:   f(p) =  1.170e-07  
Iteration 6:   f(p) =  1.170e-07  
Iteration 7:   f(p) =  1.161e-07  
Iteration 8:   f(p) =  8.908e-08  
Iteration 9:   f(p) =  8.321e-08  
Iteration 10:  f(p) =  8.293e-08  
Iteration 11:  f(p) =  8.279e-08  
Iteration 12:  f(p) =  8.224e-08  
Iteration 13:  f(p) =  8.214e-08  
Iteration 14:  f(p) =  8.209e-08  
Iteration 15:  f(p) =  8.207e-08  
Iteration 16:  f(p) =  8.207e-08  
Iteration 17:  f(p) =  8.207e-08  
Iteration 18:  f(p) =  8.206e-08  
Iteration 19:  f(p) =  8.191e-08  
Iteration 20:  f(p) =  7.969e-08  
Iteration 21:  f(p) =  7.849e-08  
Iteration 22:  f(p) =  7.612e-08  
Iteration 23:  f(p) =  7.604e-08  
Iteration 24:  f(p) =  7.603e-08  
Iteration 25:  f(p) =  7.602e-08  
Iteration 26:  f(p) =  7.602e-08  
Iteration 27:  f(p) =  7.602e-08  
Iteration 28:  f(p) =  7.602e-08  
Iteration 29:  f(p) =  7.601e-08  
Iteration 30:  f(p) =  7.596e-08  
Iteration 31:  f(p) =  7.449e-08  
Iteration 32:  f(p) =  7.272e-08  
Iteration 33:  f(p) =  6.357e-08  
Iteration 34:  f(p) =  5.430e-08  
Iteration 35:  f(p) =  5.188e-08  
Iteration 36:  f(p) =  4.995e-08  
Iteration 37:  f(p) =  4.832e-08  
Iteration 38:  f(p) =  4.824e-08  
Iteration 39:  f(p) =  4.804e-08  
Iteration 40:  f(p) =  4.804e-08  
Iteration 41:  f(p) =  4.803e-08  
Iteration 42:  f(p) =  4.803e-08  
Iteration 43:  f(p) =  4.803e-08  
Iteration 44:  f(p) =  4.803e-08  
Iteration 45:  f(p) =  4.795e-08  
Iteration 46:  f(p) =  4.645e-08  
Iteration 47:  f(p) =  3.640e-08  
Iteration 48:  f(p) =  3.539e-08  
Iteration 49:  f(p) =  3.424e-08  
Iteration 50:  f(p) =  3.417e-08  
Iteration 51:  f(p) =  3.414e-08  
Iteration 52:  f(p) =  3.413e-08  
Iteration 53:  f(p) =  3.413e-08  
Iteration 54:  f(p) =  3.413e-08  
Iteration 55:  f(p) =  3.413e-08  
Iteration 56:  f(p) =  3.413e-08  
Iteration 57:  f(p) =  3.405e-08  
Iteration 58:  f(p) =  3.013e-08  
Iteration 59:  f(p) =  2.794e-08  
Iteration 60:  f(p) =  2.777e-08  
Iteration 61:  f(p) =  2.757e-08  
Iteration 62:  f(p) =  2.755e-08  
Iteration 63:  f(p) =  2.755e-08  
Iteration 64:  f(p) =  2.755e-08  
Iteration 65:  f(p) =  2.755e-08  
Iteration 66:  f(p) =  2.755e-08  
Iteration 67:  f(p) =  2.754e-08  
Iteration 68:  f(p) =  2.745e-08  
Iteration 69:  f(p) =  2.364e-08  
Iteration 70:  f(p) =  1.903e-08  
Iteration 71:  f(p) =  1.749e-08  
Iteration 72:  f(p) =  1.724e-08  
Iteration 73:  f(p) =  1.720e-08  
Iteration 74:  f(p) =  1.719e-08  
Iteration 75:  f(p) =  1.719e-08  
Iteration 76:  f(p) =  1.719e-08  
Iteration 77:  f(p) =  1.719e-08  
Iteration 78:  f(p) =  1.719e-08  
Iteration 79:  f(p) =  1.715e-08  
Iteration 80:  f(p) =  1.440e-08  
Iteration 81:  f(p) =  1.395e-08  
Iteration 82:  f(p) =  1.393e-08  
Iteration 83:  f(p) =  1.393e-08  
Iteration 84:  f(p) =  1.393e-08  
Iteration 85:  f(p) =  1.393e-08  
Iteration 86:  f(p) =  1.393e-08  
Iteration 87:  f(p) =  1.393e-08  
Iteration 88:  f(p) =  1.391e-08  
Iteration 89:  f(p) =  1.364e-08  
Iteration 90:  f(p) =  1.239e-08  
Iteration 91:  f(p) =  1.213e-08  
Iteration 92:  f(p) =  1.213e-08  
Iteration 93:  f(p) =  1.213e-08  
Iteration 94:  f(p) =  1.213e-08  
Iteration 95:  f(p) =  1.213e-08  
Iteration 96:  f(p) =  1.213e-08  
Iteration 97:  f(p) =  1.212e-08  
Iteration 98:  f(p) =  1.186e-08  
Iteration 99:  f(p) =  1.179e-08  
Iteration 100: f(p) =  1.179e-08  
Iteration 101: f(p) =  1.179e-08  
Iteration 102: f(p) =  1.179e-08  
Iteration 103: f(p) =  1.179e-08  
Iteration 104: f(p) =  1.179e-08  
Iteration 105: f(p) =  1.179e-08  
Iteration 106: f(p) =  1.177e-08  
Iteration 107: f(p) =  1.176e-08  
Iteration 108: f(p) =  1.176e-08  
Iteration 109: f(p) =  1.176e-08  
Iteration 110: f(p) =  1.176e-08  
Iteration 111: f(p) =  1.176e-08  
Iteration 112: f(p) =  1.176e-08  
Iteration 113: f(p) =  1.165e-08  
Iteration 114: f(p) =  1.151e-08  
Iteration 115: f(p) =  1.150e-08  
Iteration 116: f(p) =  1.150e-08  
Iteration 117: f(p) =  1.150e-08  
Iteration 118: f(p) =  1.150e-08  
Iteration 119: f(p) =  1.150e-08  
Iteration 120: f(p) =  1.150e-08  
convergence not achieved
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.073656211              0   -1.357287313              0   -.4260989683   -.2443951147    .0448679936   -.1989581336    .0255953153    .1234826268
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1253124383    .1000966911    .0449222914   -.0972899179   -.0000551876    .4469634125  |
     -------------------------------------------------------------------------------------------+

:   D.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913   .5178884  -.0504971  -.1006582   .5016695   1.005509
             |
          x2 |
          0  |  (empty)
          1  |  .0108696   .0120498  -.0011802  -.0113201   .1042572   .9108199
             |
          x3 |
          0  |  (empty)
          1  |  .0217391   .0254584  -.0037193   -.025365   .1466296   .8644626
             |
          x4 |  .4347826   .4525163  -.0177337  -.0355781   .4984448   1.000375
          x5 |  25.46739   25.54116  -.0737717  -.0135512   5.443922   .6518205
          x6 |  11.86957   12.06734  -.1977701  -.1232169   1.605057    .544754
          x7 |  6.858696   6.810735    .047961   .0134847   3.556704   1.145576
         x90 |  .0972024   .0714512   .0257512    .026999   .9537854   .8605208
         x91 | -.0890157  -.0724667  -.0165489  -.0175501   .9429542   .9393164
         x92 |  .0453787    .026232   .0191467   .0182146   1.051175   1.126467
         x93 |  .0865687    .074332   .0122367   .0130878   .9349714    .935284
         x94 | -.1299173  -.0987471  -.0311702  -.0337045   .9248091   .7976929
         x95 | -.0807251  -.0887859   .0080608   .0088193    .914005   .8754237
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  .0004650287
  Mean absolute standardized diff.
  .0339653292
  Maximum absolute standardized diff.
  .1232169149
  C.V. of matching weights:
  .778078592
  S.D. of matching weights:
  .778078592
  Skewness of matching weights:
  .0865248149
  Kurtosis of matching weights:
  .0155157827
  Maximum matching weight:
  4.987644238
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3425.503     3432.804  -7.301175  -.0500692   3432.804
   y1_binary |    .9471279     .9495997  -.0024718  -.0513101   .9495997
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   D.psweight("atet","cbps", 1, (1,.50,6))
  Step 1 (initial values from logit model):
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  .02519573  
Iteration 1:   f(p) =  .00037232  
Iteration 2:   f(p) =  .00018115  
Iteration 3:   f(p) =  .00007047  
Iteration 4:   f(p) =  .00006335  
Iteration 5:   f(p) =  .00005995  
Iteration 6:   f(p) =  .00003158  
Iteration 7:   f(p) =  .00001706  
Iteration 8:   f(p) =  .00001448  
Iteration 9:   f(p) =  .00001017  
Iteration 10:  f(p) =  9.753e-06  
Iteration 11:  f(p) =  9.539e-06  
Iteration 12:  f(p) =  9.503e-06  
Iteration 13:  f(p) =  9.419e-06  
Iteration 14:  f(p) =  8.004e-06  
Iteration 15:  f(p) =  7.195e-06  
Iteration 16:  f(p) =  7.087e-06  
Iteration 17:  f(p) =  3.985e-06  
Iteration 18:  f(p) =  2.991e-06  
Iteration 19:  f(p) =  1.995e-06  
Iteration 20:  f(p) =  1.368e-06  
Iteration 21:  f(p) =  1.304e-06  
Iteration 22:  f(p) =  1.290e-06  
Iteration 23:  f(p) =  1.271e-06  
Iteration 24:  f(p) =  1.266e-06  
Iteration 25:  f(p) =  1.264e-06  
Iteration 26:  f(p) =  1.263e-06  
Iteration 27:  f(p) =  1.259e-06  
Iteration 28:  f(p) =  1.148e-06  
Iteration 29:  f(p) =  3.117e-07  
Iteration 30:  f(p) =  1.157e-07  
Iteration 31:  f(p) =  1.078e-07  
Iteration 32:  f(p) =  1.048e-07  
Iteration 33:  f(p) =  9.478e-08  
Iteration 34:  f(p) =  9.352e-08  
Iteration 35:  f(p) =  9.230e-08  
Iteration 36:  f(p) =  8.645e-08  
Iteration 37:  f(p) =  8.118e-08  
Iteration 38:  f(p) =  7.987e-08  
Iteration 39:  f(p) =  7.976e-08  
Iteration 40:  f(p) =  7.976e-08  
Iteration 41:  f(p) =  7.976e-08  
Iteration 42:  f(p) =  7.976e-08  
Iteration 43:  f(p) =  7.975e-08  
Iteration 44:  f(p) =  7.975e-08  
Iteration 45:  f(p) =  7.975e-08  
Iteration 46:  f(p) =  7.975e-08  
Iteration 47:  f(p) =  7.975e-08  
Iteration 48:  f(p) =  7.975e-08  
Iteration 49:  f(p) =  7.975e-08  
Iteration 50:  f(p) =  7.973e-08  
Iteration 51:  f(p) =  7.946e-08  
Iteration 52:  f(p) =  7.808e-08  
Iteration 53:  f(p) =  7.697e-08  
Iteration 54:  f(p) =  7.688e-08  
Iteration 55:  f(p) =  7.688e-08  
Iteration 56:  f(p) =  7.688e-08  
Iteration 57:  f(p) =  7.688e-08  
Iteration 58:  f(p) =  7.688e-08  
Iteration 59:  f(p) =  7.687e-08  
Iteration 60:  f(p) =  7.382e-08  
Iteration 61:  f(p) =  7.267e-08  
Iteration 62:  f(p) =  7.261e-08  
Iteration 63:  f(p) =  7.261e-08  
Iteration 64:  f(p) =  7.261e-08  
Iteration 65:  f(p) =  7.261e-08  
Iteration 66:  f(p) =  7.261e-08  
Iteration 67:  f(p) =  7.260e-08  
Iteration 68:  f(p) =  7.144e-08  
Iteration 69:  f(p) =  6.561e-08  
Iteration 70:  f(p) =  5.732e-08  
Iteration 71:  f(p) =  5.540e-08  
Iteration 72:  f(p) =  5.399e-08  
Iteration 73:  f(p) =  5.389e-08  
Iteration 74:  f(p) =  5.386e-08  
Iteration 75:  f(p) =  5.385e-08  
Iteration 76:  f(p) =  5.385e-08  
Iteration 77:  f(p) =  5.385e-08  
Iteration 78:  f(p) =  5.385e-08  
Iteration 79:  f(p) =  5.384e-08  
Iteration 80:  f(p) =  5.363e-08  
Iteration 81:  f(p) =  5.307e-08  
Iteration 82:  f(p) =  5.292e-08  
Iteration 83:  f(p) =  5.292e-08  
Iteration 84:  f(p) =  5.292e-08  
Iteration 85:  f(p) =  5.292e-08  
Iteration 86:  f(p) =  5.292e-08  
Iteration 87:  f(p) =  5.292e-08  
Iteration 88:  f(p) =  5.291e-08  
Iteration 89:  f(p) =  5.235e-08  
Iteration 90:  f(p) =  5.217e-08  
Iteration 91:  f(p) =  5.216e-08  
Iteration 92:  f(p) =  5.215e-08  
Iteration 93:  f(p) =  5.215e-08  
Iteration 94:  f(p) =  5.215e-08  
Iteration 95:  f(p) =  5.215e-08  
Iteration 96:  f(p) =  5.215e-08  
Iteration 97:  f(p) =  5.215e-08  
Iteration 98:  f(p) =  5.212e-08  
Iteration 99:  f(p) =  5.211e-08  
Iteration 100: f(p) =  5.211e-08  
Iteration 101: f(p) =  5.211e-08  
Iteration 102: f(p) =  5.211e-08  
Iteration 103: f(p) =  5.211e-08  
Iteration 104: f(p) =  5.210e-08  
Iteration 105: f(p) =  5.209e-08  
Iteration 106: f(p) =  5.156e-08  
Iteration 107: f(p) =  5.137e-08  
Iteration 108: f(p) =  5.137e-08  
Iteration 109: f(p) =  5.137e-08  
Iteration 110: f(p) =  5.137e-08  
Iteration 111: f(p) =  5.137e-08  
Iteration 112: f(p) =  5.137e-08  
Iteration 113: f(p) =  5.137e-08  
Iteration 114: f(p) =  5.127e-08  
Iteration 115: f(p) =  5.124e-08  
Iteration 116: f(p) =  5.124e-08  
Iteration 117: f(p) =  5.124e-08  
Iteration 118: f(p) =  5.124e-08  
Iteration 119: f(p) =  5.124e-08  
Iteration 120: f(p) =  5.124e-08  
convergence not achieved
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -.7224023699              0   -1.021344412              0    -.294033939   -.1690249045    .0287638197   -.1461145258    .0165971962    .0850386842
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.0877086818     .064571659    .0348086267   -.0665577743   -.0074344266   -.0748029846  |
     -------------------------------------------------------------------------------------------+

:   D.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913   .5905559  -.1231646  -.2455094   .5016695   1.038279
             |
          x2 |
          0  |  (empty)
          1  |  .0108696    .014679  -.0038094  -.0365386   .1042572   .7496746
             |
          x3 |
          0  |  (empty)
          1  |  .0217391   .0298417  -.0081026   -.055259   .1466296   .7408168
             |
          x4 |  .4347826   .4668714  -.0320888  -.0643778   .4984448   .9957243
          x5 |  25.46739   25.76506  -.2976736    -.05468   5.443922   .6999714
          x6 |  11.86957   12.34453   -.474962  -.2959161   1.605057   .5220083
          x7 |  6.858696   6.762718   .0959776    .026985   3.556704   1.148817
         x90 |  .0972024   .0378192   .0593833   .0622606   .9537854   .8843411
         x91 | -.0890157  -.0568697   -.032146  -.0340908   .9429542   .9109494
         x92 |  .0453787   .0106761   .0347026   .0330132   1.051175   1.115449
         x93 |  .0865687    .066231   .0203377   .0217522   .9349714   .9143301
         x94 | -.1299173  -.0574975  -.0724197  -.0783078   .9248091   .8187332
         x95 | -.0807251  -.0932284   .0125033   .0136797    .914005     .86217
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  .0029575921
  Mean absolute standardized diff.
  .0786438504
  Maximum absolute standardized diff.
  .2959160614
  C.V. of matching weights:
  .5321577
  S.D. of matching weights:
  .5321577
  Skewness of matching weights:
  .0630178827
  Kurtosis of matching weights:
  .0107803689
  Maximum matching weight:
  3.266346648
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3428.445     3442.407   -13.9619  -.1011781   3442.407
   y1_binary |     .947451     .9529074  -.0054564  -.1239468   .9529074
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   st_local("mlopts", "difficult nonrtolerance")

:   D.psweight("atet","mean_sd_sq", 1, (1,.75,6))
  Step 1 (initial values from logit model):
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
  
  Step 2 (CBPS) :
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 0:   f(p) =  .00093921  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 1:   f(p) =  .00042753  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 2:   f(p) =  .00003686  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 3:   f(p) =  .00002767  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 4:   f(p) =  .00001518  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 5:   f(p) =  6.684e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 6:   f(p) =  3.117e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 7:   f(p) =  1.306e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 8:   f(p) =  3.889e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 9:   f(p) =  1.977e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 10:  f(p) =  7.501e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 11:  f(p) =  5.838e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 12:  f(p) =  4.674e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 13:  f(p) =  4.256e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 14:  f(p) =  3.975e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 15:  f(p) =  3.921e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 16:  f(p) =  3.899e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 17:  f(p) =  3.886e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 18:  f(p) =  1.448e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 19:  f(p) =  4.466e-09  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 20:  f(p) =  1.208e-10  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 21:  f(p) =  1.072e-10  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 22:  f(p) =  6.703e-11  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 23:  f(p) =  2.985e-11  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 24:  f(p) =  1.985e-11  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.160046004              0   -1.628440882              0   -.5814356689   -.2659448749    .0170283471   -.0953923866   -.0355685797    .0835475886
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1365717091    .0826969528    .0139935752   -.1221270986    -.003240174    1.406408582  |
     -------------------------------------------------------------------------------------------+

:   D.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913   .4906044  -.0232131  -.0462717   .5016695   1.004576
             |
          x2 |
          0  |  (empty)
          1  |  .0108696   .0090275    .001842   .0176681   .1042572   1.212036
             |
          x3 |
          0  |  (empty)
          1  |  .0217391   .0197194   .0020197   .0137741   .1466296   1.109514
             |
          x4 |  .4347826   .4805567  -.0457741  -.0918339   .4984448   .9928544
          x5 |  25.46739   24.90307   .5643257   .1036616   5.443922    .728936
          x6 |  11.86957   12.30349  -.4339289  -.2703512   1.605057   .5293091
          x7 |  6.858696    6.15658   .7021156   .1974063   3.556704   1.137638
         x90 |  .0972024   .0737146   .0234879   .0246259   .9537854   .8425804
         x91 | -.0890157  -.0912725   .0022568   .0023933   .9429542    .935052
         x92 |  .0453787   .0468218  -.0014432  -.0013729   1.051175   1.108073
         x93 |  .0865687   .0544884   .0320802   .0343114   .9349714   .9460123
         x94 | -.1299173  -.1374836   .0075663   .0081815   .9248091   .8219538
         x95 | -.0807251  -.0878851     .00716   .0078336    .914005   .8758486
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  4.04309e-12
  Mean absolute standardized diff.
  .063052741
  Maximum absolute standardized diff.
  .27035119
  C.V. of matching weights:
  .7658421581
  S.D. of matching weights:
  .7658421581
  Skewness of matching weights:
  .0880496553
  Kurtosis of matching weights:
  .0148451646
  Maximum matching weight:
  4.315297317
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3429.056     3447.255  -18.19924  -.1299997   3447.255
   y1_binary |    .9477352     .9592501  -.0115149  -.2660966   .9592501
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   D.psweight("atet","mean_sd_sq", 1, (1,.50,6))
  Step 1 (initial values from logit model):
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
  
  Step 2 (CBPS) :
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 0:   f(p) =   .0255221  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 1:   f(p) =  .00707055  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 2:   f(p) =  .00121893  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 3:   f(p) =  .00077435  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 4:   f(p) =  .00038439  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 5:   f(p) =  .00027065  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 6:   f(p) =  .00020657  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 7:   f(p) =  .00014905  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 8:   f(p) =  .00004814  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 9:   f(p) =  .00002729  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 10:  f(p) =  .00002254  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 11:  f(p) =  .00001783  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 12:  f(p) =  .00001699  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 13:  f(p) =  .00001552  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 14:  f(p) =  .00001133  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 15:  f(p) =  9.051e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 16:  f(p) =  2.745e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 17:  f(p) =  1.278e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 18:  f(p) =  6.474e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 19:  f(p) =  2.155e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 20:  f(p) =  2.112e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 21:  f(p) =  1.949e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 22:  f(p) =  1.908e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 23:  f(p) =  1.907e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 24:  f(p) =  1.903e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 25:  f(p) =  1.893e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 26:  f(p) =  1.886e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 27:  f(p) =  1.883e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 28:  f(p) =  1.882e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 29:  f(p) =  1.877e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 30:  f(p) =  1.691e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 31:  f(p) =  6.806e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 32:  f(p) =  3.368e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 33:  f(p) =  1.433e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 34:  f(p) =  6.449e-09  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 35:  f(p) =  3.440e-09  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 36:  f(p) =  1.315e-09  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 37:  f(p) =  7.718e-10  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 38:  f(p) =  5.383e-10  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 39:  f(p) =  4.325e-10  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 40:  f(p) =  4.204e-10  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 41:  f(p) =  4.112e-10  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -.5194657037              0   -1.632350742              0   -.6075619649   -.1798200427   -.0133428854    -.051552608     -.02246905   -.1531418276
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1162047887   -.1676400517   -.1161679118   -.0137662501   -.1495326906    1.379451797  |
     -------------------------------------------------------------------------------------------+

:   D.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913   .6184849  -.1510936  -.3011816   .5016695   1.063968
             |
          x2 |
          0  |  (empty)
          1  |  .0108696   .0070156    .003854    .036966   .1042572   1.556465
             |
          x3 |
          0  |  (empty)
          1  |  .0217391   .0188815   .0028577    .019489   .1466296   1.157765
             |
          x4 |  .4347826    .512792  -.0780094  -.1565056   .4984448   .9920024
          x5 |  25.46739   25.20748   .2599119   .0477435   5.443922   .7911694
          x6 |  11.86957   12.55084  -.6812718  -.4244535   1.605057   .5023811
          x7 |  6.858696   6.467188   .3915075   .1100759   3.556704    1.13778
         x90 |  .0972024  -.1624989   .2597014   .2722849   .9537854   .8848777
         x91 | -.0890157  -.0823113  -.0067044    -.00711   .9429542   .9285862
         x92 |  .0453787  -.1949211   .2402997    .228601   1.051175   1.114809
         x93 |  .0865687  -.0799771   .1665458   .1781293   .9349714   .8341126
         x94 | -.1299173  -.0138528  -.1160645   -.125501   .9248091   .8378465
         x95 | -.0807251  -.1917338   .1110087    .121453    .914005   .8724406
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  4.93609e-13
  Mean absolute standardized diff.
  .1561149484
  Maximum absolute standardized diff.
  .424453494
  C.V. of matching weights:
  .5272638395
  S.D. of matching weights:
  .5272638395
  Skewness of matching weights:
  .07133884
  Kurtosis of matching weights:
  .0142383904
  Maximum matching weight:
  3.238925246
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3440.845     3470.435  -29.58933  -.1879542   3470.435
   y1_binary |    .9488568     .9570393  -.0081825  -.1914123   .9570393
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
: // furthermore, you can target skiwness, kurtosis, or max weight
:   D.psweight("atet","cbps", 1, (1,.50,6,1,0.7,2))
  Step 1 (initial values from logit model):
initial:       f(p) = -346.57359
alternative:   f(p) = -283.03849
rescale:       f(p) = -247.46401
Iteration 0:   f(p) = -247.46401  
Iteration 1:   f(p) = -223.85141  
Iteration 2:   f(p) = -211.21662  
Iteration 3:   f(p) = -211.17754  
Iteration 4:   f(p) = -211.17753  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  .34614522  
Iteration 1:   f(p) =  .25779537  (backed up)
Iteration 2:   f(p) =  .25662286  
Iteration 3:   f(p) =   .2194888  
Iteration 4:   f(p) =  .19757927  
Iteration 5:   f(p) =  .11363654  
Iteration 6:   f(p) =  .09442615  
Iteration 7:   f(p) =  .06171027  
Iteration 8:   f(p) =  .05398046  
Iteration 9:   f(p) =   .0488818  
Iteration 10:  f(p) =  .04792569  
Iteration 11:  f(p) =  .04741391  
Iteration 12:  f(p) =  .04688789  
Iteration 13:  f(p) =  .04653387  
Iteration 14:  f(p) =  .04550754  
Iteration 15:  f(p) =  .04442903  
Iteration 16:  f(p) =  .04414592  
Iteration 17:  f(p) =  .04405978  
Iteration 18:  f(p) =   .0439231  
Iteration 19:  f(p) =  .04302644  
Iteration 20:  f(p) =  .04081985  
Iteration 21:  f(p) =  .03932104  
Iteration 22:  f(p) =  .03906371  
Iteration 23:  f(p) =  .03895633  
Iteration 24:  f(p) =  .03894718  
Iteration 25:  f(p) =  .03894693  
Iteration 26:  f(p) =  .03894691  
Iteration 27:  f(p) =  .03894687  
Iteration 28:  f(p) =  .03894642  
Iteration 29:  f(p) =  .03894234  
Iteration 30:  f(p) =  .03892369  
Iteration 31:  f(p) =  .03891901  
Iteration 32:  f(p) =  .03891675  
Iteration 33:  f(p) =  .03891644  
Iteration 34:  f(p) =  .03891644  
Iteration 35:  f(p) =  .03891644  
Iteration 36:  f(p) =  .03891644  
Iteration 37:  f(p) =  .03891644  
Iteration 38:  f(p) =  .03891644  
Iteration 39:  f(p) =  .03891644  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |   .0400900695              0   -.0449745366              0   -.0644035174    .1717826118    .0644460097   -.2137991528   -.0240812191    .0931575756
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1081187823    .1821330696    .1321345545   -.3057756013    .0663444759   -.9592819917  |
     -------------------------------------------------------------------------------------------+

:   D.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4673913   .7622098  -.2948185  -.5876748   .5016695   1.385164
             |
          x2 |
          0  |  (empty)
          1  |  .0108696   .0263519  -.0154823  -.1485015   .1042572   .4226027
             |
          x3 |
          0  |  (empty)
          1  |  .0217391   .0420962   -.020357   -.138833   .1466296   .5318794
             |
          x4 |  .4347826   .4437025  -.0089199  -.0178955   .4984448   1.004082
          x5 |  25.46739   27.91242  -2.445032  -.4491306   5.443922   .6653275
          x6 |  11.86957   12.43492   -.565356  -.3522343   1.605057   .4631149
          x7 |  6.858696   6.306199   .5524966   .1553395   3.556704   1.158364
         x90 |  .0972024  -.0158259   .1130283    .118505   .9537854   .9540569
         x91 | -.0890157  -.1059285   .0169128    .017936   .9429542   .9192153
         x92 |  .0453787   .1467607  -.1013821  -.0964464   1.051175   1.135239
         x93 |  .0865687   .1792813  -.0927127  -.0991609   .9349714   .9529712
         x94 | -.1299173  -.3260982   .1961809   .2121312   .9248091   .7297787
         x95 | -.0807251  -.0955472   .0148221   .0162166    .914005   .8693439
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  .0111018423
  Mean absolute standardized diff.
  .1853850309
  Maximum absolute standardized diff.
  .5876748378
  C.V. of matching weights:
  .9715245684
  S.D. of matching weights:
  .9715245684
  Skewness of matching weights:
  .5328905715
  Kurtosis of matching weights:
  .4123741838
  Maximum matching weight:
  16.67392699
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |     3432.78     3436.596  -3.816442     -.0264   3436.596
   y1_binary |    .9492824     .9562957  -.0070133  -.1280773   .9562957
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

:   st_local("mlopts", "")

: 
: mata drop D

: 
: 
: // * WEIGHTED DATA EXAMPLES *
: 
: DW = psweight()

: DW.set(treatvar, varlist, tousevar, wgtvar)
  408 control obs (sum of weights = 802.3793)
  92 treatment obs (sum of weights = 180.1725)

: if (depvars!="") DW.set_Y(depvars,tousevar)
> 
> // Misc balance measures
>   DW.diff()
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |   -.295813959              0   -.0156488223              0   -.0187317786   -.0757286195   -1.051311077   -1.308590669     .297707166    .1231935602
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15
     ----------------------------------------------------------------------------+
  1    -.0575694681    .0828891447    .0552344857   -.1298217376   -.0348745599  |
     ----------------------------------------------------------------------------+

:   DW.stddiff()
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -.5928113513              .   -.1469730323              .   -.1218929028   -.1529139652   -.1938926866   -.7969828512    .0837330563    .1283646934
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15
     ----------------------------------------------------------------------------+
  1    -.0613348134    .0800443396    .0583642775   -.1419196244   -.0384510908  |
     ----------------------------------------------------------------------------+

:   DW.mean_asd()
  .1998214373

:   DW.stddiff(1)
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -.5928113513              .   -.1469730323              .   -.1218929028   -.1529139652   -.1938926866   -.7969828512    .0837330563    .1283646934
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15
     ----------------------------------------------------------------------------+
  1    -.0613348134    .0800443396    .0583642775   -.1419196244   -.0384510908  |
     ----------------------------------------------------------------------------+

:   DW.stddiff(0)
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |   -.680061781              .   -.0963964449              .   -.0924925724    -.151364552   -.1796741931    -.574992733     .089787867    .1235603267
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15
     ----------------------------------------------------------------------------+
  1    -.0581251544    .0827450762    .0561740214   -.1310646825   -.0346950651  |
     ----------------------------------------------------------------------------+

:   DW.varratio()
                 1             2             3             4             5             6             7             8             9            10
    +---------------------------------------------------------------------------------------------------------------------------------------------
  1 |  1.316023713             .   .4301765439             .   .5757804001   .9798375062   .8587140122   .5205072206   1.149850614   .9265458616
    +---------------------------------------------------------------------------------------------------------------------------------------------
                11            12            13            14            15
     -----------------------------------------------------------------------+
  1    .8980781756   1.068619436   .9263536214    .852877099   .8141756036  |
     -----------------------------------------------------------------------+

:   DW.progdiff()
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |     3448.29     3459.434  -11.14415  -.0845901   3459.434
   y1_binary |      .95075     .9627243  -.0119743  -.3182517   .9627243
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.
                  1              2
    +-------------------------------+
  1 |  -11.14415063    -.011974287  |
    +-------------------------------+

: 
:   "Balance table before matching"
  Balance table before matching

:   temp = DW.balancetable(1)
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4512231   .7470371   -.295814  -.5928114   .4990018   1.316024
             |
          x2 |
          0  |  (empty)
          1  |  .0114039   .0270527  -.0156488   -.146973   .1064741   .4301765
             |
          x3 |
          0  |  (empty)
          1  |  .0240637   .0427955  -.0187318  -.1218929   .1536741   .5757804
             |
          x4 |  .4218861   .4976147  -.0757286   -.152914   .4952368   .9798375
          x5 |  25.44699    26.4983  -1.051311  -.1938927   5.422129    .858714
          x6 |  11.84757   13.15616  -1.308591  -.7969829   1.641931   .5205072
          x7 |  7.015422   6.717714   .2977072   .0837331   3.555432   1.149851
         x90 |  .0839738  -.0392197   .1231936   .1283647   .9597153   .9265459
         x91 | -.0648837  -.0073142  -.0575695  -.0613348     .93861   .8980782
         x92 |  .0575388  -.0253504   .0828891   .0800443    1.03554   1.068619
         x93 |  .1016523   .0464178   .0552345   .0583643   .9463749   .9263536
         x94 | -.1252265   .0045953  -.1298217  -.1419196   .9147554   .8528771
         x95 | -.1044649  -.0695904  -.0348746  -.0384511   .9069849   .8141756
-------------------------------------------------------------------------------
  

: 
: // Replicate CBPS
: 
:   "--- ATE (not overidentified) ---"; ""; ""
  --- ATE (not overidentified) ---
  
  

:     DW.cbps("ate", 2)
  Step 1 (initial values from logit model):
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -435.82146  
Iteration 2:   f(p) = -411.28219  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  .00008909  
Iteration 1:   f(p) =  .00006006  
Iteration 2:   f(p) =  .00005798  
Iteration 3:   f(p) =  .00005798  
Iteration 4:   f(p) =  .00005797  
Iteration 5:   f(p) =  .00005722  
Iteration 6:   f(p) =  .00004801  
Iteration 7:   f(p) =   .0000216  
Iteration 8:   f(p) =  .00001686  
Iteration 9:   f(p) =  .00001603  
Iteration 10:  f(p) =  .00001599  
Iteration 11:  f(p) =  .00001599  
Iteration 12:  f(p) =  .00001598  
Iteration 13:  f(p) =  .00001574  
Iteration 14:  f(p) =  .00001141  
Iteration 15:  f(p) =  5.239e-06  
Iteration 16:  f(p) =  4.992e-06  
Iteration 17:  f(p) =  4.991e-06  
Iteration 18:  f(p) =  4.991e-06  
Iteration 19:  f(p) =  4.946e-06  
Iteration 20:  f(p) =  4.114e-06  
Iteration 21:  f(p) =  2.086e-06  
Iteration 22:  f(p) =  1.975e-06  
Iteration 23:  f(p) =  1.975e-06  
Iteration 24:  f(p) =  1.975e-06  
Iteration 25:  f(p) =  1.973e-06  
Iteration 26:  f(p) =  1.949e-06  
Iteration 27:  f(p) =  1.615e-06  
Iteration 28:  f(p) =  9.103e-07  
Iteration 29:  f(p) =  8.671e-07  
Iteration 30:  f(p) =  8.670e-07  
Iteration 31:  f(p) =  8.668e-07  
Iteration 32:  f(p) =  8.646e-07  
Iteration 33:  f(p) =  5.560e-07  
Iteration 34:  f(p) =  3.177e-07  
Iteration 35:  f(p) =  3.129e-07  
Iteration 36:  f(p) =  3.129e-07  
Iteration 37:  f(p) =  3.127e-07  
Iteration 38:  f(p) =  2.971e-07  
Iteration 39:  f(p) =  1.197e-07  
Iteration 40:  f(p) =  6.991e-08  
Iteration 41:  f(p) =  6.958e-08  
Iteration 42:  f(p) =  6.958e-08  
Iteration 43:  f(p) =  6.954e-08  
Iteration 44:  f(p) =  6.908e-08  
Iteration 45:  f(p) =  5.559e-08  
Iteration 46:  f(p) =  8.913e-09  
Iteration 47:  f(p) =  8.087e-09  
Iteration 48:  f(p) =  8.087e-09  
Iteration 49:  f(p) =  8.086e-09  
Iteration 50:  f(p) =  8.042e-09  
Iteration 51:  f(p) =  7.406e-09  
Iteration 52:  f(p) =  3.662e-09  
Iteration 53:  f(p) =  1.074e-09  
Iteration 54:  f(p) =  9.277e-10  
Iteration 55:  f(p) =  9.270e-10  
Iteration 56:  f(p) =  9.269e-10  
Iteration 57:  f(p) =  8.885e-10  
Iteration 58:  f(p) =  3.553e-10  
Iteration 59:  f(p) =  9.288e-11  
Iteration 60:  f(p) =  8.909e-11  
Iteration 61:  f(p) =  8.908e-11  
Iteration 62:  f(p) =  8.907e-11  
Iteration 63:  f(p) =  8.892e-11  
Iteration 64:  f(p) =  8.553e-11  
Iteration 65:  f(p) =  5.704e-11  
Iteration 66:  f(p) =  6.614e-12  
Iteration 67:  f(p) =  4.150e-12  
Iteration 68:  f(p) =  4.144e-12  
Iteration 69:  f(p) =  4.139e-12  
Iteration 70:  f(p) =  3.814e-12  
Iteration 71:  f(p) =  5.171e-13  
Iteration 72:  f(p) =  7.891e-14  
Iteration 73:  f(p) =  7.793e-14  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.502414515              0   -2.525402246              0   -.8190826538   -.3236380922    .0771204018   -.4884776607      .07226998    .0234172486
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1     .0257840856    .2152131433    -.028533331   -.3393879085   -.0407886924    3.075427325  |
     -------------------------------------------------------------------------------------------+

:     DW.balanceresults("ate",2)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff    sd_pool  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .6695178   .6695184  -6.44e-07  -1.37e-06   .4706261   1.004329
             |
          x2 |
          0  |  (empty)
          1  |  .0220668   .0220668   6.83e-08   4.64e-07   .1469755   1.004331
             |
          x3 |
          0  |  (empty)
          1  |  .0366905   .0366911  -6.21e-07  -3.30e-06   .1880978   1.004312
             |
          x4 |   .485133   .4851327   2.59e-07   5.18e-07   .5000334   1.004328
          x5 |  26.17888   26.17889  -.0000147  -2.35e-06   6.237856   .6789016
          x6 |  12.63449   12.63449   1.53e-06   6.55e-07   2.338006    .574066
          x7 |   6.75523   6.755245  -.0000157  -4.65e-06   3.370937   1.187219
         x90 | -.0520319  -.0520316  -2.99e-07  -2.86e-07   1.046128   1.163665
         x91 |  .0164868   .0164855   1.36e-06   1.40e-06   .9705718   .9930967
         x92 | -.0021635  -.0021647   1.18e-06   1.16e-06   1.017927   1.359803
         x93 |  .0456889   .0456925  -3.58e-06  -3.72e-06   .9636158   .8837309
         x94 | -.0910013   -.091001  -2.80e-07  -2.76e-07   1.014117    .785929
         x95 | -.0894585   -.089459   5.39e-07   5.51e-07   .9789419   .8236875
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  7.43885e-13
  Mean absolute standardized diff.
  1.59279e-06
  Maximum absolute standardized diff.
  4.65080e-06
  C.V. of matching weights:
  .5271017371
  S.D. of matching weights:
  .5285016261
  Skewness of matching weights:
  .2026538297
  Kurtosis of matching weights:
  .0762388752
  Maximum matching weight:
  6.642347912
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3445.465     3445.465   .0003474   2.36e-06   3445.465
   y1_binary |    .9569443     .9569441   1.47e-07   3.70e-06   .9569441
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   "--- ATE overidentified ---"; ""; ""
  --- ATE overidentified ---
  
  

:     DW.cbpsoid("ate", 2)
  Step 1 (initial values from logit model):
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -435.82146  
Iteration 2:   f(p) = -411.28219  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  .02296546  
Iteration 1:   f(p) =  .01893921  
Iteration 2:   f(p) =  .01888779  
Iteration 3:   f(p) =  .01864993  
Iteration 4:   f(p) =  .01807796  
Iteration 5:   f(p) =  .01796175  
Iteration 6:   f(p) =  .01796123  
Iteration 7:   f(p) =  .01795223  
Iteration 8:   f(p) =  .01782927  
Iteration 9:   f(p) =  .01781765  
Iteration 10:  f(p) =  .01781754  
Iteration 11:  f(p) =  .01781628  
Iteration 12:  f(p) =   .0177805  
Iteration 13:  f(p) =   .0177802  
Iteration 14:  f(p) =  .01777986  
Iteration 15:  f(p) =  .01777329  
Iteration 16:  f(p) =  .01777274  
Iteration 17:  f(p) =  .01777274  
Iteration 18:  f(p) =  .01777245  
Iteration 19:  f(p) =  .01777192  
Iteration 20:  f(p) =  .01777187  
Iteration 21:  f(p) =  .01777187  
Iteration 22:  f(p) =  .01777187  
Iteration 23:  f(p) =  .01777186  
Iteration 24:  f(p) =  .01777185  
Iteration 25:  f(p) =  .01777185  
Iteration 26:  f(p) =  .01777185  
Iteration 27:  f(p) =  .01777185  
Iteration 28:  f(p) =  .01777185  
Iteration 29:  f(p) =  .01777184  
Iteration 30:  f(p) =  .01777184  
Iteration 31:  f(p) =  .01777184  
Iteration 32:  f(p) =  .01777184  
Iteration 33:  f(p) =  .01777184  
Iteration 34:  f(p) =  .01777184  
Iteration 35:  f(p) =  .01777184  
Iteration 36:  f(p) =  .01777184  
Iteration 37:  f(p) =  .01777184  
Iteration 38:  f(p) =  .01777184  
Iteration 39:  f(p) =  .01777184  
Iteration 40:  f(p) =  .01777184  
Iteration 41:  f(p) =  .01777184  
Iteration 42:  f(p) =  .01777184  
Iteration 43:  f(p) =  .01777184  
Iteration 44:  f(p) =  .01777184  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.226645234              0   -1.653763236              0   -.7776839523   -.3532496912    .0574627675    -.258300344    .0080437822    .0890276543
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1706885657    .1765099541     .113671482   -.1271349333    .0214700515    1.180156409  |
     -------------------------------------------------------------------------------------------+

:     DW.balanceresults("ate",2)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff    sd_pool  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .6415954   .6970126  -.0554172   -.119431   .4640107   1.093567
             |
          x2 |
          0  |  (empty)
          1  |  .0142909   .0234703  -.0091794  -.0628462   .1460619    .617275
             |
          x3 |
          0  |  (empty)
          1  |   .033444   .0380925  -.0046485  -.0245375   .1894461   .8860284
             |
          x4 |  .4881572   .4821182   .0060389   .0120785    .499973    1.00505
          x5 |  25.72258   26.31855  -.5959627  -.1000423   5.957105   .7659019
          x6 |  12.33189    12.8994  -.5675068  -.2533225   2.240254   .6135512
          x7 |  6.911085   6.688832    .222253   .0657614   3.379685   1.211887
         x90 | -.0440389  -.0251308  -.0189081  -.0185768    1.01783   1.120774
         x91 |  .0661739  -.0257225   .0918964   .0936224   .9815644   .9753855
         x92 |  -.038201  -.0020298  -.0361712  -.0355959   1.016161    1.20721
         x93 |  .0014103   .0645199  -.0631095  -.0653395   .9658703   .9125526
         x94 | -.1442666  -.0285682  -.1156983  -.1166709   .9916637   .8216035
         x95 | -.1053625    -.07164  -.0337225  -.0344809   .9780038    .803947
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  .0025726843
  Mean absolute standardized diff.
  .0771004621
  Maximum absolute standardized diff.
  .2533224801
  C.V. of matching weights:
  .3236892875
  S.D. of matching weights:
  .3244154606
  Skewness of matching weights:
  .1499734439
  Kurtosis of matching weights:
  .0569706877
  Maximum matching weight:
  4.343315815
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3443.873     3455.428  -11.55448  -.0858345   3455.428
   y1_binary |    .9538356     .9614582  -.0076226  -.2014405   .9614582
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   "--- ATET (not overidentified) ---"; ""; ""
  --- ATET (not overidentified) ---
  
  

:     DW.cbps("atet", 2)
  Step 1 (initial values from logit model):
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -435.82146  
Iteration 2:   f(p) = -411.28219  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  .00001735  
Iteration 1:   f(p) =  6.450e-06  
Iteration 2:   f(p) =  5.892e-06  
Iteration 3:   f(p) =  5.889e-06  
Iteration 4:   f(p) =  5.889e-06  
Iteration 5:   f(p) =  5.884e-06  
Iteration 6:   f(p) =  5.782e-06  
Iteration 7:   f(p) =  1.672e-06  
Iteration 8:   f(p) =  1.353e-06  
Iteration 9:   f(p) =  1.347e-06  
Iteration 10:  f(p) =  1.347e-06  
Iteration 11:  f(p) =  1.345e-06  
Iteration 12:  f(p) =  5.280e-07  
Iteration 13:  f(p) =  3.964e-07  
Iteration 14:  f(p) =  3.959e-07  
Iteration 15:  f(p) =  3.959e-07  
Iteration 16:  f(p) =  3.957e-07  
Iteration 17:  f(p) =  3.916e-07  
Iteration 18:  f(p) =  3.104e-07  
Iteration 19:  f(p) =  1.005e-07  
Iteration 20:  f(p) =  7.822e-08  
Iteration 21:  f(p) =  7.812e-08  
Iteration 22:  f(p) =  7.811e-08  
Iteration 23:  f(p) =  7.804e-08  
Iteration 24:  f(p) =  7.704e-08  
Iteration 25:  f(p) =  6.598e-08  
Iteration 26:  f(p) =  1.970e-08  
Iteration 27:  f(p) =  1.289e-08  
Iteration 28:  f(p) =  1.287e-08  
Iteration 29:  f(p) =  1.287e-08  
Iteration 30:  f(p) =  1.285e-08  
Iteration 31:  f(p) =  1.253e-08  
Iteration 32:  f(p) =  7.732e-09  
Iteration 33:  f(p) =  3.004e-09  
Iteration 34:  f(p) =  2.965e-09  
Iteration 35:  f(p) =  2.965e-09  
Iteration 36:  f(p) =  2.963e-09  
Iteration 37:  f(p) =  2.943e-09  
Iteration 38:  f(p) =  2.704e-09  
Iteration 39:  f(p) =  1.395e-09  
Iteration 40:  f(p) =  6.870e-10  
Iteration 41:  f(p) =  6.666e-10  
Iteration 42:  f(p) =  6.665e-10  
Iteration 43:  f(p) =  6.665e-10  
Iteration 44:  f(p) =  6.654e-10  
Iteration 45:  f(p) =  6.453e-10  
Iteration 46:  f(p) =  2.604e-10  
Iteration 47:  f(p) =  2.181e-10  
Iteration 48:  f(p) =  2.181e-10  
Iteration 49:  f(p) =  2.181e-10  
Iteration 50:  f(p) =  1.511e-10  
Iteration 51:  f(p) =  5.741e-11  
Iteration 52:  f(p) =  5.109e-11  
Iteration 53:  f(p) =  5.109e-11  
Iteration 54:  f(p) =  5.109e-11  
Iteration 55:  f(p) =  4.908e-11  
Iteration 56:  f(p) =  6.255e-12  
Iteration 57:  f(p) =  1.133e-12  
Iteration 58:  f(p) =  1.133e-12  
Iteration 59:  f(p) =  1.130e-12  
Iteration 60:  f(p) =  3.275e-13  
Iteration 61:  f(p) =  1.520e-13  
Iteration 62:  f(p) =  1.511e-13  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.447067061              0   -1.546866037              0   -.4711118853   -.3822616589    .0635833869   -.2432315964    .0477039614       .1335012
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1336147998    .1522979455    .0757708004   -.1016182953   -.0383404468    .6265999323  |
     -------------------------------------------------------------------------------------------+

:     DW.balanceresults("atet",2)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff    sd_pool  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4512231   .4512189   4.26e-06   8.56e-06   .4978682    1.00433
             |
          x2 |
          0  |  (empty)
          1  |  .0114039   .0114041  -1.89e-07  -1.78e-06    .106233   1.004312
             |
          x3 |
          0  |  (empty)
          1  |  .0240637   .0240628   9.22e-07   6.01e-06   .1533227   1.004365
             |
          x4 |  .4218861   .4218849   1.21e-06   2.46e-06   .4941119   1.004329
          x5 |  25.44699   25.44697   .0000137   2.05e-06    6.66557   .6144636
          x6 |  11.84757   11.84755   .0000196   9.58e-06   2.042371   .5982538
          x7 |  7.015422    7.01543  -8.55e-06  -2.55e-06   3.345322   1.161762
         x90 |  .0839738   .0839754  -1.58e-06  -1.54e-06     1.0258   .8505311
         x91 | -.0648837  -.0648849   1.23e-06   1.30e-06   .9411048   .9922921
         x92 |  .0575388   .0575408  -2.04e-06  -2.06e-06   .9892728   1.118264
         x93 |  .1016523   .1016503   2.03e-06   2.16e-06   .9410808   1.012574
         x94 | -.1252265  -.1252288   2.34e-06   2.28e-06    1.02686   .7576608
         x95 | -.1044649  -.1044664   1.41e-06   1.46e-06   .9627681   .8646446
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  4.61593e-12
  Mean absolute standardized diff.
  3.36871e-06
  Maximum absolute standardized diff.
  9.57718e-06
  C.V. of matching weights:
  1.031943603
  S.D. of matching weights:
  1.027126741
  Skewness of matching weights:
  .1135031637
  Kurtosis of matching weights:
  .0229213062
  Maximum matching weight:
  7.00792466
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3431.367     3431.366   .0005901   3.70e-06   3431.366
   y1_binary |    .9509094     .9509091   2.71e-07   5.55e-06   .9509091
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   "--- ATET overidentified ---"; ""; ""
  --- ATET overidentified ---
  
  

:     DW.cbpsoid("atet", 2)
  Step 1 (initial values from logit model):
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -435.82146  
Iteration 2:   f(p) = -411.28219  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  .00053487  
Iteration 1:   f(p) =  .00021848  
Iteration 2:   f(p) =  .00021162  
Iteration 3:   f(p) =  .00021159  
Iteration 4:   f(p) =  .00021001  
Iteration 5:   f(p) =  .00019724  
Iteration 6:   f(p) =   .0001771  
Iteration 7:   f(p) =  .00017502  
Iteration 8:   f(p) =  .00017501  
Iteration 9:   f(p) =  .00017499  
Iteration 10:  f(p) =  .00017465  
Iteration 11:  f(p) =  .00017249  
Iteration 12:  f(p) =  .00017245  
Iteration 13:  f(p) =  .00017241  
Iteration 14:  f(p) =  .00017225  
Iteration 15:  f(p) =  .00017218  
Iteration 16:  f(p) =  .00017218  
Iteration 17:  f(p) =  .00017218  
Iteration 18:  f(p) =  .00017218  
Iteration 19:  f(p) =  .00017218  
Iteration 20:  f(p) =  .00017216  
Iteration 21:  f(p) =  .00017216  
Iteration 22:  f(p) =  .00017216  
Iteration 23:  f(p) =  .00017216  
Iteration 24:  f(p) =  .00017216  
Iteration 25:  f(p) =  .00017215  
Iteration 26:  f(p) =  .00017215  
Iteration 27:  f(p) =  .00017215  
Iteration 28:  f(p) =  .00017215  
Iteration 29:  f(p) =  .00017215  
Iteration 30:  f(p) =  .00017215  
Iteration 31:  f(p) =  .00017215  
Iteration 32:  f(p) =  .00017215  
Iteration 33:  f(p) =  .00017215  
Iteration 34:  f(p) =  .00017215  
Iteration 35:  f(p) =  .00017215  
Iteration 36:  f(p) =  .00017215  
Iteration 37:  f(p) =  .00017215  
Iteration 38:  f(p) =  .00017215  
Iteration 39:  f(p) =  .00017215  
Iteration 40:  f(p) =  .00017215  
Iteration 41:  f(p) =  .00017215  
Iteration 42:  f(p) =  .00017215  
Iteration 43:  f(p) =  .00017215  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.393748719              0   -1.561035335              0   -.4600073818   -.3846166455    .0606091438   -.2482014047    .0443350573    .1306486741
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1205476424    .1453090919    .0704761429   -.1075637645   -.0307915057    .7598463812  |
     -------------------------------------------------------------------------------------------+

:     DW.balanceresults("atet",2)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff    sd_pool  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4512231   .4553292   -.004106   -.008242    .498186   1.002774
             |
          x2 |
          0  |  (empty)
          1  |  .0114039   .0111963   .0002076   .0019684   .1054489   1.022732
             |
          x3 |
          0  |  (empty)
          1  |  .0240637   .0242797   -.000216   -.001404   .1538722    .995612
             |
          x4 |  .4218861   .4235251   -.001639  -.0033157    .494322   1.003286
          x5 |  25.44699   25.39436   .0526232   .0078929   6.667188   .6141311
          x6 |  11.84757   11.82507   .0224993   .0110128   2.043017   .5978372
          x7 |  7.015422   6.978163   .0372587   .0111276   3.348319   1.159171
         x90 |  .0839738   .0816058   .0023681   .0023047   1.027479   .8472278
         x91 | -.0648837  -.0554767   -.009407  -.0099829   .9423132   .9892043
         x92 |  .0575388   .0526515   .0048873   .0049457   .9881782   1.121369
         x93 |  .1016523   .0977101   .0039423    .004191   .9406607   1.013686
         x94 | -.1252265   -.131327   .0061005   .0059387    1.02725   .7569926
         x95 | -.1044649  -.1015495  -.0029155   -.003029   .9625008   .8652191
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  3.24224e-06
  Mean absolute standardized diff.
  .005796575
  Maximum absolute standardized diff.
  .0111275825
  C.V. of matching weights:
  1.0190338
  S.D. of matching weights:
  1.014129186
  Skewness of matching weights:
  .1128933337
  Kurtosis of matching weights:
  .0230686592
  Maximum matching weight:
  7.109590442
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3431.338     3430.734   .6043149   .0037958   3430.734
   y1_binary |    .9509085     .9508973   .0000113   .0002306   .9508973
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
: // Other objective functions
:   st_local("mlopts", "difficult nonrtolerance")

:   DW.psweight("atet","mean_sd_sq",1)
  Step 1 (initial values from logit model):
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -436.32795  
Iteration 2:   f(p) = -411.28933  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
Iteration 5:   f(p) = -411.19865  
  
  Step 2 (CBPS) :
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 0:   f(p) =  .00026309  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 1:   f(p) =  .00001126  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 2:   f(p) =  4.733e-09  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 3:   f(p) =  1.761e-13  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 4:   f(p) =  1.988e-21  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.298300659              0   -1.629910465              0   -.4511737895   -.3553036347    .0715800494   -.2773324041    .0371348758    .1283825514
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.0952384663    .1409151847     .074303883   -.1419191912   -.0201500497     1.24895601  |
     -------------------------------------------------------------------------------------------+

:   DW.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4512231    .487981  -.0367579  -.0736628   .4990018   .9953452
             |
          x2 |
          0  |  (empty)
          1  |  .0114039   .0101189   .0012849   .0120681   .1064741   1.130392
             |
          x3 |
          0  |  (empty)
          1  |  .0240637   .0243904  -.0003267   -.002126   .1536741    .991207
             |
          x4 |  .4218861   .4077073   .0141788   .0286304   .4952368   1.014377
          x5 |  25.44699   25.93854  -.4915548  -.0906572   5.422129   .5820455
          x6 |  11.84757   11.77832   .0692519   .0421771   1.641931   .5870658
          x7 |  7.015422   6.877177   .1382443   .0388826   3.555432   1.150412
         x90 |  .0839738   .0558962   .0280776   .0292562   .9597153   .8505932
         x91 | -.0648837  -.0314162  -.0334675  -.0356565     .93861   .9896463
         x92 |  .0575388   .0508005   .0067383    .006507    1.03554   1.132825
         x93 |  .1016523   .1109109  -.0092586  -.0097833   .9463749   1.021042
         x94 | -.1252265  -.1752569   .0500305   .0546928   .9147554   .7291541
         x95 | -.1044649   -.104167  -.0002979  -.0003285   .9069849   .8690485
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  1.98817e-21
  Mean absolute standardized diff.
  .0326483296
  Maximum absolute standardized diff.
  .0906571688
  C.V. of matching weights:
  1.06701684
  S.D. of matching weights:
  1.064358816
  Skewness of matching weights:
  .1583892384
  Kurtosis of matching weights:
  .0509012068
  Maximum matching weight:
  10.57744036
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3431.445     3432.164  -.7196184  -.0044215   3432.164
   y1_binary |    .9507734     .9518109  -.0010374  -.0207557   .9518109
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   DW.psweight("atet","sd_sq",1)
  Step 1 (initial values from logit model):
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -436.32795  
Iteration 2:   f(p) = -411.28933  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
Iteration 5:   f(p) = -411.19865  
  
  Step 2 (CBPS) :
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 0:   f(p) =  .01944489  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 1:   f(p) =  .01784035  (backed up)
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 2:   f(p) =  .01032757  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 3:   f(p) =  .00864463  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 4:   f(p) =  .00309574  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 5:   f(p) =  .00232235  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 6:   f(p) =  .00091852  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 7:   f(p) =  .00071553  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 8:   f(p) =  .00032888  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 9:   f(p) =  .00013226  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 10:  f(p) =  .00006152  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 11:  f(p) =  .00004718  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 12:  f(p) =  .00002689  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 13:  f(p) =   .0000235  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 14:  f(p) =  .00002163  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 15:  f(p) =  7.507e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 16:  f(p) =  4.926e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 17:  f(p) =  4.495e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 18:  f(p) =  3.113e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 19:  f(p) =  9.709e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 20:  f(p) =  2.289e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 21:  f(p) =  2.156e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 22:  f(p) =  2.156e-07  (backed up)
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.446641196              0   -1.542409645              0   -.4738988608   -.3823255927    .0635734936   -.2432677569     .047686514    .1334605378
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1336201721    .1523287035    .0757630004   -.1016270637   -.0382574506    1.349237715  |
     -------------------------------------------------------------------------------------------+

:   DW.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4512231   .4512687  -.0000456  -.0000913   .4990018    1.00431
             |
          x2 |
          0  |  (empty)
          1  |  .0114039   .0114402  -.0000363  -.0003409   .1064741   1.001178
             |
          x3 |
          0  |  (empty)
          1  |  .0240637   .0240204   .0000433   .0002818   .1536741   1.006094
             |
          x4 |  .4218861   .4218656   .0000205   .0000414   .4952368   1.004341
          x5 |  25.44699   25.44719  -.0002052  -.0000378   5.422129   .6144531
          x6 |  11.84757    11.8475   .0000671   .0000409   1.641931   .5982325
          x7 |  7.015422   7.015211   .0002106   .0000592   3.555432   1.161757
         x90 |  .0839738   .0839323   .0000415   .0000433   .9597153   .8505088
         x91 | -.0648837  -.0648817  -2.04e-06  -2.18e-06     .93861   .9922887
         x92 |  .0575388   .0575515  -.0000127  -.0000123    1.03554   1.118322
         x93 |  .1016523   .1016534  -1.06e-06  -1.12e-06   .9463749   1.012562
         x94 | -.1252265   -.125259   .0000325   .0000355   .9147554   .7576437
         x95 | -.1044649  -.1044612  -3.73e-06  -4.11e-06   .9069849   .8646937
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  9.13253e-13
  Mean absolute standardized diff.
  .0000763001
  Maximum absolute standardized diff.
  .0003408973
  C.V. of matching weights:
  1.031828628
  S.D. of matching weights:
  1.027013976
  Skewness of matching weights:
  .1135222631
  Kurtosis of matching weights:
  .0229324011
  Maximum matching weight:
  7.010362717
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3431.367     3431.377  -.0099881  -.0000627   3431.377
   y1_binary |    .9509094     .9509116  -2.24e-06  -.0000459   .9509116
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   if (depvars!="") {
>     DW.psweight("atet","stdprogdiff",1)
>     DW.balanceresults("atet",1)
>   }
>   st_local("mlopts", "")
  Step 1 (initial values from logit model):
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -436.32795  
Iteration 2:   f(p) = -411.28933  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
Iteration 5:   f(p) = -411.19865  
  
  Step 2 (CBPS) :
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 0:   f(p) =  .00143639  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 1:   f(p) =   .0006706  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 2:   f(p) =  .00064802  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 3:   f(p) =   .0000134  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 4:   f(p) =  9.080e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 5:   f(p) =  8.192e-11  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 6:   f(p) =  8.192e-11  (backed up)
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.298747112              0   -1.629982768              0   -.4515067822   -.3572144689    .0701859682   -.2800569182    .0431043055    .1194512945
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.0953766407    .1379606488    .0698370855   -.1463550636   -.0181706865    1.248913227  |
     -------------------------------------------------------------------------------------------+
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4512231   .4841323  -.0329091  -.0659499   .4990018   .9957729
             |
          x2 |
          0  |  (empty)
          1  |  .0114039   .0101285   .0012754   .0119781   .1064741   1.129334
             |
          x3 |
          0  |  (empty)
          1  |  .0240637   .0243611  -.0002974  -.0019351   .1536741   .9923704
             |
          x4 |  .4218861   .4098936   .0119925   .0242157   .4952368   1.012704
          x5 |  25.44699   25.87222  -.4252323  -.0784253   5.422129   .5828012
          x6 |  11.84757   11.76326    .084312   .0513493   1.641931    .590244
          x7 |  7.015422    6.94126   .0741616   .0208587   3.555432   1.153547
         x90 |  .0839738   .0479638   .0360101   .0375216   .9597153   .8485565
         x91 | -.0648837  -.0313864  -.0334973  -.0356882     .93861   .9913577
         x92 |  .0575388   .0445532   .0129856   .0125399    1.03554   1.135083
         x93 |  .1016523   .1048831  -.0032308  -.0034139   .9463749   1.017142
         x94 | -.1252265  -.1776529   .0524265    .057312   .9147554   .7316701
         x95 | -.1044649  -.0999108  -.0045541  -.0050212   .9069849   .8678581
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  3.80000e-06
  Mean absolute standardized diff.
  .0312468533
  Maximum absolute standardized diff.
  .0784253358
  C.V. of matching weights:
  1.069659157
  S.D. of matching weights:
  1.066612986
  Skewness of matching weights:
  .1534175628
  Kurtosis of matching weights:
  .0473557619
  Maximum matching weight:
  10.35645318
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3431.435     3431.436  -.0011653  -7.13e-06   3431.436
   y1_binary |    .9507806     .9507803   2.82e-07   5.58e-06   .9507803
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   DW.progdiff()
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3431.435     3431.436  -.0011653  -7.13e-06   3431.436
   y1_binary |    .9507806     .9507803   2.82e-07   5.58e-06   .9507803
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.
                  1              2
    +-------------------------------+
  1 |  -.0011653404    2.82280e-07  |
    +-------------------------------+

:   DW.reweight()

:   DW.progdiff()
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |     3448.29     3459.434  -11.14415  -.0845901   3459.434
   y1_binary |      .95075     .9627243  -.0119743  -.3182517   .9627243
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.
                  1              2
    +-------------------------------+
  1 |  -11.14415063    -.011974287  |
    +-------------------------------+

: 
: // IPW
: 
:   stata("teffects ipw (`:word 1 of `depvars'') (`treatvar' `varlist') if `tousevar' [iw=`wgtvar'], atet aequations")

Iteration 0:   EE criterion =  3.987e-18  
Iteration 1:   EE criterion =  1.443e-26  

Treatment-effects estimation                    Number of obs     =        500
Estimator      : inverse-probability weights
Outcome model  : weighted mean
Treatment model: logit
-----------------------------------------------------------------------------------------
                        |               Robust
                     y1 |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
ATET                    |
                  treat |
(Treated vs Untreated)  |  -373.2561   49.21885    -7.58   0.000    -469.7233   -276.7889
------------------------+----------------------------------------------------------------
POmean                  |
                  treat |
             Untreated  |   3424.879   30.82585   111.10   0.000     3364.462    3485.297
------------------------+----------------------------------------------------------------
TME1                    |
                     x1 |  -1.299227   .2371935    -5.48   0.000    -1.764118   -.8343367
                        |
                     x2 |
                     1  |  -1.630014    .746001    -2.19   0.029    -3.092149   -.1678787
                        |
                     x3 |
                     1  |  -.4513753   .5770312    -0.78   0.434    -1.582336    .6795851
                     x4 |  -.3551911    .204881    -1.73   0.083    -.7567506    .0463684
                     x5 |    .058452   .0195046     3.00   0.003     .0202237    .0966803
                     x6 |  -.2821622    .049775    -5.67   0.000    -.3797195    -.184605
                     x7 |   .0332008   .0279849     1.19   0.235    -.0216486    .0880501
                    x90 |   .1276778   .0907109     1.41   0.159    -.0501124     .305468
                    x91 |  -.0961159   .0916737    -1.05   0.294     -.275793    .0835612
                    x92 |   .1400043   .0976573     1.43   0.152    -.0514004    .3314091
                    x93 |   .0734557   .0916967     0.80   0.423    -.1062665     .253178
                    x94 |  -.1435742   .0862727    -1.66   0.096    -.3126656    .0255172
                    x95 |  -.0212452   .0898768    -0.24   0.813    -.1974006    .1549102
                  _cons |    1.24872   .6712769     1.86   0.063    -.0669587    2.564399
-----------------------------------------------------------------------------------------

:   stata("di _b[POmean:0.treat]")
3424.8791

:   stata("tebalance summarize")

  Covariate balance summary
                                                   Raw     Weighted
                          -----------------------------------------
                          Number of obs =          500        500.0
                          Treated obs   =           92        249.5
                          Control obs   =          408        250.5
                          -----------------------------------------

  -----------------------------------------------------------------
                  |Standardized differences          Variance ratio
                  |        Raw    Weighted           Raw   Weighted
  ----------------+------------------------------------------------
               x1 |  -.6027752    .0041102      1.338962   1.000571
                  |
               x2 |
               1  |  -.1180374    .0011686      .4133173   1.011157
                  |
               x3 |
               1  |  -.1253201   -.0169419      .5085817   .8975379
                  |
               x4 |  -.1207472    .0136004      .9914484   1.003798
               x5 |  -.1944638     .003179      .8589874   .5855492
               x6 |  -.6542694    .0947099      .4958356   .5643304
               x7 |   .0473848    .0177567      1.160037   1.134687
              x90 |   .1499304    .0348222      .9289414    .817157
              x91 |  -.0833726   -.0675073      .8791918     .96061
              x92 |   .0662245   -.0005441      1.090179   1.148892
              x93 |   .0479737    -.020065      .8926169   .9606022
              x94 |  -.1521926    .0315996      .8686432   .7548902
              x95 |  -.0155155    .0398234      .8285405   .8815991
  -----------------------------------------------------------------

:   stata("tebalance summarize, baseline")  // I noticed the sum of weights in tebalance are weird

  Covariate balance summary
                                                   Raw     Weighted
                          -----------------------------------------
                          Number of obs =          500        500.0
                          Treated obs   =           92        249.5
                          Control obs   =          408        250.5
                          -----------------------------------------

  -----------------------------------------------------------------
                  |           Means                  Variances     
                  |    Control     Treated       Control    Treated
  ----------------+------------------------------------------------
               x1 |        .75    .4673913      .1879607   .2516722
                  |
               x2 |
               1  |   .0269608    .0108696      .0262984   .0108696
                  |
               x3 |
               1  |   .0441176    .0217391      .0422749   .0215002
                  |
               x4 |    .495098    .4347826      .2505902   .2484472
               x5 |   26.56863    25.46739      34.50142   29.63629
               x6 |   13.15931    11.86957      5.195687   2.576206
               x7 |   6.696078    6.858696      10.90495   12.65014
              x90 |   -.048508    .0972024      .9792937   .9097065
              x91 |  -.0077434   -.0890157      1.011341   .8891627
              x92 |  -.0227801    .0453787      1.013567    1.10497
              x93 |   .0403853    .0865687      .9793358   .8741716
              x94 |   .0160559   -.1299173      .9846065   .8552718
              x95 |  -.0658282   -.0807251      1.008285   .8354051
  -----------------------------------------------------------------

: 
:   DW.ipw("atet")
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -436.32795  
Iteration 2:   f(p) = -411.28933  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
Iteration 5:   f(p) = -411.19865  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.299227462              0   -1.630013723              0    -.451375265   -.3551910971    .0584519984    -.282162246    .0332007599    .1276777932
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.0961158854    .1400043185    .0734557382   -.1435741845   -.0212452286    1.248719931  |
     -------------------------------------------------------------------------------------------+

:   table = DW.balancetable(3)
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff     sd_avg  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4512231   .4574808  -.0062577  -.0125467   .4987508   1.002016
             |
          x2 |
          0  |  (empty)
          1  |  .0114039   .0104612   .0009427   .0090496   .1041667   1.093786
             |
          x3 |
          0  |  (empty)
          1  |  .0240637   .0241722  -.0001085  -.0007058   .1536767   .9999323
             |
          x4 |  .4218861   .4314162  -.0095301  -.0192367   .4954098   .9986039
          x5 |  25.44699   25.25275   .1942356   .0309352   6.278789   .5945665
          x6 |  11.84757   11.67955   .1680205   .0885487   1.897493   .5984287
          x7 |  7.015422   6.824197   .1912245   .0556435     3.4366   1.151353
         x90 |  .0839738   .0777469   .0062269   .0061803   1.007542   .8303562
         x91 | -.0648837   -.033852  -.0310317  -.0329813    .940886    .990382
         x92 |  .0575388   .0480591   .0094797   .0094309   1.005171   1.130693
         x93 |  .1016523   .1032412  -.0015889  -.0016918   .9391571   1.031343
         x94 | -.1252265  -.1745685   .0493421   .0498225   .9903584   .7439065
         x95 | -.1044649  -.1114622   .0069973   .0074459   .9397461   .8717687
-------------------------------------------------------------------------------
  

:   DW.pomean()
                 1             2
    +-----------------------------+
  1 |  3424.879077   .9506406354  |
    +-----------------------------+

:   DW.reweight()

:   table = DW.balancetable(3)
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff     sd_avg  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4512231   .7470371   -.295814  -.6319633   .4680872   1.316024
             |
          x2 |
          0  |  (empty)
          1  |  .0114039   .0270527  -.0156488  -.1139938   .1372778   .4301765
             |
          x3 |
          0  |  (empty)
          1  |  .0240637   .0427955  -.0187318  -.1042015   .1797649   .5757804
             |
          x4 |  .4218861   .4976147  -.0757286  -.1521333   .4977779   .9798375
          x5 |  25.44699    26.4983  -1.051311  -.1863779    5.64075    .858714
          x6 |  11.84757   13.15616  -1.308591  -.6594519   1.984361   .5205072
          x7 |  7.015422   6.717714   .2977072   .0866021   3.437643   1.149851
         x90 |  .0839738  -.0392197   .1231936   .1258938   .9785514   .9265459
         x91 | -.0648837  -.0073142  -.0575695  -.0596653    .964873   .8980782
         x92 |  .0575388  -.0253504   .0828891   .0813611   1.018781   1.068619
         x93 |  .1016523   .0464178   .0552345   .0572377   .9650011   .9263536
         x94 | -.1252265   .0045953  -.1298217  -.1361687   .9533888   .8528771
         x95 | -.1044649  -.0695904  -.0348746  -.0364286   .9573389   .8141756
-------------------------------------------------------------------------------
  

: 
:   stata("teffects ipw (`:word 1 of `depvars'') (`treatvar' `varlist') if `tousevar' [iw=`wgtvar'], ate aequations")

Iteration 0:   EE criterion =  3.987e-18  
Iteration 1:   EE criterion =  2.429e-25  

Treatment-effects estimation                    Number of obs     =        500
Estimator      : inverse-probability weights
Outcome model  : weighted mean
Treatment model: logit
-----------------------------------------------------------------------------------------
                        |               Robust
                     y1 |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
ATE                     |
                  treat |
(Treated vs Untreated)  |  -332.1348   56.53175    -5.88   0.000     -442.935   -221.3346
------------------------+----------------------------------------------------------------
POmean                  |
                  treat |
             Untreated  |   3453.029    20.1341   171.50   0.000     3413.567    3492.491
------------------------+----------------------------------------------------------------
TME1                    |
                     x1 |  -1.299227   .2371935    -5.48   0.000    -1.764118   -.8343367
                        |
                     x2 |
                     1  |  -1.630014    .746001    -2.19   0.029    -3.092149   -.1678787
                        |
                     x3 |
                     1  |  -.4513753   .5770312    -0.78   0.434    -1.582336    .6795851
                     x4 |  -.3551911    .204881    -1.73   0.083    -.7567506    .0463684
                     x5 |    .058452   .0195046     3.00   0.003     .0202237    .0966803
                     x6 |  -.2821622    .049775    -5.67   0.000    -.3797195    -.184605
                     x7 |   .0332008   .0279849     1.19   0.235    -.0216486    .0880501
                    x90 |   .1276778   .0907109     1.41   0.159    -.0501124     .305468
                    x91 |  -.0961159   .0916737    -1.05   0.294     -.275793    .0835612
                    x92 |   .1400043   .0976573     1.43   0.152    -.0514004    .3314091
                    x93 |   .0734557   .0916967     0.80   0.423    -.1062665     .253178
                    x94 |  -.1435742   .0862727    -1.66   0.096    -.3126656    .0255172
                    x95 |  -.0212452   .0898768    -0.24   0.813    -.1974006    .1549102
                  _cons |    1.24872   .6712769     1.86   0.063    -.0669587    2.564399
-----------------------------------------------------------------------------------------

:   DW.ipw("ate")
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -436.32795  
Iteration 2:   f(p) = -411.28933  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
Iteration 5:   f(p) = -411.19865  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.299227462              0   -1.630013723              0    -.451375265   -.3551910971    .0584519984    -.282162246    .0332007599    .1276777932
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.0961158854    .1400043185    .0734557382   -.1435741845   -.0212452286    1.248719931  |
     -------------------------------------------------------------------------------------------+

: 
:   stata("teffects ipw (`:word 1 of `depvars'') (`treatvar' `varlist') if `tousevar' [iw=`wgtvar'], atet aequations tlevel(0) control(1)")

Iteration 0:   EE criterion =  3.987e-18  
Iteration 1:   EE criterion =  9.605e-26  

Treatment-effects estimation                    Number of obs     =        500
Estimator      : inverse-probability weights
Outcome model  : weighted mean
Treatment model: logit
-----------------------------------------------------------------------------------------
                        |               Robust
                     y1 |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
ATET                    |
                  treat |
(Untreated vs Treated)  |   321.4309   62.35166     5.16   0.000     199.2239    443.6379
------------------------+----------------------------------------------------------------
POmean                  |
                  treat |
               Treated  |   3138.003   59.50596    52.73   0.000     3021.374    3254.633
------------------------+----------------------------------------------------------------
TME0                    |
                     x1 |   1.299227   .2371935     5.48   0.000     .8343367    1.764118
                        |
                     x2 |
                     1  |   1.630014    .746001     2.19   0.029     .1678787    3.092149
                        |
                     x3 |
                     1  |   .4513753   .5770312     0.78   0.434    -.6795851    1.582336
                     x4 |   .3551911    .204881     1.73   0.083    -.0463684    .7567506
                     x5 |   -.058452   .0195046    -3.00   0.003    -.0966803   -.0202237
                     x6 |   .2821622    .049775     5.67   0.000      .184605    .3797195
                     x7 |  -.0332008   .0279849    -1.19   0.235    -.0880501    .0216486
                    x90 |  -.1276778   .0907109    -1.41   0.159     -.305468    .0501124
                    x91 |   .0961159   .0916737     1.05   0.294    -.0835612     .275793
                    x92 |  -.1400043   .0976573    -1.43   0.152    -.3314091    .0514004
                    x93 |  -.0734557   .0916967    -0.80   0.423     -.253178    .1062665
                    x94 |   .1435742   .0862727     1.66   0.096    -.0255172    .3126656
                    x95 |   .0212452   .0898768     0.24   0.813    -.1549102    .1974006
                  _cons |   -1.24872   .6712769    -1.86   0.063    -2.564399    .0669587
-----------------------------------------------------------------------------------------

:   DW.ipw("ateu")
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -436.32795  
Iteration 2:   f(p) = -411.28933  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
Iteration 5:   f(p) = -411.19865  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.299227462              0   -1.630013723              0    -.451375265   -.3551910971    .0584519984    -.282162246    .0332007599    .1276777932
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.0961158854    .1400043185    .0734557382   -.1435741845   -.0212452286    1.248719931  |
     -------------------------------------------------------------------------------------------+

: 
: // tradeoff between CBPS-like balance and variance in weights
: 
:   DW.cbps("atet", 1)
  Step 1 (initial values from logit model):
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -435.82146  
Iteration 2:   f(p) = -411.28219  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  .00001735  
Iteration 1:   f(p) =  6.450e-06  
Iteration 2:   f(p) =  5.892e-06  
Iteration 3:   f(p) =  5.889e-06  
Iteration 4:   f(p) =  5.889e-06  
Iteration 5:   f(p) =  5.884e-06  
Iteration 6:   f(p) =  5.782e-06  
Iteration 7:   f(p) =  1.672e-06  
Iteration 8:   f(p) =  1.353e-06  
Iteration 9:   f(p) =  1.347e-06  
Iteration 10:  f(p) =  1.347e-06  
Iteration 11:  f(p) =  1.345e-06  
Iteration 12:  f(p) =  5.280e-07  
Iteration 13:  f(p) =  3.964e-07  
Iteration 14:  f(p) =  3.959e-07  
Iteration 15:  f(p) =  3.959e-07  
Iteration 16:  f(p) =  3.957e-07  
Iteration 17:  f(p) =  3.916e-07  
Iteration 18:  f(p) =  3.104e-07  
Iteration 19:  f(p) =  1.005e-07  
Iteration 20:  f(p) =  7.822e-08  
Iteration 21:  f(p) =  7.812e-08  
Iteration 22:  f(p) =  7.811e-08  
Iteration 23:  f(p) =  7.804e-08  
Iteration 24:  f(p) =  7.704e-08  
Iteration 25:  f(p) =  6.598e-08  
Iteration 26:  f(p) =  1.970e-08  
Iteration 27:  f(p) =  1.289e-08  
Iteration 28:  f(p) =  1.287e-08  
Iteration 29:  f(p) =  1.287e-08  
Iteration 30:  f(p) =  1.285e-08  
Iteration 31:  f(p) =  1.253e-08  
Iteration 32:  f(p) =  7.732e-09  
Iteration 33:  f(p) =  3.004e-09  
Iteration 34:  f(p) =  2.965e-09  
Iteration 35:  f(p) =  2.965e-09  
Iteration 36:  f(p) =  2.963e-09  
Iteration 37:  f(p) =  2.943e-09  
Iteration 38:  f(p) =  2.704e-09  
Iteration 39:  f(p) =  1.395e-09  
Iteration 40:  f(p) =  6.870e-10  
Iteration 41:  f(p) =  6.666e-10  
Iteration 42:  f(p) =  6.665e-10  
Iteration 43:  f(p) =  6.665e-10  
Iteration 44:  f(p) =  6.654e-10  
Iteration 45:  f(p) =  6.453e-10  
Iteration 46:  f(p) =  2.604e-10  
Iteration 47:  f(p) =  2.181e-10  
Iteration 48:  f(p) =  2.181e-10  
Iteration 49:  f(p) =  2.181e-10  
Iteration 50:  f(p) =  1.511e-10  
Iteration 51:  f(p) =  5.741e-11  
Iteration 52:  f(p) =  5.109e-11  
Iteration 53:  f(p) =  5.109e-11  
Iteration 54:  f(p) =  5.109e-11  
Iteration 55:  f(p) =  4.908e-11  
Iteration 56:  f(p) =  6.255e-12  
Iteration 57:  f(p) =  1.133e-12  
Iteration 58:  f(p) =  1.133e-12  
Iteration 59:  f(p) =  1.130e-12  
Iteration 60:  f(p) =  3.275e-13  
Iteration 61:  f(p) =  1.520e-13  
Iteration 62:  f(p) =  1.511e-13  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.447067061              0   -1.546866037              0   -.4711118853   -.3822616589    .0635833869   -.2432315964    .0477039614       .1335012
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1336147998    .1522979455    .0757708004   -.1016182953   -.0383404468    .6265999323  |
     -------------------------------------------------------------------------------------------+

:   DW.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4512231   .4512189   4.26e-06   8.54e-06   .4990018    1.00433
             |
          x2 |
          0  |  (empty)
          1  |  .0114039   .0114041  -1.89e-07  -1.77e-06   .1064741   1.004312
             |
          x3 |
          0  |  (empty)
          1  |  .0240637   .0240628   9.22e-07   6.00e-06   .1536741   1.004365
             |
          x4 |  .4218861   .4218849   1.21e-06   2.45e-06   .4952368   1.004329
          x5 |  25.44699   25.44697   .0000137   2.52e-06   5.422129   .6144636
          x6 |  11.84757   11.84755   .0000196   .0000119   1.641931   .5982538
          x7 |  7.015422    7.01543  -8.55e-06  -2.40e-06   3.555432   1.161762
         x90 |  .0839738   .0839754  -1.58e-06  -1.65e-06   .9597153   .8505311
         x91 | -.0648837  -.0648849   1.23e-06   1.31e-06     .93861   .9922921
         x92 |  .0575388   .0575408  -2.04e-06  -1.97e-06    1.03554   1.118264
         x93 |  .1016523   .1016503   2.03e-06   2.14e-06   .9463749   1.012574
         x94 | -.1252265  -.1252288   2.34e-06   2.56e-06   .9147554   .7576608
         x95 | -.1044649  -.1044664   1.41e-06   1.55e-06   .9069849   .8646446
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  5.75964e-12
  Mean absolute standardized diff.
  3.59851e-06
  Maximum absolute standardized diff.
  .0000119129
  C.V. of matching weights:
  1.031943603
  S.D. of matching weights:
  1.027126741
  Skewness of matching weights:
  .1135031637
  Kurtosis of matching weights:
  .0229213062
  Maximum matching weight:
  7.00792466
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3431.367     3431.366   .0005901   3.70e-06   3431.366
   y1_binary |    .9509094     .9509091   2.71e-07   5.55e-06   .9509091
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   DW.psweight("atet","cbps", 1, (1,.75,6))
  Step 1 (initial values from logit model):
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -435.82146  
Iteration 2:   f(p) = -411.28219  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  .00093832  
Iteration 1:   f(p) =  .00004631  
Iteration 2:   f(p) =  .00003859  
Iteration 3:   f(p) =  .00003858  
Iteration 4:   f(p) =  .00003858  
Iteration 5:   f(p) =  .00003857  
Iteration 6:   f(p) =  .00003714  
Iteration 7:   f(p) =  .00001562  
Iteration 8:   f(p) =  .00001516  
Iteration 9:   f(p) =  .00001516  
Iteration 10:  f(p) =  .00001516  
Iteration 11:  f(p) =  .00001516  
Iteration 12:  f(p) =  .00001515  
Iteration 13:  f(p) =  .00001499  
Iteration 14:  f(p) =  .00001375  
Iteration 15:  f(p) =   .0000132  
Iteration 16:  f(p) =  .00001318  
Iteration 17:  f(p) =  .00001318  
Iteration 18:  f(p) =  .00001318  
Iteration 19:  f(p) =  .00001318  
Iteration 20:  f(p) =  .00001311  
Iteration 21:  f(p) =  .00001279  
Iteration 22:  f(p) =  .00001268  
Iteration 23:  f(p) =  .00001268  
Iteration 24:  f(p) =  .00001268  
Iteration 25:  f(p) =  .00001268  
Iteration 26:  f(p) =  .00001268  
Iteration 27:  f(p) =  .00001266  
Iteration 28:  f(p) =  .00001255  
Iteration 29:  f(p) =   .0000125  
Iteration 30:  f(p) =   .0000125  
Iteration 31:  f(p) =   .0000125  
Iteration 32:  f(p) =   .0000125  
Iteration 33:  f(p) =   .0000125  
Iteration 34:  f(p) =   .0000125  
Iteration 35:  f(p) =  .00001247  
Iteration 36:  f(p) =  .00001247  
Iteration 37:  f(p) =  .00001247  
Iteration 38:  f(p) =  .00001247  
Iteration 39:  f(p) =  .00001247  
Iteration 40:  f(p) =  .00001247  
Iteration 41:  f(p) =  .00001247  
Iteration 42:  f(p) =  .00001247  
Iteration 43:  f(p) =  .00001247  
Iteration 44:  f(p) =  .00001247  
Iteration 45:  f(p) =  .00001247  
Iteration 46:  f(p) =  .00001247  
Iteration 47:  f(p) =  .00001247  
Iteration 48:  f(p) =  .00001247  
Iteration 49:  f(p) =  .00001247  
Iteration 50:  f(p) =  .00001247  
Iteration 51:  f(p) =  .00001247  
Iteration 52:  f(p) =  .00001247  
Iteration 53:  f(p) =  .00001247  
Iteration 54:  f(p) =  .00001247  
Iteration 55:  f(p) =  .00001247  
Iteration 56:  f(p) =  .00001246  
Iteration 57:  f(p) =  .00001246  
Iteration 58:  f(p) =  .00001246  
Iteration 59:  f(p) =  .00001246  
Iteration 60:  f(p) =  .00001246  
Iteration 61:  f(p) =  .00001246  
Iteration 62:  f(p) =  .00001246  
Iteration 63:  f(p) =  .00001246  
Iteration 64:  f(p) =  .00001246  
Iteration 65:  f(p) =  .00001246  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.254181138              0   -1.322942876              0    -.373787908   -.3150736323    .0538649994   -.2073469848    .0392196568    .1112073749
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1096078376     .125103646    .0659519534   -.0938199887   -.0291288696    .4369062311  |
     -------------------------------------------------------------------------------------------+

:   DW.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4512231   .4880522  -.0368291  -.0738055   .4990018   .9953384
             |
          x2 |
          0  |  (empty)
          1  |  .0114039   .0133716  -.0019677  -.0184809   .1064741   .8582416
             |
          x3 |
          0  |  (empty)
          1  |  .0240637   .0267065  -.0026428  -.0171972   .1536741   .9074009
             |
          x4 |  .4218861   .4355796  -.0136935  -.0276505   .4952368   .9963546
          x5 |  25.44699   25.52567  -.0786887  -.0145125   5.422129   .6374814
          x6 |  11.84757    12.0082  -.1606282  -.0978288   1.641931   .5789037
          x7 |  7.015422    6.96308   .0523413   .0147215   3.555432   1.157512
         x90 |  .0839738   .0663453   .0176285   .0183685   .9597153   .8599203
         x91 | -.0648837  -.0552227   -.009661  -.0102929     .93861   .9716611
         x92 |  .0575388   .0443219   .0132169   .0127633    1.03554   1.110882
         x93 |  .1016523   .0920433    .009609   .0101535   .9463749   .9946047
         x94 | -.1252265  -.1096389  -.0155876  -.0170402   .9147554    .770958
         x95 | -.1044649  -.0986898  -.0057751  -.0063674   .9069849   .8554811
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  .0003053599
  Mean absolute standardized diff.
  .026090974
  Maximum absolute standardized diff.
  .097828831
  C.V. of matching weights:
  .8670543817
  S.D. of matching weights:
  .8635481851
  Skewness of matching weights:
  .0962286395
  Kurtosis of matching weights:
  .0177408164
  Maximum matching weight:
  5.513144372
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3431.705     3436.509   -4.80385    -.03128   3436.509
   y1_binary |    .9509266     .9524272  -.0015006  -.0323358   .9524272
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   DW.psweight("atet","cbps", 1, (1,.50,6))
  Step 1 (initial values from logit model):
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -435.82146  
Iteration 2:   f(p) = -411.28219  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
  
  Step 2 (CBPS) :
Iteration 0:   f(p) =  .03149776  
Iteration 1:   f(p) =  .00028651  
Iteration 2:   f(p) =  .00020393  
Iteration 3:   f(p) =  .00019258  
Iteration 4:   f(p) =  .00019213  
Iteration 5:   f(p) =  .00019201  
Iteration 6:   f(p) =  .00019201  
Iteration 7:   f(p) =  .00019103  
Iteration 8:   f(p) =  .00015724  
Iteration 9:   f(p) =  .00012566  
Iteration 10:  f(p) =  .00012402  
Iteration 11:  f(p) =   .0001237  
Iteration 12:  f(p) =  .00012357  
Iteration 13:  f(p) =  .00012356  
Iteration 14:  f(p) =  .00012356  
Iteration 15:  f(p) =  .00012354  
Iteration 16:  f(p) =  .00012314  
Iteration 17:  f(p) =   .0001185  
Iteration 18:  f(p) =  .00009057  
Iteration 19:  f(p) =  .00008183  
Iteration 20:  f(p) =  .00008118  
Iteration 21:  f(p) =  .00008114  
Iteration 22:  f(p) =  .00008114  
Iteration 23:  f(p) =  .00008114  
Iteration 24:  f(p) =  .00008113  
Iteration 25:  f(p) =  .00008107  
Iteration 26:  f(p) =  .00008051  
Iteration 27:  f(p) =  .00007995  
Iteration 28:  f(p) =  .00007994  
Iteration 29:  f(p) =  .00007994  
Iteration 30:  f(p) =  .00007994  
Iteration 31:  f(p) =  .00007994  
Iteration 32:  f(p) =  .00007991  
Iteration 33:  f(p) =  .00007979  
Iteration 34:  f(p) =  .00007971  
Iteration 35:  f(p) =  .00007971  
Iteration 36:  f(p) =  .00007971  
Iteration 37:  f(p) =  .00007971  
Iteration 38:  f(p) =  .00007971  
Iteration 39:  f(p) =  .00007969  
Iteration 40:  f(p) =  .00007968  
Iteration 41:  f(p) =  .00007968  
Iteration 42:  f(p) =  .00007968  
Iteration 43:  f(p) =  .00007968  
Iteration 44:  f(p) =  .00007967  
Iteration 45:  f(p) =  .00007967  
Iteration 46:  f(p) =  .00007967  
Iteration 47:  f(p) =  .00007967  
Iteration 48:  f(p) =  .00007967  
Iteration 49:  f(p) =  .00007967  
Iteration 50:  f(p) =  .00007967  
Iteration 51:  f(p) =  .00007967  
Iteration 52:  f(p) =  .00007967  
Iteration 53:  f(p) =  .00007967  
Iteration 54:  f(p) =  .00007967  
Iteration 55:  f(p) =  .00007967  
Iteration 56:  f(p) =  .00007967  
Iteration 57:  f(p) =  .00007967  
Iteration 58:  f(p) =  .00007967  
Iteration 59:  f(p) =  .00007967  
Iteration 60:  f(p) =  .00007967  
Iteration 61:  f(p) =  .00007967  
Iteration 62:  f(p) =  .00007967  
Iteration 63:  f(p) =  .00007967  
Iteration 64:  f(p) =  .00007967  
Iteration 65:  f(p) =  .00007967  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -.9697348004              0   -1.009947518              0     -.26811931   -.2328723647    .0401949297   -.1592826071     .028482756    .0826326725
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1     -.079365708    .0918013258    .0506791799   -.0790893461    -.017796856    .1432517744  |
     -------------------------------------------------------------------------------------------+

:   DW.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4512231   .5455565  -.0943333  -.1890441   .4990018   1.003097
             |
          x2 |
          0  |  (empty)
          1  |  .0114039   .0163288  -.0049249  -.0462544   .1064741   .7049256
             |
          x3 |
          0  |  (empty)
          1  |  .0240637   .0302591  -.0061954  -.0403152   .1536741   .8037995
             |
          x4 |  .4218861   .4518912  -.0300051  -.0605875   .4952368   .9889709
          x5 |  25.44699   25.68607  -.2390886   -.044095   5.422129   .6743964
          x6 |  11.84757   12.24705  -.3994826  -.2433005   1.641931   .5553463
          x7 |  7.015422    6.89603   .1193915     .03358   3.555432   1.154005
         x90 |  .0839738   .0421686   .0418053   .0435601   .9597153   .8752326
         x91 | -.0648837  -.0430192  -.0218646  -.0232946     .93861   .9459255
         x92 |  .0575388   .0282771   .0292616   .0282573    1.03554   1.101599
         x93 |  .1016523   .0789374   .0227149    .024002   .9463749   .9718368
         x94 | -.1252265  -.0859457  -.0392808  -.0429413   .9147554   .7889919
         x95 | -.1044649  -.0909646  -.0135004  -.0148849   .9069849   .8447606
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  .0019585256
  Mean absolute standardized diff.
  .0641628423
  Maximum absolute standardized diff.
  .243300532
  C.V. of matching weights:
  .6486308156
  S.D. of matching weights:
  .6465924813
  Skewness of matching weights:
  .075272891
  Kurtosis of matching weights:
  .0127428766
  Maximum matching weight:
  3.883536568
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3433.335     3443.147  -9.811935   -.067213   3443.147
   y1_binary |     .950974     .9546103  -.0036363  -.0831634   .9546103
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   st_local("mlopts", " nonrtolerance")

:   DW.psweight("atet","mean_sd_sq", 1, (1,.75,6))
  Step 1 (initial values from logit model):
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -436.32795  
Iteration 2:   f(p) = -411.28933  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
Iteration 5:   f(p) = -411.19865  
  
  Step 2 (CBPS) :
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 0:   f(p) =  .00118407  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 1:   f(p) =  .00047827  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 2:   f(p) =  .00006974  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 3:   f(p) =  .00004509  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 4:   f(p) =  9.893e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 5:   f(p) =  2.962e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 6:   f(p) =  1.695e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 7:   f(p) =  6.547e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 8:   f(p) =  2.889e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 9:   f(p) =  1.307e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 10:  f(p) =  8.557e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 11:  f(p) =  7.610e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 12:  f(p) =  6.398e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 13:  f(p) =  6.152e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 14:  f(p) =  6.114e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 15:  f(p) =  6.091e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 16:  f(p) =  6.081e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 17:  f(p) =  5.990e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 18:  f(p) =  4.580e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 19:  f(p) =  4.132e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 20:  f(p) =  2.418e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 21:  f(p) =  1.342e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 22:  f(p) =  1.205e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 23:  f(p) =  3.104e-09  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 24:  f(p) =  2.120e-09  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 25:  f(p) =  8.860e-10  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 26:  f(p) =  3.749e-10  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 27:  f(p) =  1.030e-10  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 28:  f(p) =  2.922e-11  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 29:  f(p) =  2.038e-11  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.208197689              0   -1.629451206              0   -.4531253713   -.3193344836    .0014374101   -.0045749296   -.0755494039    .0258804298
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1     -.124918566    .0509887695   -.0104291029   -.0914520801   -.0549907672    1.261428679  |
     -------------------------------------------------------------------------------------------+

:   DW.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4512231   .4979598  -.0467367  -.0936603   .4990018   .9947866
             |
          x2 |
          0  |  (empty)
          1  |  .0114039   .0096845   .0017193   .0161481   .1064741   1.180579
             |
          x3 |
          0  |  (empty)
          1  |  .0240637   .0211689   .0028948   .0188374   .1536741   1.138292
             |
          x4 |  .4218861   .4809191   -.059033  -.1192016   .4952368   .9812442
          x5 |  25.44699   24.87951   .5674772   .1046595   5.422129   .7784627
          x6 |  11.84757    12.5669  -.7193294  -.4380997   1.641931   .5287003
          x7 |  7.015422   5.785062   1.230359   .3460506   3.555432   1.160607
         x90 |  .0839738   .0344768    .049497   .0515747   .9597153   .8413523
         x91 | -.0648837  -.0963036   .0314199   .0334749     .93861   .9517656
         x92 |  .0575388   .0508365   .0067023   .0064723    1.03554   1.082082
         x93 |  .1016523   .0484604   .0531919   .0562059   .9463749   .9767654
         x94 | -.1252265  -.1322908   .0070643   .0077226   .9147554   .8111541
         x95 | -.1044649  -.1133624   .0088975   .0098099   .9069849   .8531474
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  1.95398e-13
  Mean absolute standardized diff.
  .1001475077
  Maximum absolute standardized diff.
  .4380997181
  C.V. of matching weights:
  .7665013328
  S.D. of matching weights:
  .764942466
  Skewness of matching weights:
  .1049590387
  Kurtosis of matching weights:
  .0204808115
  Maximum matching weight:
  5.312906803
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |     3442.38     3466.121  -23.74095  -.1669312   3466.121
   y1_binary |    .9527962     .9689016  -.0161054  -.4468055   .9689016
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
: 
:   DW.psweight("atet","mean_sd_sq", 1, (1,.50,6))
  Step 1 (initial values from logit model):
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -436.32795  
Iteration 2:   f(p) = -411.28933  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
Iteration 5:   f(p) = -411.19865  
  
  Step 2 (CBPS) :
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 0:   f(p) =  .03174366  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 1:   f(p) =  .01880683  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 2:   f(p) =  .01499079  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 3:   f(p) =  .00460016  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 4:   f(p) =  .00088681  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 5:   f(p) =  .00069868  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 6:   f(p) =  .00016284  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 7:   f(p) =  .00008031  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 8:   f(p) =  .00004972  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 9:   f(p) =  .00003906  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 10:  f(p) =  .00003723  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 11:  f(p) =  .00002755  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 12:  f(p) =  .00001175  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 13:  f(p) =  8.513e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 14:  f(p) =  7.187e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 15:  f(p) =  7.095e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 16:  f(p) =  6.862e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 17:  f(p) =  6.265e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 18:  f(p) =  2.861e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 19:  f(p) =  1.002e-06  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 20:  f(p) =  4.679e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 21:  f(p) =  1.693e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 22:  f(p) =  1.196e-07  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 23:  f(p) =  9.990e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 24:  f(p) =  9.395e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 25:  f(p) =  9.361e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 26:  f(p) =  9.191e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 27:  f(p) =  9.100e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 28:  f(p) =  9.094e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 29:  f(p) =  9.037e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 30:  f(p) =  9.011e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 31:  f(p) =  9.006e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 32:  f(p) =  8.967e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 33:  f(p) =  7.641e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 34:  f(p) =  1.980e-08  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 35:  f(p) =  6.924e-09  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 36:  f(p) =  3.256e-09  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 37:  f(p) =  8.736e-10  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 38:  f(p) =  2.764e-11  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 39:  f(p) =  2.322e-11  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -.6087013395              0   -1.629700158              0   -.4702072123   -.2183411476   -.0048213223   -.0275477107   -.0334676704    -.131177768
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.1519179177   -.1700237733   -.1077248451    -.064153889   -.1816207716    1.248128039  |
     -------------------------------------------------------------------------------------------+

:   DW.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4512231   .6243065  -.1730834  -.3468592   .4990018   1.060306
             |
          x2 |
          0  |  (empty)
          1  |  .0114039   .0076971   .0037068   .0348137   .1064741   1.482433
             |
          x3 |
          0  |  (empty)
          1  |  .0240637    .021424   .0026397   .0171771   .1536741    1.12503
             |
          x4 |  .4218861   .4972791   -.075393  -.1522363   .4952368   .9798442
          x5 |  25.44699   25.47438  -.0273978   -.005053   5.422129   .7913316
          x6 |  11.84757   12.67253  -.8249608  -.5024333   1.641931   .5217328
          x7 |  7.015422   6.370187   .6452342   .1814784   3.555432   1.121064
         x90 |  .0839738  -.1313171   .2152909   .2243279   .9597153   .8834873
         x91 | -.0648837  -.1264568   .0615731   .0656003     .93861   .9535062
         x92 |  .0575388  -.1823564   .2398951   .2316618    1.03554    1.08368
         x93 |  .1016523  -.0507504   .1524027   .1610384   .9463749   .8930272
         x94 | -.1252265  -.0840925  -.0411339  -.0449672   .9147554   .8214365
         x95 | -.1044649  -.2273282   .1228633   .1354634   .9069849   .8445254
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  8.84689e-13
  Mean absolute standardized diff.
  .1617776917
  Maximum absolute standardized diff.
  .5024333327
  C.V. of matching weights:
  .5167814151
  S.D. of matching weights:
  .5161926947
  Skewness of matching weights:
  .0687147553
  Kurtosis of matching weights:
  .0139619518
  Maximum matching weight:
  3.306047969
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3447.637     3476.778  -29.14083  -.1819619   3476.778
   y1_binary |    .9516739     .9624371  -.0107632   -.263479   .9624371
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

: 
:   DW.psweight("atet","mean_sd_sq", 1)
  Step 1 (initial values from logit model):
initial:       f(p) = -681.05307
alternative:   f(p) =  -555.8915
rescale:       f(p) = -485.05844
Iteration 0:   f(p) = -485.05844  
Iteration 1:   f(p) = -436.32795  
Iteration 2:   f(p) = -411.28933  
Iteration 3:   f(p) = -411.19869  
Iteration 4:   f(p) = -411.19865  
Iteration 5:   f(p) = -411.19865  
  
  Step 2 (CBPS) :
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 0:   f(p) =  .00026309  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 1:   f(p) =  .00001126  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 2:   f(p) =  4.733e-09  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 3:   f(p) =  1.761e-13  
numerical derivatives are approximate
flat or discontinuous region encountered
Iteration 4:   f(p) =  1.988e-21  
                  1              2              3              4              5              6              7              8              9             10
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
  1 |  -1.298300659              0   -1.629910465              0   -.4511737895   -.3553036347    .0715800494   -.2773324041    .0371348758    .1283825514
    +-------------------------------------------------------------------------------------------------------------------------------------------------------
                 11             12             13             14             15             16
     -------------------------------------------------------------------------------------------+
  1    -.0952384663    .1409151847     .074303883   -.1419191912   -.0201500497     1.24895601  |
     -------------------------------------------------------------------------------------------+

:   DW.balanceresults("atet",1)
  Balance:
-------------------------------------------------------------------------------
             |    mean_T     mean_C       diff   std_diff       sd_T  var_ratio
-------------+-----------------------------------------------------------------
          x1 |  .4512231    .487981  -.0367579  -.0736628   .4990018   .9953452
             |
          x2 |
          0  |  (empty)
          1  |  .0114039   .0101189   .0012849   .0120681   .1064741   1.130392
             |
          x3 |
          0  |  (empty)
          1  |  .0240637   .0243904  -.0003267   -.002126   .1536741    .991207
             |
          x4 |  .4218861   .4077073   .0141788   .0286304   .4952368   1.014377
          x5 |  25.44699   25.93854  -.4915548  -.0906572   5.422129   .5820455
          x6 |  11.84757   11.77832   .0692519   .0421771   1.641931   .5870658
          x7 |  7.015422   6.877177   .1382443   .0388826   3.555432   1.150412
         x90 |  .0839738   .0558962   .0280776   .0292562   .9597153   .8505932
         x91 | -.0648837  -.0314162  -.0334675  -.0356565     .93861   .9896463
         x92 |  .0575388   .0508005   .0067383    .006507    1.03554   1.132825
         x93 |  .1016523   .1109109  -.0092586  -.0097833   .9463749   1.021042
         x94 | -.1252265  -.1752569   .0500305   .0546928   .9147554   .7291541
         x95 | -.1044649   -.104167  -.0002979  -.0003285   .9069849   .8690485
-------------------------------------------------------------------------------
  
  Mean standardized diff., squared
  1.98817e-21
  Mean absolute standardized diff.
  .0326483296
  Maximum absolute standardized diff.
  .0906571688
  C.V. of matching weights:
  1.06701684
  S.D. of matching weights:
  1.064358816
  Skewness of matching weights:
  .1583892384
  Kurtosis of matching weights:
  .0509012068
  Maximum matching weight:
  10.57744036
  Prognostic scores:
------------------------------------------------------------------------
             | mean_yhat_T  mean_yhat_C       diff   std_diff   mean_y_C
-------------+----------------------------------------------------------
          y1 |    3431.445     3432.164  -.7196184  -.0044215   3432.164
   y1_binary |    .9507734     .9518109  -.0010374  -.0207557   .9518109
------------------------------------------------------------------------
  Note: The std_diff column does not account for the standard error of the linear predictions.

:   st_local("mlopts", "")

: 
:   // you can also target skiwness, kurtosis, or max weight, but it's finicky
: 
: end  // end of Mata block
----------------------------------------------------------------------------------------------------------------------------------------------------------------

. 
. log close psweight_example
      name:  psweight_example
       log:  C:\Users\kkranker\Documents\Stata\Ado\Devel\gmatch\psweight_example.log
  log type:  text
 closed on:   7 Mar 2019, 22:12:00
----------------------------------------------------------------------------------------------------------------------------------------------------------------
