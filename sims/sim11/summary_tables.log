------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  sim11_tables
       log:  C:\Users\kkranker\Documents\Stata\psweight\code-psweight\sims/sim11/summary_tables.log
  log type:  text
 opened on:  21 Oct 2019, 13:13:08

. 
. *! BPO CBPS Simulation
. // Repackage the results from simulation #11 into ready-to-use tables.
. //
. *! By Keith Kranker
. //
. // Note - This code was "hacked." I ran most of the simulations back for the first paper draft.
. // Then, after we got the R&R from TAS, I ran ***ONLY*** three additional estimators.
. // Then in this file I patched the old and new data files together and summarized the results.
. //
. // Copyright (C) Mathematica Policy Research, Inc.
. // This code cannot be copied, distributed or used without the express written
. // permission of Mathematica Policy Research, Inc.
. 
. mac list _sim
_sim:           11

. qui adopath ++ ./sims/

. 
. // there was a mistake in the old version on sim_reshape.ado; I'm re-running here with the fixed version
. use sims/sim`sim'/Data_append.dta, clear
(simulate: onerep_ksir)

. 
. 
. // sort variables into groups
. unab stats : impact_est-wgt_kurtosis Nt mae pct_bias

. unab sumstats : rmse impact_est_var

. unab scenario: result dataset dgp N estimator augmented true

. unab  allleft : _all

. local allleft : list allleft - stats

. local allleft : list allleft - sumstats

. local allleft : list allleft - scenario

. mac list _allleft
_allleft:       rep

. assert "`allleft'"=="rep"

. 
. // update labels
. label list aug est
aug:
           0 Unadjusted
           1 Reg. adjusted
est:
           1 RAW
           2 IPW_TRUE_PS
           3 STDPROGDIFF
           4 IPW_TE
           5 IPW
           6 TRIM
           7 EBALANCE
           8 RF
           9 IPWCBPS
          10 CBPS
          11 CBPS99_9
          12 CBPS99
          13 CBPS98
          14 CBPS97
          15 CBPS95
          16 CBPS93
          17 CBPS90
          18 CBPS85
          19 CBPS80
          20 CBPS75
          21 CBPS50
          22 DISCARD

. qui {

. label define aug 0 "IPW" 1 "WLS", modify

. 
. recode estimator ///
>            ( 5 =   1 "Logit regression") ///
>            ( 6 =   2 "Logit regression, with trimming") ///
>            ( 8 =   4 "Random forest classifier") ///
>            ( 9 =   5 "CBPS, over identified") ///
>            (10 =   6 "CBPS, just identified") ///
>            (12 =   7 "PCBPS 99%") ///
>            (14 =   8 "PCBPS 97%") ///
>            (15 =   9 "PCBPS 95%") ///
>            (17 =  10 "PCBPS 90%") ///
>            (20 =  11 "PCBPS 75%") ///
>            ( 2 =  12 "True propensity score") ///
>            ( 1 =  13 "None (unweighted data)") ///
>            (else = 999 "<discarded>") ///
>            , gen(estimator_recode)
(2040000 differences between estimator and estimator_recode)

. recode estimator_ ///
>              (  6 = 100  ) ///
>              (  7 =  99  ) ///
>              (  8 =  97  ) ///
>              (  9 =  95  ) ///
>              ( 10 =  90  ) ///
>              ( 11 =  75  ) ///
>              (else = 0), ///
>              gen(cbps_pct)
(2040000 differences between estimator_recode and cbps_pct)

. tablist estimator_ cbps_pct estimator, sep(0) sort(v)

  +------------------------------------------------------------------------------------------------+
  |                estimator_recode   cbps_pct     estimator   _Freq_   _Perc_   _CFreq_   _CPerc_ |
  |------------------------------------------------------------------------------------------------|
  |                Logit regression          0           IPW   100000     4.90    100000      4.90 |
  | Logit regression, with trimming          0          TRIM   100000     4.90    200000      9.80 |
  |        Random forest classifier          0            RF   100000     4.90    300000     14.71 |
  |           CBPS, over identified          0       IPWCBPS   100000     4.90    400000     19.61 |
  |           CBPS, just identified        100          CBPS   100000     4.90    500000     24.51 |
  |                       PCBPS 99%         99        CBPS99   100000     4.90    600000     29.41 |
  |                       PCBPS 97%         97        CBPS97   100000     4.90    700000     34.31 |
  |                       PCBPS 95%         95        CBPS95   100000     4.90    800000     39.22 |
  |                       PCBPS 90%         90        CBPS90   100000     4.90    900000     44.12 |
  |                       PCBPS 75%         75        CBPS75   100000     4.90   1000000     49.02 |
  |           True propensity score          0   IPW_TRUE_PS   100000     4.90   1100000     53.92 |
  |          None (unweighted data)          0           RAW   100000     4.90   1200000     58.82 |
  |                     <discarded>          0   STDPROGDIFF    40000     1.96   1240000     60.78 |
  |                     <discarded>          0      EBALANCE   100000     4.90   1340000     65.69 |
  |                     <discarded>          0      CBPS99_9   100000     4.90   1440000     70.59 |
  |                     <discarded>          0        CBPS98   100000     4.90   1540000     75.49 |
  |                     <discarded>          0        CBPS93   100000     4.90   1640000     80.39 |
  |                     <discarded>          0        CBPS85   100000     4.90   1740000     85.29 |
  |                     <discarded>          0        CBPS80   100000     4.90   1840000     90.20 |
  |                     <discarded>          0        CBPS50   100000     4.90   1940000     95.10 |
  |                     <discarded>          0       DISCARD   100000     4.90   2040000    100.00 |
  +------------------------------------------------------------------------------------------------+

. order  estimator_ , after(estimator)

. rename estimator old_estimator

. local scenario `macval(scenario)' cbps_pct

. 
. // select cells to show in the final tables
. // drop "prog";
. // drop several different % for PCBPS -- all these different targets were overkill
. // the 99.9 doesn't clearly do anything -- virtually the same as CBPS in many settings
. // also drop N = 25 / 100 because our editor wanted a simpler table
. // in some tables/figures, only show 2 sample sizes
. local ifstmnt !inlist(estimator, 999) & !inlist(N, 25, 100)

. local 2ns     inlist(N, 50, 1000)

. 
. // box plots of impact estimates
. levelsof N, local(Narray)
25 50 100 200 1000

. set scheme s2manual_KAK

. graph hbox impact_est if `ifstmnt' & `2ns', ///
>   over(estimator) nooutsides ///
>   ytitle("Distribution of impact estimates" "(true impact = 0)", size(vsmall)) ysize(6.5) ylab(0) xsize(6.5) ///
>   by(N augmented, norescale colfirst iscale(*.6) iylabel title("") note("Outside values not shown", size(vsmall))) note("")

. graph save   sims/sim`sim'/hbox_impact_est.gph, replace
(file sims/sim11/hbox_impact_est.gph saved)

. graph export sims/sim`sim'/hbox_impact_est.emf, replace
(file C:\Users\kkranker\Documents\Stata\psweight\code-psweight\sims/sim11/hbox_impact_est.emf written in Enhanced Metafile format)

. graph export sims/sim`sim'/hbox_impact_est.png, replace
(file sims/sim11/hbox_impact_est.png written in PNG format)

. 
. // collapse down to 1 row per scenario/estimator
. isid rep `scenario'

. collapse (count) n_reps=impact_est n_reps_attempt=rep ///
>          (mean) `stats' ///
>          (firstnm) `sumstats' ///
>          (max) n_reps_attempt_alt = rep ///
>          , by(`scenario' old_estimator)

. assert n_reps_attempt_alt == n_reps_attempt

. drop   n_reps_attempt_alt

. 
. // format numbers so tables look good
. replace reject_0 = reject_0*100
(204 real changes made)

. replace covered  = covered*100
(201 real changes made)

. format %7.1fc reject_0 covered wgt_max

. format %7.0fc n_reps*

. format %7.3fc power_zstat_0 p_0 bal_max_asd bal_mean_asd wgt_sd wgt_cv wgt_skewness wgt_kurtosis

. format %7.2fc impact_est sd_error bias error_sqr rmse impact_est_var

. 
. // save dataset
. save "sims/sim`sim'/1-row summary.dta", replace
file sims/sim11/1-row summary.dta saved

. 
. // wide tables with ALL the results - columns are N's and reg-adjusted
. foreach v of var n_reps* `stats' `sumstats' {
  2.   di _n(2) as res `"`v'  `:var lab `v''"'
  3.   tabdisp old_estimator N augmented, c(`v') format(`:format `v'') stubwidth(13)
  4. }


n_reps  (count) impact_est

--------------------------------------------------------------------------------------
              |                            augmented and N                            
              | -------------- IPW --------------    -------------- WLS --------------
old_estimator |    25     50    100    200   1000       25     50    100    200   1000
--------------+-----------------------------------------------------------------------
          RAW | 5,000  5,000  5,000  5,000  5,000    5,000  5,000  5,000  5,000  5,000
  IPW_TRUE_PS | 5,000  5,000  5,000  5,000  5,000    5,000  5,000  5,000  5,000  5,000
  STDPROGDIFF |    23                   95              23                   95       
          IPW | 4,911  4,999  5,000  5,000  5,000    4,911  4,999  5,000  5,000  5,000
         TRIM | 4,906  5,000  5,000  5,000  5,000    4,906  5,000  5,000  5,000  5,000
     EBALANCE |   475  3,588  4,843  4,999  5,000      475  3,588  4,843  4,999  5,000
           RF | 5,000  5,000  4,998  4,992  4,866    5,000  5,000  4,998  4,992  4,866
      IPWCBPS | 4,936  4,988  5,000  5,000  5,000    4,936  4,988  5,000  5,000  5,000
         CBPS | 4,977  4,998  5,000  5,000  5,000    4,977  4,998  5,000  5,000  5,000
     CBPS99_9 | 4,944  4,979  4,988  4,997  4,998    4,944  4,979  4,988  4,997  4,998
       CBPS99 | 4,943  4,979  4,996  4,999  5,000    4,943  4,979  4,996  4,999  5,000
       CBPS98 | 4,957  4,984  4,997  5,000  5,000    4,957  4,984  4,997  5,000  5,000
       CBPS97 | 4,932  4,981  4,995  4,999  5,000    4,932  4,981  4,995  4,999  5,000
       CBPS95 | 4,959  4,988  4,996  4,996  5,000    4,959  4,988  4,996  4,996  5,000
       CBPS93 | 4,974  4,993  4,996  5,000  5,000    4,974  4,993  4,996  5,000  5,000
       CBPS90 | 4,976  4,997  4,998  4,999  5,000    4,976  4,997  4,998  4,999  5,000
       CBPS85 | 4,977  4,995  4,998  4,999  5,000    4,977  4,995  4,998  4,999  5,000
       CBPS80 | 4,988  4,996  4,998  5,000  5,000    4,988  4,996  4,998  5,000  5,000
       CBPS75 | 4,991  4,997  4,998  4,999  5,000    4,991  4,997  4,998  4,999  5,000
       CBPS50 | 4,995  5,000  4,999  5,000  5,000    4,995  5,000  4,999  5,000  5,000
      DISCARD | 4,902  4,999  4,999  4,998  5,000    4,902  4,999  4,999  4,998  5,000
--------------------------------------------------------------------------------------


n_reps_attempt  (count) rep

------------------------------------------------------------------------------------------------
              |                                 augmented and N                                 
              | ----------------- IPW ----------------    ----------------- WLS ----------------
old_estimator |     25      50     100     200    1000        25      50     100     200    1000
--------------+---------------------------------------------------------------------------------
          RAW | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
  IPW_TRUE_PS | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
  STDPROGDIFF | 10,000                  10,000            10,000                  10,000        
          IPW | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
         TRIM | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
     EBALANCE | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
           RF | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
      IPWCBPS | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
         CBPS | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
     CBPS99_9 | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
       CBPS99 | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
       CBPS98 | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
       CBPS97 | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
       CBPS95 | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
       CBPS93 | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
       CBPS90 | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
       CBPS85 | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
       CBPS80 | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
       CBPS75 | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
       CBPS50 | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
      DISCARD | 10,000  10,000  10,000  10,000  10,000    10,000  10,000  10,000  10,000  10,000
------------------------------------------------------------------------------------------------


impact_est  (mean) impact_est

------------------------------------------------------------------------------------------------
              |                                 augmented and N                                 
              | ----------------- IPW ----------------    ----------------- WLS ----------------
old_estimator |     25      50     100     200    1000        25      50     100     200    1000
--------------+---------------------------------------------------------------------------------
          RAW | -20.21  -20.09  -20.03  -20.00  -19.99     -5.44   -5.78   -6.11   -6.34   -6.51
  IPW_TRUE_PS |  -3.64   -2.00   -0.91   -0.46   -0.08     -1.70   -0.97   -0.47   -0.29   -0.04
  STDPROGDIFF |  -4.41                   -5.82             -2.29                   -5.55        
          IPW |  -9.13   -6.13   -3.94   -1.97    1.17     -4.31   -4.51   -4.79   -5.21   -5.96
         TRIM | -15.90  -15.56  -15.35  -15.16  -15.00     -4.95   -5.25   -5.50   -5.59   -5.72
     EBALANCE |  -3.99   -4.65   -4.81   -4.68   -4.45     -3.98   -4.63   -4.79   -4.65   -4.44
           RF | -20.21  -11.14  -10.45  -10.40   -7.93     -5.44   -4.22   -3.84   -3.65   -2.83
      IPWCBPS | -10.88   -8.93   -7.66   -6.63   -4.78     -4.39   -4.60   -4.85   -5.23   -5.94
         CBPS |  -7.88   -5.74   -5.20   -5.31   -5.96     -4.31   -4.42   -4.70   -5.13   -5.90
     CBPS99_9 |  -7.48   -5.58   -5.13   -5.29   -5.95     -4.22   -4.39   -4.69   -5.12   -5.90
       CBPS99 |  -7.54   -5.62   -5.16   -5.32   -5.99     -4.25   -4.40   -4.69   -5.13   -5.90
       CBPS98 |  -7.57   -5.69   -5.24   -5.41   -6.11     -4.23   -4.42   -4.70   -5.13   -5.90
       CBPS97 |  -7.62   -5.77   -5.33   -5.52   -6.22     -4.26   -4.42   -4.70   -5.14   -5.90
       CBPS95 |  -7.82   -6.00   -5.57   -5.76   -6.47     -4.28   -4.45   -4.72   -5.15   -5.90
       CBPS93 |  -8.04   -6.23   -5.81   -6.02   -6.71     -4.29   -4.46   -4.74   -5.16   -5.90
       CBPS90 |  -8.37   -6.58   -6.21   -6.42   -7.09     -4.33   -4.49   -4.77   -5.18   -5.90
       CBPS85 |  -8.89   -7.23   -6.89   -7.12   -7.75     -4.40   -4.56   -4.82   -5.22   -5.91
       CBPS80 |  -9.50   -7.90   -7.61   -7.85   -8.44     -4.48   -4.62   -4.87   -5.26   -5.91
       CBPS75 | -10.07   -8.59   -8.37   -8.61   -9.16     -4.54   -4.69   -4.94   -5.30   -5.91
       CBPS50 | -13.28  -12.45  -12.59  -12.95  -13.34     -4.89   -5.08   -5.31   -5.57   -5.92
      DISCARD | -31.56  -34.30  -35.28  -35.82  -36.31     -9.60  -11.06  -12.61  -13.78  -14.67
------------------------------------------------------------------------------------------------


sd_error  (mean) sd_error

--------------------------------------------------------------------------------------
              |                            augmented and N                            
              | -------------- IPW --------------    -------------- WLS --------------
old_estimator |    25     50    100    200   1000       25     50    100    200   1000
--------------+-----------------------------------------------------------------------
          RAW | 13.98   9.89   6.98   4.94   2.20     7.15   4.95   3.53   2.52   1.16
  IPW_TRUE_PS | 15.46  11.76   8.86   6.53   3.10     6.64   4.74   3.53   2.63   1.34
  STDPROGDIFF | 15.40                 6.33            6.51                 2.45       
          IPW | 15.00  11.85   9.38   7.69   5.37     6.05   4.53   3.38   2.50   1.28
         TRIM | 14.00   9.93   7.00   4.95   2.22     6.83   4.80   3.40   2.43   1.10
     EBALANCE | 15.45  11.85   8.66   6.04   2.69     5.40   4.28   3.24   2.33   1.06
           RF | 13.98  10.69   7.64   5.33   2.42     7.15   4.75   3.46   2.48   1.14
      IPWCBPS | 14.85  11.27   8.45   6.48   3.81     6.19   4.57   3.40   2.51   1.32
         CBPS | 15.59  12.05   8.98   6.65   3.41     5.93   4.57   3.45   2.56   1.35
     CBPS99_9 | 15.61  12.06   8.98   6.66   3.41     5.91   4.56   3.45   2.56   1.35
       CBPS99 | 15.59  12.06   8.98   6.65   3.40     5.92   4.56   3.45   2.56   1.35
       CBPS98 | 15.59  12.04   8.96   6.63   3.38     5.92   4.57   3.45   2.56   1.35
       CBPS97 | 15.59  12.02   8.94   6.61   3.36     5.93   4.56   3.45   2.56   1.35
       CBPS95 | 15.54  11.97   8.89   6.56   3.32     5.94   4.57   3.44   2.56   1.34
       CBPS93 | 15.51  11.92   8.84   6.52   3.28     5.96   4.57   3.44   2.55   1.34
       CBPS90 | 15.45  11.84   8.76   6.44   3.23     5.99   4.57   3.44   2.55   1.34
       CBPS85 | 15.35  11.69   8.62   6.31   3.13     6.02   4.57   3.43   2.54   1.34
       CBPS80 | 15.24  11.54   8.48   6.19   3.04     6.06   4.58   3.43   2.53   1.33
       CBPS75 | 15.14  11.40   8.34   6.06   2.95     6.11   4.58   3.42   2.53   1.32
       CBPS50 | 14.64  10.72   7.69   5.50   2.54     6.40   4.65   3.42   2.50   1.27
      DISCARD | 17.40  12.28   8.61   6.06   2.69    16.43  11.27   8.07   5.87   2.83
--------------------------------------------------------------------------------------


bias  (mean) bias

------------------------------------------------------------------------------------------------
              |                                 augmented and N                                 
              | ----------------- IPW ----------------    ----------------- WLS ----------------
old_estimator |     25      50     100     200    1000        25      50     100     200    1000
--------------+---------------------------------------------------------------------------------
          RAW | -20.21  -20.09  -20.03  -20.00  -19.99     -5.44   -5.78   -6.11   -6.34   -6.51
  IPW_TRUE_PS |  -3.64   -2.00   -0.91   -0.46   -0.08     -1.70   -0.97   -0.47   -0.29   -0.04
  STDPROGDIFF |  -4.41                   -5.82             -2.29                   -5.55        
          IPW |  -9.13   -6.13   -3.94   -1.97    1.17     -4.31   -4.51   -4.79   -5.21   -5.96
         TRIM | -15.90  -15.56  -15.35  -15.16  -15.00     -4.95   -5.25   -5.50   -5.59   -5.72
     EBALANCE |  -3.99   -4.65   -4.81   -4.68   -4.45     -3.98   -4.63   -4.79   -4.65   -4.44
           RF | -20.21  -11.14  -10.45  -10.40   -7.93     -5.44   -4.22   -3.84   -3.65   -2.83
      IPWCBPS | -10.88   -8.93   -7.66   -6.63   -4.78     -4.39   -4.60   -4.85   -5.23   -5.94
         CBPS |  -7.88   -5.74   -5.20   -5.31   -5.96     -4.31   -4.42   -4.70   -5.13   -5.90
     CBPS99_9 |  -7.48   -5.58   -5.13   -5.29   -5.95     -4.22   -4.39   -4.69   -5.12   -5.90
       CBPS99 |  -7.54   -5.62   -5.16   -5.32   -5.99     -4.25   -4.40   -4.69   -5.13   -5.90
       CBPS98 |  -7.57   -5.69   -5.24   -5.41   -6.11     -4.23   -4.42   -4.70   -5.13   -5.90
       CBPS97 |  -7.62   -5.77   -5.33   -5.52   -6.22     -4.26   -4.42   -4.70   -5.14   -5.90
       CBPS95 |  -7.82   -6.00   -5.57   -5.76   -6.47     -4.28   -4.45   -4.72   -5.15   -5.90
       CBPS93 |  -8.04   -6.23   -5.81   -6.02   -6.71     -4.29   -4.46   -4.74   -5.16   -5.90
       CBPS90 |  -8.37   -6.58   -6.21   -6.42   -7.09     -4.33   -4.49   -4.77   -5.18   -5.90
       CBPS85 |  -8.89   -7.23   -6.89   -7.12   -7.75     -4.40   -4.56   -4.82   -5.22   -5.91
       CBPS80 |  -9.50   -7.90   -7.61   -7.85   -8.44     -4.48   -4.62   -4.87   -5.26   -5.91
       CBPS75 | -10.07   -8.59   -8.37   -8.61   -9.16     -4.54   -4.69   -4.94   -5.30   -5.91
       CBPS50 | -13.28  -12.45  -12.59  -12.95  -13.34     -4.89   -5.08   -5.31   -5.57   -5.92
      DISCARD | -31.56  -34.30  -35.28  -35.82  -36.31     -9.60  -11.06  -12.61  -13.78  -14.67
------------------------------------------------------------------------------------------------


error_sqr  (mean) error_sqr

----------------------------------------------------------------------------------------------------------
              |                                      augmented and N                                      
              | ------------------- IPW -------------------    ------------------- WLS -------------------
old_estimator |      25       50      100      200     1000         25       50      100      200     1000
--------------+-------------------------------------------------------------------------------------------
          RAW |  603.92   500.05   450.49   424.82   404.36      87.67    59.81    50.93    47.13    43.86
  IPW_TRUE_PS |  324.28   169.22    92.55    47.57    10.05      62.50    30.35    16.37     9.02     2.07
  STDPROGDIFF |  180.13                      43.51               72.46                      39.23         
          IPW |  184.77   103.28    73.43    78.32   113.52      77.83    50.40    39.69    37.15    39.93
         TRIM |  400.08   307.28   265.36   244.03   228.08      78.98    53.85    42.96    37.54    33.98
     EBALANCE |   66.33    51.40    36.93    28.05    20.89      66.20    51.25    36.73    27.77    20.83
           RF |  603.92   173.64   130.18   117.86    64.50      87.67    41.95    25.02    17.56     8.68
      IPWCBPS |  213.10   118.33    77.90    54.76    28.65      78.04    50.05    39.54    36.74    38.32
         CBPS |  169.28    80.01    50.35    40.13    39.05      86.95    54.03    40.64    36.68    37.76
     CBPS99_9 |  151.34    73.95    47.77    39.51    38.77      85.28    53.56    40.41    36.65    37.74
       CBPS99 |  151.63    74.10    48.06    39.78    39.23      85.05    53.61    40.38    36.66    37.75
       CBPS98 |  151.95    74.83    48.77    40.64    40.65      85.44    53.53    40.42    36.68    37.75
       CBPS97 |  151.78    75.70    49.51    41.69    42.03      85.15    53.53    40.41    36.69    37.75
       CBPS95 |  155.07    78.00    51.76    44.17    44.99      84.98    53.45    40.42    36.75    37.74
       CBPS93 |  158.80    80.67    54.26    46.99    48.15      84.49    53.34    40.42    36.77    37.72
       CBPS90 |  163.74    84.17    58.66    51.64    53.29      84.24    53.10    40.45    36.84    37.70
       CBPS85 |  172.37    92.69    66.95    60.76    62.88      83.54    52.99    40.49    36.96    37.66
       CBPS80 |  185.55   102.61    77.29    71.54    73.87      83.14    52.80    40.60    37.11    37.60
       CBPS75 |  197.99   114.96    89.63    83.93    86.40      82.81    52.76    40.84    37.26    37.53
       CBPS50 |  292.69   208.25   185.43   182.04   181.23      81.63    53.68    42.90    39.03    37.22
      DISCARD | 1667.25  1548.45  1442.67  1391.38  1345.73    2956.95   335.72   261.44   243.60   229.09
----------------------------------------------------------------------------------------------------------


p_0  (mean) p_0

--------------------------------------------------------------------------------------
              |                            augmented and N                            
              | -------------- IPW --------------    -------------- WLS --------------
old_estimator |    25     50    100    200   1000       25     50    100    200   1000
--------------+-----------------------------------------------------------------------
          RAW | 0.266  0.141  0.044  0.004  0.000    0.415  0.329  0.201  0.074  0.000
  IPW_TRUE_PS | 0.450  0.469  0.472  0.478  0.493    0.451  0.458  0.457  0.457  0.478
  STDPROGDIFF | 0.534                0.404           0.441                0.135       
          IPW | 0.516  0.528  0.518  0.497  0.467    0.385  0.349  0.277  0.163  0.003
         TRIM | 0.348  0.217  0.084  0.015  0.000    0.419  0.342  0.225  0.100  0.000
     EBALANCE | 0.688  0.638  0.574  0.462  0.123    0.384  0.322  0.252  0.150  0.003
           RF | 0.266  0.357  0.240  0.092  0.004    0.415  0.388  0.348  0.242  0.042
      IPWCBPS | 0.482  0.452  0.397  0.337  0.225    0.392  0.351  0.274  0.158  0.002
         CBPS | 0.572  0.596  0.561  0.457  0.112    0.362  0.342  0.284  0.172  0.003
     CBPS99_9 | 0.580  0.601  0.562  0.458  0.112    0.363  0.343  0.284  0.172  0.003
       CBPS99 | 0.579  0.600  0.561  0.456  0.109    0.363  0.342  0.284  0.172  0.003
       CBPS98 | 0.579  0.598  0.557  0.449  0.100    0.364  0.343  0.284  0.172  0.003
       CBPS97 | 0.578  0.596  0.553  0.440  0.092    0.364  0.343  0.284  0.171  0.003
       CBPS95 | 0.574  0.589  0.540  0.420  0.076    0.365  0.343  0.283  0.169  0.003
       CBPS93 | 0.569  0.581  0.526  0.398  0.063    0.367  0.342  0.282  0.168  0.003
       CBPS90 | 0.562  0.569  0.502  0.364  0.045    0.369  0.343  0.281  0.165  0.002
       CBPS85 | 0.550  0.544  0.460  0.308  0.025    0.371  0.342  0.278  0.161  0.002
       CBPS80 | 0.534  0.515  0.415  0.253  0.012    0.373  0.342  0.275  0.157  0.002
       CBPS75 | 0.518  0.485  0.368  0.203  0.005    0.376  0.342  0.271  0.152  0.002
       CBPS50 | 0.425  0.325  0.170  0.048  0.000    0.391  0.337  0.246  0.124  0.001
      DISCARD | 0.221  0.116  0.034  0.004  0.000    0.396  0.333  0.248  0.123  0.001
--------------------------------------------------------------------------------------


reject_0  (mean) reject_0

--------------------------------------------------------------------------------------
              |                            augmented and N                            
              | -------------- IPW --------------    -------------- WLS --------------
old_estimator |    25     50    100    200   1000       25     50    100    200   1000
--------------+-----------------------------------------------------------------------
          RAW |  27.5   51.1   80.9   97.9  100.0     12.2   20.7   39.6   70.8  100.0
  IPW_TRUE_PS |  10.1    8.1    7.8    6.9    5.6      9.3    9.1    8.8    8.6    6.7
  STDPROGDIFF |   4.3                  1.1            13.0                 58.9       
          IPW |   4.3    2.8    1.8    2.6    6.4     16.8   21.2   32.2   52.7   98.8
         TRIM |  15.2   29.0   59.8   92.3  100.0     12.1   19.2   34.8   62.8  100.0
     EBALANCE |   0.2    0.4    0.3    0.6   24.1     16.6   23.3   32.2   51.5   98.9
           RF |  27.5    9.2   17.0   48.1   99.6     12.2   15.3   17.7   27.5   76.9
      IPWCBPS |   5.1    3.5    3.8    6.9   24.1     16.0   20.6   31.7   53.0   99.0
         CBPS |   4.3    2.0    1.6    1.6   31.6     19.6   22.6   31.7   51.3   98.7
     CBPS99_9 |   3.3    1.4    1.3    1.5   31.5     19.5   22.6   31.7   51.2   98.7
       CBPS99 |   3.5    1.5    1.3    1.6   32.6     19.4   22.6   31.7   51.2   98.7
       CBPS98 |   3.4    1.5    1.3    1.7   36.2     19.4   22.7   31.8   51.3   98.8
       CBPS97 |   3.4    1.6    1.4    1.7   40.1     19.3   22.6   31.8   51.4   98.8
       CBPS95 |   3.5    1.7    1.5    2.1   48.0     19.2   22.6   31.9   51.6   98.9
       CBPS93 |   3.6    1.7    1.7    2.3   55.9     18.8   22.6   31.8   51.8   99.0
       CBPS90 |   3.9    1.9    2.1    3.1   69.6     18.6   22.4   32.0   52.2   99.1
       CBPS85 |   4.1    2.3    2.6    4.9   86.6     18.3   22.1   32.0   52.8   99.2
       CBPS80 |   4.6    3.0    3.4    8.2   95.6     18.0   22.1   32.3   53.3   99.2
       CBPS75 |   5.2    3.7    4.7   13.3   99.2     17.5   22.0   32.3   54.1   99.4
       CBPS50 |   9.3   11.3   27.5   71.9  100.0     15.1   21.2   34.7   59.1   99.7
      DISCARD |  44.1   67.1   88.4   98.6   99.9     16.2   24.1   38.0   61.6   99.6
--------------------------------------------------------------------------------------


covered  (mean) covered

----------------------------------------------------------------------------
              |                       augmented and N                       
              | ------------ IPW -----------    ------------ WLS -----------
old_estimator |   25    50   100   200  1000      25    50   100   200  1000
--------------+-------------------------------------------------------------
          RAW | 72.5  48.9  19.1   2.1   0.0    87.8  79.3  60.4  29.2   0.0
  IPW_TRUE_PS | 89.9  91.9  92.2  93.1  94.4    90.7  90.9  91.2  91.4  93.3
  STDPROGDIFF | 95.7              98.9          87.0              41.1      
          IPW | 95.7  97.2  98.2  97.4  93.6    83.2  78.8  67.8  47.3   1.2
         TRIM | 84.8  71.0  40.2   7.7   0.0    87.9  80.8  65.2  37.2   0.0
     EBALANCE | 99.8  99.6  99.7  99.4  75.9    83.4  76.7  67.8  48.5   1.1
           RF | 72.5  90.8  83.0  51.9   0.4    87.8  84.7  82.3  72.5  23.1
      IPWCBPS | 94.9  96.5  96.2  93.1  75.9    84.0  79.4  68.3  47.0   1.0
         CBPS | 95.7  98.0  98.4  98.4  68.4    80.4  77.4  68.3  48.7   1.3
     CBPS99_9 | 96.7  98.6  98.7  98.5  68.5    80.5  77.4  68.3  48.8   1.3
       CBPS99 | 96.5  98.5  98.7  98.4  67.4    80.6  77.4  68.3  48.8   1.3
       CBPS98 | 96.6  98.5  98.7  98.3  63.8    80.6  77.3  68.2  48.7   1.2
       CBPS97 | 96.6  98.4  98.6  98.3  59.9    80.7  77.4  68.2  48.6   1.2
       CBPS95 | 96.5  98.3  98.5  97.9  52.0    80.8  77.4  68.1  48.4   1.1
       CBPS93 | 96.4  98.3  98.3  97.7  44.1    81.2  77.4  68.2  48.2   1.0
       CBPS90 | 96.1  98.1  97.9  96.9  30.4    81.4  77.6  68.0  47.8   0.9
       CBPS85 | 95.9  97.7  97.4  95.1  13.4    81.7  77.9  68.0  47.2   0.8
       CBPS80 | 95.4  97.0  96.6  91.8   4.4    82.0  77.9  67.7  46.7   0.8
       CBPS75 | 94.8  96.3  95.3  86.7   0.8    82.5  78.0  67.7  45.9   0.6
       CBPS50 | 90.7  88.7  72.5  28.1   0.0    84.9  78.8  65.3  40.9   0.3
      DISCARD | 55.8  32.9  11.6   1.4   0.1    83.2  75.9  62.0  38.4   0.4
----------------------------------------------------------------------------


bal_max_asd  (mean) bal_max_asd

--------------------------------------------------------------------------------------
              |                            augmented and N                            
              | -------------- IPW --------------    -------------- WLS --------------
old_estimator |    25     50    100    200   1000       25     50    100    200   1000
--------------+-----------------------------------------------------------------------
          RAW | 0.856  0.783  0.750  0.738  0.733    0.856  0.783  0.750  0.738  0.733
  IPW_TRUE_PS | 0.699  0.512  0.378  0.277  0.132    0.699  0.512  0.378  0.277  0.132
  STDPROGDIFF | 0.765                0.105           0.765                0.105       
          IPW | 0.392  0.270  0.216  0.202  0.224    0.392  0.270  0.216  0.202  0.224
         TRIM | 0.396  0.270  0.212  0.194  0.229    0.396  0.270  0.212  0.194  0.229
     EBALANCE | 0.002  0.001  0.001  0.002  0.000    0.002  0.001  0.001  0.002  0.000
           RF | 0.856  0.467  0.367  0.352  0.256    0.856  0.467  0.367  0.352  0.256
      IPWCBPS | 0.438  0.284  0.195  0.139  0.082    0.438  0.284  0.195  0.139  0.082
         CBPS | 0.240  0.077  0.027  0.011  0.004    0.240  0.077  0.027  0.011  0.004
     CBPS99_9 | 0.226  0.070  0.024  0.010  0.004    0.226  0.070  0.024  0.010  0.004
       CBPS99 | 0.227  0.072  0.025  0.011  0.005    0.227  0.072  0.025  0.011  0.005
       CBPS98 | 0.229  0.075  0.028  0.015  0.010    0.229  0.075  0.028  0.015  0.010
       CBPS97 | 0.231  0.078  0.032  0.019  0.015    0.231  0.078  0.032  0.019  0.015
       CBPS95 | 0.240  0.088  0.042  0.029  0.024    0.240  0.088  0.042  0.029  0.024
       CBPS93 | 0.250  0.099  0.053  0.040  0.035    0.250  0.099  0.053  0.040  0.035
       CBPS90 | 0.264  0.115  0.071  0.057  0.050    0.264  0.115  0.071  0.057  0.050
       CBPS85 | 0.290  0.146  0.101  0.087  0.078    0.290  0.146  0.101  0.087  0.078
       CBPS80 | 0.320  0.179  0.134  0.119  0.108    0.320  0.179  0.134  0.119  0.108
       CBPS75 | 0.351  0.213  0.168  0.153  0.139    0.351  0.213  0.168  0.153  0.139
       CBPS50 | 0.516  0.399  0.359  0.345  0.328    0.516  0.399  0.359  0.345  0.328
      DISCARD | 0.396  0.270  0.212  0.194  0.229    0.396  0.270  0.212  0.194  0.229
--------------------------------------------------------------------------------------


wgt_sd  (mean) wgt_sd

--------------------------------------------------------------------------------------
              |                            augmented and N                            
              | -------------- IPW --------------    -------------- WLS --------------
old_estimator |    25     50    100    200   1000       25     50    100    200   1000
--------------+-----------------------------------------------------------------------
          RAW | 0.000  0.000  0.000  0.000  0.000    0.000  0.000  0.000  0.000  0.000
  IPW_TRUE_PS | 0.519  0.574  0.615  0.642  0.672    0.519  0.574  0.615  0.642  0.672
  STDPROGDIFF | 0.645                0.624           0.645                0.624       
          IPW | 0.638  0.678  0.736  0.862  1.357    0.638  0.678  0.736  0.862  1.357
         TRIM | 0.636  0.683  0.736  0.834  1.389    0.636  0.683  0.736  0.834  1.389
     EBALANCE | 0.000  0.000  0.000  0.000  0.000    0.000  0.000  0.000  0.000  0.000
           RF | 0.000  0.348  0.390  0.371  0.408    0.000  0.348  0.390  0.371  0.408
      IPWCBPS | 0.531  0.524  0.533  0.576  0.766    0.531  0.524  0.533  0.576  0.766
         CBPS | 0.759  0.728  0.680  0.657  0.679    0.759  0.728  0.680  0.657  0.679
     CBPS99_9 | 0.760  0.729  0.680  0.658  0.679    0.760  0.729  0.680  0.658  0.679
       CBPS99 | 0.759  0.727  0.679  0.656  0.677    0.759  0.727  0.679  0.656  0.677
       CBPS98 | 0.754  0.723  0.675  0.652  0.670    0.754  0.723  0.675  0.652  0.670
       CBPS97 | 0.747  0.718  0.670  0.647  0.664    0.747  0.718  0.670  0.647  0.664
       CBPS95 | 0.737  0.706  0.659  0.635  0.651    0.737  0.706  0.659  0.635  0.651
       CBPS93 | 0.724  0.694  0.647  0.624  0.638    0.724  0.694  0.647  0.624  0.638
       CBPS90 | 0.704  0.675  0.628  0.605  0.618    0.704  0.675  0.628  0.605  0.618
       CBPS85 | 0.670  0.641  0.596  0.574  0.585    0.670  0.641  0.596  0.574  0.585
       CBPS80 | 0.634  0.607  0.564  0.542  0.551    0.634  0.607  0.564  0.542  0.551
       CBPS75 | 0.598  0.572  0.531  0.510  0.518    0.598  0.572  0.531  0.510  0.518
       CBPS50 | 0.417  0.397  0.367  0.350  0.350    0.417  0.397  0.367  0.350  0.350
      DISCARD | 0.637  0.683  0.736  0.834  1.389    0.637  0.683  0.736  0.834  1.389
--------------------------------------------------------------------------------------


wgt_cv  (mean) wgt_cv

--------------------------------------------------------------------------------------
              |                            augmented and N                            
              | -------------- IPW --------------    -------------- WLS --------------
old_estimator |    25     50    100    200   1000       25     50    100    200   1000
--------------+-----------------------------------------------------------------------
          RAW | 0.000  0.000  0.000  0.000  0.000    0.000  0.000  0.000  0.000  0.000
  IPW_TRUE_PS | 0.519  0.574  0.615  0.642  0.672    0.519  0.574  0.615  0.642  0.672
  STDPROGDIFF | 0.645                0.624           0.645                0.624       
          IPW | 0.638  0.678  0.736  0.862  1.357    0.638  0.678  0.736  0.862  1.357
         TRIM | 0.636  0.683  0.736  0.834  1.389    0.636  0.683  0.736  0.834  1.389
     EBALANCE | 0.000  0.000  0.000  0.000  0.000    0.000  0.000  0.000  0.000  0.000
           RF | 0.000  0.348  0.390  0.371  0.408    0.000  0.348  0.390  0.371  0.408
      IPWCBPS | 0.531  0.524  0.533  0.576  0.766    0.531  0.524  0.533  0.576  0.766
         CBPS | 0.759  0.728  0.680  0.657  0.679    0.759  0.728  0.680  0.657  0.679
     CBPS99_9 | 0.760  0.729  0.680  0.658  0.679    0.760  0.729  0.680  0.658  0.679
       CBPS99 | 0.759  0.727  0.679  0.656  0.677    0.759  0.727  0.679  0.656  0.677
       CBPS98 | 0.754  0.723  0.675  0.652  0.670    0.754  0.723  0.675  0.652  0.670
       CBPS97 | 0.747  0.718  0.670  0.647  0.664    0.747  0.718  0.670  0.647  0.664
       CBPS95 | 0.737  0.706  0.659  0.635  0.651    0.737  0.706  0.659  0.635  0.651
       CBPS93 | 0.724  0.694  0.647  0.624  0.638    0.724  0.694  0.647  0.624  0.638
       CBPS90 | 0.704  0.675  0.628  0.605  0.618    0.704  0.675  0.628  0.605  0.618
       CBPS85 | 0.670  0.641  0.596  0.574  0.585    0.670  0.641  0.596  0.574  0.585
       CBPS80 | 0.634  0.607  0.564  0.542  0.551    0.634  0.607  0.564  0.542  0.551
       CBPS75 | 0.598  0.572  0.531  0.510  0.518    0.598  0.572  0.531  0.510  0.518
       CBPS50 | 0.417  0.397  0.367  0.350  0.350    0.417  0.397  0.367  0.350  0.350
      DISCARD | 0.637  0.683  0.736  0.834  1.389    0.637  0.683  0.736  0.834  1.389
--------------------------------------------------------------------------------------


wgt_max  (mean) wgt_max

----------------------------------------------------------------------------
              |                       augmented and N                       
              | ------------ IPW -----------    ------------ WLS -----------
old_estimator |   25    50   100   200  1000      25    50   100   200  1000
--------------+-------------------------------------------------------------
          RAW |  1.0   1.0   1.0   1.0   1.0     1.0   1.0   1.0   1.0   1.0
  IPW_TRUE_PS |  2.7   3.5   4.6   5.8   9.4     2.7   3.5   4.6   5.8   9.4
  STDPROGDIFF |  3.2               5.9           3.2               5.9      
          IPW |  3.3   4.4   6.1   9.7  34.3     3.3   4.4   6.1   9.7  34.3
         TRIM |  3.3   4.4   6.1   9.3  35.4     3.3   4.4   6.1   9.3  35.4
     EBALANCE |  1.0   1.0   1.0   1.0   1.0     1.0   1.0   1.0   1.0   1.0
           RF |  1.0   2.2   2.8   3.0   3.7     1.0   2.2   2.8   3.0   3.7
      IPWCBPS |  2.8   3.3   4.2   5.8  16.3     2.8   3.3   4.2   5.8  16.3
         CBPS |  3.5   4.2   5.0   6.3  13.0     3.5   4.2   5.0   6.3  13.0
     CBPS99_9 |  3.5   4.2   5.0   6.3  13.0     3.5   4.2   5.0   6.3  13.0
       CBPS99 |  3.5   4.2   5.0   6.2  12.9     3.5   4.2   5.0   6.2  12.9
       CBPS98 |  3.5   4.2   5.0   6.2  12.7     3.5   4.2   5.0   6.2  12.7
       CBPS97 |  3.5   4.2   4.9   6.1  12.6     3.5   4.2   4.9   6.1  12.6
       CBPS95 |  3.4   4.1   4.8   6.0  12.3     3.4   4.1   4.8   6.0  12.3
       CBPS93 |  3.4   4.0   4.8   5.9  11.9     3.4   4.0   4.8   5.9  11.9
       CBPS90 |  3.3   3.9   4.6   5.7  11.4     3.3   3.9   4.6   5.7  11.4
       CBPS85 |  3.2   3.8   4.4   5.4  10.6     3.2   3.8   4.4   5.4  10.6
       CBPS80 |  3.1   3.6   4.2   5.1   9.8     3.1   3.6   4.2   5.1   9.8
       CBPS75 |  2.9   3.4   3.9   4.7   9.0     2.9   3.4   3.9   4.7   9.0
       CBPS50 |  2.3   2.6   2.8   3.2   5.3     2.3   2.6   2.8   3.2   5.3
      DISCARD |  3.3   4.4   6.1   9.3  35.4     3.3   4.4   6.1   9.3  35.4
----------------------------------------------------------------------------


power_zstat_0  (mean) power_zstat_0

--------------------------------------------------------------------------------------
              |                            augmented and N                            
              | -------------- IPW --------------    -------------- WLS --------------
old_estimator |    25     50    100    200   1000       25     50    100    200   1000
--------------+-----------------------------------------------------------------------
          RAW | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
  IPW_TRUE_PS | 0.025  0.025  0.025  0.025  0.025                                     
  STDPROGDIFF | 0.025                0.025                                            
          IPW | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
         TRIM | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
     EBALANCE | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
           RF | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
      IPWCBPS | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
         CBPS | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
     CBPS99_9 | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
       CBPS99 | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
       CBPS98 | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
       CBPS97 | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
       CBPS95 | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
       CBPS93 | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
       CBPS90 | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
       CBPS85 | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
       CBPS80 | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
       CBPS75 | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
       CBPS50 | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
      DISCARD | 0.025  0.025  0.025  0.025  0.025    0.025  0.025  0.025  0.025  0.025
--------------------------------------------------------------------------------------


bal_mean_asd  (mean) bal_mean_asd

--------------------------------------------------------------------------------------
              |                            augmented and N                            
              | -------------- IPW --------------    -------------- WLS --------------
old_estimator |    25     50    100    200   1000       25     50    100    200   1000
--------------+-----------------------------------------------------------------------
          RAW | 0.475  0.414  0.380  0.362  0.342    0.475  0.414  0.380  0.362  0.342
  IPW_TRUE_PS | 0.398  0.289  0.211  0.155  0.073                                     
  STDPROGDIFF | 0.447                0.063                                            
          IPW | 0.216  0.147  0.116  0.108  0.108    0.216  0.147  0.116  0.108  0.108
         TRIM | 0.219  0.148  0.115  0.102  0.111    0.219  0.148  0.115  0.102  0.111
     EBALANCE | 0.001  0.001  0.001  0.001  0.000    0.001  0.001  0.001  0.001  0.000
           RF | 0.475  0.274  0.205  0.179  0.121    0.475  0.274  0.205  0.179  0.121
      IPWCBPS | 0.240  0.152  0.105  0.076  0.044    0.240  0.152  0.105  0.076  0.044
         CBPS | 0.119  0.034  0.011  0.004  0.001    0.119  0.034  0.011  0.004  0.001
     CBPS99_9 | 0.114  0.032  0.010  0.004  0.001    0.114  0.032  0.010  0.004  0.001
       CBPS99 | 0.115  0.032  0.010  0.004  0.002    0.115  0.032  0.010  0.004  0.002
       CBPS98 | 0.116  0.034  0.012  0.006  0.003    0.116  0.034  0.012  0.006  0.003
       CBPS97 | 0.117  0.035  0.013  0.007  0.005    0.117  0.035  0.013  0.007  0.005
       CBPS95 | 0.122  0.040  0.018  0.012  0.009    0.122  0.040  0.018  0.012  0.009
       CBPS93 | 0.127  0.045  0.023  0.016  0.012    0.127  0.045  0.023  0.016  0.012
       CBPS90 | 0.134  0.053  0.030  0.023  0.018    0.134  0.053  0.030  0.023  0.018
       CBPS85 | 0.148  0.067  0.044  0.036  0.028    0.148  0.067  0.044  0.036  0.028
       CBPS80 | 0.163  0.083  0.058  0.049  0.038    0.163  0.083  0.058  0.049  0.038
       CBPS75 | 0.179  0.099  0.073  0.063  0.049    0.179  0.099  0.073  0.063  0.049
       CBPS50 | 0.266  0.188  0.157  0.141  0.115    0.266  0.188  0.157  0.141  0.115
      DISCARD | 0.219  0.148  0.115  0.102  0.111    0.219  0.148  0.115  0.102  0.111
--------------------------------------------------------------------------------------


wgt_skewness  (mean) wgt_skewness

--------------------------------------------------------------------------------------
              |                            augmented and N                            
              | -------------- IPW --------------    -------------- WLS --------------
old_estimator |    25     50    100    200   1000       25     50    100    200   1000
--------------+-----------------------------------------------------------------------
          RAW |                                                                       
  IPW_TRUE_PS | 0.369  0.353  0.317  0.272  0.165                                     
  STDPROGDIFF | 0.177                0.282                                            
          IPW | 0.445  0.416  0.404  0.409  0.439    0.445  0.416  0.404  0.409  0.439
         TRIM | 0.445  0.419  0.405  0.400  0.443    0.445  0.419  0.405  0.400  0.443
     EBALANCE |                                                                       
           RF |        0.217  0.217  0.150  0.067           0.217  0.217  0.150  0.067
      IPWCBPS | 0.378  0.338  0.320  0.319  0.347    0.378  0.338  0.320  0.319  0.347
         CBPS | 0.405  0.373  0.340  0.316  0.295    0.405  0.373  0.340  0.316  0.295
     CBPS99_9 | 0.408  0.374  0.340  0.316  0.295    0.408  0.374  0.340  0.316  0.295
       CBPS99 | 0.408  0.373  0.340  0.316  0.294    0.408  0.373  0.340  0.316  0.294
       CBPS98 | 0.407  0.372  0.339  0.314  0.292    0.407  0.372  0.339  0.314  0.292
       CBPS97 | 0.406  0.372  0.338  0.313  0.289    0.406  0.372  0.338  0.313  0.289
       CBPS95 | 0.404  0.369  0.335  0.309  0.284    0.404  0.369  0.335  0.309  0.284
       CBPS93 | 0.402  0.366  0.331  0.305  0.279    0.402  0.366  0.331  0.305  0.279
       CBPS90 | 0.397  0.361  0.326  0.299  0.271    0.397  0.361  0.326  0.299  0.271
       CBPS85 | 0.389  0.352  0.316  0.288  0.256    0.389  0.352  0.316  0.288  0.256
       CBPS80 | 0.380  0.343  0.306  0.276  0.241    0.380  0.343  0.306  0.276  0.241
       CBPS75 | 0.370  0.333  0.295  0.264  0.225    0.370  0.333  0.295  0.264  0.225
       CBPS50 | 0.298  0.265  0.226  0.192  0.138    0.298  0.265  0.226  0.192  0.138
      DISCARD | 0.445  0.419  0.405  0.400  0.443    0.445  0.419  0.405  0.400  0.443
--------------------------------------------------------------------------------------


wgt_kurtosis  (mean) wgt_kurtosis

--------------------------------------------------------------------------------------
              |                            augmented and N                            
              | -------------- IPW --------------    -------------- WLS --------------
old_estimator |    25     50    100    200   1000       25     50    100    200   1000
--------------+-----------------------------------------------------------------------
          RAW |                                                                       
  IPW_TRUE_PS | 0.269  0.221  0.174  0.130  0.055                                     
  STDPROGDIFF | 0.403                0.138                                            
          IPW | 0.344  0.291  0.270  0.276  0.311    0.344  0.291  0.270  0.276  0.311
         TRIM | 0.345  0.294  0.271  0.265  0.314    0.345  0.294  0.271  0.265  0.314
     EBALANCE |                                                                       
           RF |        0.123  0.098  0.050  0.010           0.123  0.098  0.050  0.010
      IPWCBPS | 0.279  0.215  0.187  0.183  0.215    0.279  0.215  0.187  0.183  0.215
         CBPS | 0.280  0.228  0.190  0.168  0.161    0.280  0.228  0.190  0.168  0.161
     CBPS99_9 | 0.283  0.229  0.190  0.168  0.161    0.283  0.229  0.190  0.168  0.161
       CBPS99 | 0.283  0.229  0.189  0.168  0.160    0.283  0.229  0.189  0.168  0.160
       CBPS98 | 0.282  0.228  0.189  0.167  0.158    0.282  0.228  0.189  0.167  0.158
       CBPS97 | 0.281  0.227  0.188  0.165  0.156    0.281  0.227  0.188  0.165  0.156
       CBPS95 | 0.280  0.225  0.186  0.163  0.152    0.280  0.225  0.186  0.163  0.152
       CBPS93 | 0.279  0.223  0.183  0.160  0.148    0.279  0.223  0.183  0.160  0.148
       CBPS90 | 0.276  0.220  0.179  0.155  0.142    0.276  0.220  0.179  0.155  0.142
       CBPS85 | 0.270  0.213  0.172  0.147  0.131    0.270  0.213  0.172  0.147  0.131
       CBPS80 | 0.264  0.207  0.165  0.138  0.120    0.264  0.207  0.165  0.138  0.120
       CBPS75 | 0.258  0.200  0.157  0.130  0.108    0.258  0.200  0.157  0.130  0.108
       CBPS50 | 0.217  0.158  0.114  0.084  0.051    0.217  0.158  0.114  0.084  0.051
      DISCARD | 0.345  0.294  0.271  0.265  0.314    0.345  0.294  0.271  0.265  0.314
--------------------------------------------------------------------------------------


Nt  (mean) Nt

------------------------------------------------------------------------------------------------
              |                                 augmented and N                                 
              | ----------------- IPW ----------------    ----------------- WLS ----------------
old_estimator |     25      50     100     200    1000        25      50     100     200    1000
--------------+---------------------------------------------------------------------------------
          RAW | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
  IPW_TRUE_PS | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
  STDPROGDIFF | 12.467                  99.899            12.467                  99.899        
          IPW | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
         TRIM | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
     EBALANCE | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
           RF | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
      IPWCBPS | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
         CBPS | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
     CBPS99_9 | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
       CBPS99 | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
       CBPS98 | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
       CBPS97 | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
       CBPS95 | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
       CBPS93 | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
       CBPS90 | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
       CBPS85 | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
       CBPS80 | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
       CBPS75 | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
       CBPS50 | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
      DISCARD | 12.467  24.949  49.885  99.899  500.06    12.467  24.949  49.885  99.899  500.06
------------------------------------------------------------------------------------------------


mae  (mean) mae

----------------------------------------------------------------------------------------------------------
              |                                      augmented and N                                      
              | ------------------- IPW -------------------    ------------------- WLS -------------------
old_estimator |      25       50      100      200     1000         25       50      100      200     1000
--------------+-------------------------------------------------------------------------------------------
          RAW | 20.3917  20.1462  20.0777  19.9124  19.9630     6.3829   5.8174   6.0153   6.2876   6.5101
  IPW_TRUE_PS | 12.3115   8.6184   6.4724   4.7300   2.1081     5.1961   3.6330   2.6755   1.9992   0.9584
  STDPROGDIFF |  9.8082                     6.0467              6.2690                     5.9519         
          IPW |  9.6744   7.2595   5.8271   4.8350   3.1032     5.8428   4.9388   4.8063   5.1265   5.7854
         TRIM | 15.6583  15.3221  15.2872  15.0851  15.0897     6.0274   5.4531   5.4418   5.5223   5.7210
     EBALANCE |  5.3226   5.0607   4.7958   4.6621   4.4318     5.3150   5.0459   4.7659   4.6306   4.4244
           RF | 20.3917  11.1465  10.2806  10.3287   7.8760     6.3829   4.5937   3.8598   3.6422   2.8221
      IPWCBPS | 10.6877   8.9237   7.6972   6.7199   5.0200     5.8114   4.9874   4.8270   5.1505   5.7655
         CBPS |  7.9771   5.8998   5.1808   5.2402   5.7728     6.1832   5.1065   4.8705   5.0968   5.7517
     CBPS99_9 |  7.8906   5.8461   5.1793   5.2282   5.7718     6.1430   5.0755   4.8638   5.0956   5.7517
       CBPS99 |  7.9261   5.8504   5.1903   5.2553   5.8072     6.1339   5.0760   4.8635   5.0953   5.7525
       CBPS98 |  7.9214   5.9003   5.2539   5.3465   5.9344     6.1655   5.0773   4.8682   5.0956   5.7566
       CBPS97 |  7.9270   5.9428   5.3245   5.4433   6.0516     6.1474   5.0710   4.8681   5.1029   5.7566
       CBPS95 |  8.0281   6.1187   5.5050   5.6730   6.3045     6.1522   5.0701   4.8845   5.1129   5.7567
       CBPS93 |  8.0833   6.2697   5.7208   5.9231   6.5460     6.1134   5.0744   4.8902   5.1331   5.7601
       CBPS90 |  8.2866   6.5060   6.0354   6.3250   6.9311     6.1329   5.0649   4.8842   5.1459   5.7616
       CBPS85 |  8.6392   6.9743   6.7088   7.0117   7.5945     6.1227   5.0709   4.9150   5.1731   5.7651
       CBPS80 |  9.1170   7.5465   7.3414   7.7360   8.2982     6.0917   5.0872   4.9208   5.2163   5.7724
       CBPS75 |  9.5971   8.1099   8.0918   8.4728   9.0355     6.0895   5.0749   4.9835   5.2663   5.7708
       CBPS50 | 12.9144  12.0020  12.2692  12.7569  13.2206     6.0739   5.2868   5.2780   5.5415   5.8020
      DISCARD | 33.3353  34.5218  35.3402  35.9761  36.4263    15.4307  13.1036  12.7807  13.8814  14.7415
----------------------------------------------------------------------------------------------------------


pct_bias  (mean) pct_bias

------------------------------------------------------------------------------------------------
              |                                 augmented and N                                 
              | ----------------- IPW ----------------    ----------------- WLS ----------------
old_estimator |     25      50     100     200    1000        25      50     100     200    1000
--------------+---------------------------------------------------------------------------------
          RAW | -144.5  -204.6  -285.7  -402.1  -907.1     -71.4  -112.4  -166.0  -241.5  -547.1
  IPW_TRUE_PS |  -20.6   -15.6    -9.5    -6.7    -2.5     -22.1   -17.9   -11.8    -9.7    -2.5
  STDPROGDIFF |  -34.0                  -185.9             -27.4                  -190.7        
          IPW |  -90.7   -75.7   -51.8   -22.9    11.0     -56.0   -82.2  -117.1  -164.6  -285.3
         TRIM | -131.0  -192.6  -281.0  -402.3  -865.4     -67.0  -102.4  -154.6  -223.2  -501.8
     EBALANCE |  -56.1   -85.1  -129.6  -189.5  -422.6     -56.0   -84.8  -128.9  -188.1  -422.0
           RF | -144.5  -158.3  -228.1  -335.6  -617.7     -71.4   -85.8  -120.2  -177.4  -350.3
      IPWCBPS | -111.7  -143.6  -174.8  -201.8  -197.5     -57.3   -85.5  -121.3  -170.4  -339.0
         CBPS |  -76.1   -83.6  -107.7  -154.0  -314.9     -52.2   -75.4  -109.1  -159.1  -342.0
     CBPS99_9 |  -76.5   -85.2  -110.9  -156.1  -322.4     -51.4   -75.1  -109.2  -159.0  -342.2
       CBPS99 |  -77.5   -86.1  -111.7  -157.0  -324.4     -51.9   -75.2  -109.3  -159.2  -342.3
       CBPS98 |  -77.8   -87.4  -113.7  -160.6  -334.3     -51.5   -75.7  -109.6  -159.6  -343.0
       CBPS97 |  -78.7   -88.5  -116.2  -164.6  -343.4     -52.1   -75.7  -109.9  -160.1  -343.8
       CBPS95 |  -80.7   -92.6  -122.1  -173.8  -362.3     -52.4   -76.7  -110.8  -161.3  -345.3
       CBPS93 |  -82.8   -96.3  -128.6  -183.2  -381.7     -52.7   -77.2  -111.8  -162.4  -346.9
       CBPS90 |  -86.4  -102.8  -138.5  -198.3  -412.5     -53.5   -78.3  -113.3  -164.2  -349.4
       CBPS85 |  -91.9  -113.6  -155.8  -223.8  -467.0     -54.9   -80.4  -115.9  -167.4  -353.9
       CBPS80 |  -97.4  -124.4  -172.7  -249.6  -524.0     -56.3   -82.5  -118.6  -170.8  -358.8
       CBPS75 | -102.4  -133.7  -188.7  -274.8  -583.6     -57.5   -84.6  -121.6  -174.5  -364.4
       CBPS50 | -123.2  -170.6  -243.0  -342.7  -740.8     -64.4   -96.3  -138.5  -196.7  -405.2
      DISCARD | -121.8  -177.9  -250.9  -344.4  -693.4     -17.9   -75.7  -124.5  -188.0  -393.3
------------------------------------------------------------------------------------------------


rmse  (firstnm) rmse

--------------------------------------------------------------------------------------
              |                            augmented and N                            
              | -------------- IPW --------------    -------------- WLS --------------
old_estimator |    25     50    100    200   1000       25     50    100    200   1000
--------------+-----------------------------------------------------------------------
          RAW | 24.57  22.36  21.22  20.61  20.11     9.36   7.73   7.14   6.87   6.62
  IPW_TRUE_PS | 18.01  13.01   9.62   6.90   3.17     7.91   5.51   4.05   3.00   1.44
  STDPROGDIFF | 13.42                 6.60            8.51                 6.26       
          IPW | 13.59  10.16   8.57   8.85  10.65     8.82   7.10   6.30   6.09   6.32
         TRIM | 20.00  17.53  16.29  15.62  15.10     8.89   7.34   6.55   6.13   5.83
     EBALANCE |  8.14   7.17   6.08   5.30   4.57     8.14   7.16   6.06   5.27   4.56
           RF | 24.57  13.18  11.41  10.86   8.03     9.36   6.48   5.00   4.19   2.95
      IPWCBPS | 14.60  10.88   8.83   7.40   5.35     8.83   7.07   6.29   6.06   6.19
         CBPS | 13.01   8.94   7.10   6.33   6.25     9.32   7.35   6.38   6.06   6.15
     CBPS99_9 | 12.30   8.60   6.91   6.29   6.23     9.23   7.32   6.36   6.05   6.14
       CBPS99 | 12.31   8.61   6.93   6.31   6.26     9.22   7.32   6.35   6.05   6.14
       CBPS98 | 12.33   8.65   6.98   6.37   6.38     9.24   7.32   6.36   6.06   6.14
       CBPS97 | 12.32   8.70   7.04   6.46   6.48     9.23   7.32   6.36   6.06   6.14
       CBPS95 | 12.45   8.83   7.19   6.65   6.71     9.22   7.31   6.36   6.06   6.14
       CBPS93 | 12.60   8.98   7.37   6.86   6.94     9.19   7.30   6.36   6.06   6.14
       CBPS90 | 12.80   9.17   7.66   7.19   7.30     9.18   7.29   6.36   6.07   6.14
       CBPS85 | 13.13   9.63   8.18   7.80   7.93     9.14   7.28   6.36   6.08   6.14
       CBPS80 | 13.62  10.13   8.79   8.46   8.59     9.12   7.27   6.37   6.09   6.13
       CBPS75 | 14.07  10.72   9.47   9.16   9.30     9.10   7.26   6.39   6.10   6.13
       CBPS50 | 17.11  14.43  13.62  13.49  13.46     9.03   7.33   6.55   6.25   6.10
      DISCARD | 40.83  39.35  37.98  37.30  36.68    54.38  18.32  16.17  15.61  15.14
--------------------------------------------------------------------------------------


impact_est_var  (firstnm) impact_est_var

------------------------------------------------------------------------------------------------
              |                                 augmented and N                                 
              | ----------------- IPW ----------------    ----------------- WLS ----------------
old_estimator |     25      50     100     200    1000        25      50     100     200    1000
--------------+---------------------------------------------------------------------------------
          RAW | 195.57   96.40   49.16   24.75    4.86     58.08   26.42   13.57    6.90    1.42
  IPW_TRUE_PS | 311.08  165.23   91.74   47.37   10.04     59.60   29.42   16.15    8.94    2.07
  STDPROGDIFF | 167.98                    9.79             70.25                    8.48        
          IPW | 101.37   65.66   57.92   74.45  112.18     59.25   30.08   16.74   10.02    4.37
         TRIM | 147.31   65.27   29.82   14.20    3.01     54.50   26.30   12.67    6.27    1.30
     EBALANCE |  50.52   29.81   13.78    6.11    1.11     50.49   29.82   13.80    6.12    1.11
           RF | 195.57   49.55   20.98    9.61    1.65     58.08   24.17   10.24    4.24    0.65
      IPWCBPS |  94.80   38.66   19.20   10.79    5.85     58.77   28.93   16.00    9.41    3.07
         CBPS | 107.17   47.10   23.31   11.91    3.58     68.35   34.47   18.57   10.39    2.97
     CBPS99_9 |  95.46   42.86   21.42   11.50    3.40     67.44   34.26   18.42   10.39    2.97
       CBPS99 |  94.76   42.54   21.39   11.48    3.40     67.02   34.25   18.41   10.37    2.97
       CBPS98 |  94.70   42.41   21.27   11.36    3.34     67.55   34.04   18.36   10.34    2.96
       CBPS97 |  93.78   42.44   21.07   11.24    3.29     66.99   34.05   18.31   10.30    2.94
       CBPS95 |  93.96   42.01   20.78   10.98    3.19     66.71   33.65   18.14   10.21    2.92
       CBPS93 |  94.19   41.84   20.45   10.79    3.09     66.12   33.42   17.97   10.11    2.89
       CBPS90 |  93.75   40.91   20.09   10.47    2.96     65.51   32.93   17.71    9.97    2.85
       CBPS85 |  93.42   40.49   19.54   10.11    2.76     64.22   32.18   17.29    9.72    2.78
       CBPS80 |  95.26   40.27   19.40    9.89    2.60     63.12   31.44   16.87    9.47    2.71
       CBPS75 |  96.67   41.26   19.65    9.82    2.46     62.24   30.77   16.48    9.21    2.63
       CBPS50 | 116.23   53.27   26.86   14.28    3.24     57.68   27.85   14.70    8.01    2.14
      DISCARD | 671.65  371.69  197.82  108.19   27.42    2865.35  213.38  102.55   53.71   13.91
------------------------------------------------------------------------------------------------

. 
. 
. di _n(10) "Tables with selected results" _n(10)










Tables with selected results











. 
. // tall table with columns as N's
. foreach v of var rmse bias impact_est_var {
  2.   di _n(2) as res `"`v'  `:var lab `v''"'
  3.   preserve
  4.   keep if `ifstmnt'
  5.   keep    estimator N augmented `v'
  6.   tabdisp estimator N augmented, c(`v') format(`:format `v'') cellwidth(6) csep(2) stubwidth(11)
  7. 
.   // rebuild table and export to LaTeX snippet
.   isid estimator augmented N
  8.   rename `v' `v'_
  9.   reshape wide `v'_ , i(estimator augmented) j(N)
 10.   rename (`v'_*) (`v'_*_)
 11.   reshape wide `v'_*, i(estimator) j(augmented)
 12.   unab vvv: `v'_*
 13.   mata: st_matrix("dta", st_data(., "`vvv'"))
 14.   mata: st_matrixcolstripe("dta", (J(`:list sizeof vvv', 1, ""), tokens("`vvv'")'))
 15.   mata: st_matrixrowstripe("dta", (J(`c(N)', 1, ""), st_vlmap("estimator_recode", st_data(., "estimator"))))
 16.   frmttable using "sims/sim`sim'/LaTeX summary.tex", s(dta) tex `=cond("`v'"=="rmse", "replace", "addtable")' fragment plain sdec(2) coljust(r{r}r) posttext("columns refer to 
> N and 0/1 for regression adjustment.")
 17.   restore
 18. }


rmse  (firstnm) rmse
(132 observations deleted)

--------------------------------------------------------------
            |                 augmented and N                 
RECODE of   | --------- IPW --------    --------- WLS --------
estimator   |     50     200    1000        50     200    1000
------------+-------------------------------------------------
Logit regre |  10.16    8.85   10.65      7.10    6.09    6.32
Logit regre |  17.53   15.62   15.10      7.34    6.13    5.83
Random fore |  13.18   10.86    8.03      6.48    4.19    2.95
CBPS, over  |  10.88    7.40    5.35      7.07    6.06    6.19
CBPS, just  |   8.94    6.33    6.25      7.35    6.06    6.15
  PCBPS 99% |   8.61    6.31    6.26      7.32    6.05    6.14
  PCBPS 97% |   8.70    6.46    6.48      7.32    6.06    6.14
  PCBPS 95% |   8.83    6.65    6.71      7.31    6.06    6.14
  PCBPS 90% |   9.17    7.19    7.30      7.29    6.07    6.14
  PCBPS 75% |  10.72    9.16    9.30      7.26    6.10    6.13
True propen |  13.01    6.90    3.17      5.51    3.00    1.44
None (unwei |  22.36   20.61   20.11      7.73    6.87    6.62
--------------------------------------------------------------
(note: j = 50 200 1000)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       72   ->      24
Number of variables                   4   ->       5
j variable (3 values)                 N   ->   (dropped)
xij variables:
                                  rmse_   ->   rmse_50 rmse_200 rmse_1000
-----------------------------------------------------------------------------
(note: j = 0 1)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       24   ->      12
Number of variables                   5   ->       7
j variable (2 values)         augmented   ->   (dropped)
xij variables:
                               rmse_50_   ->   rmse_50_0 rmse_50_1
                              rmse_200_   ->   rmse_200_0 rmse_200_1
                             rmse_1000_   ->   rmse_1000_0 rmse_1000_1
-----------------------------------------------------------------------------

                                    -----------------------------------------------------------------------------------------------------------
                                                                       rmse_50_0  rmse_200_0  rmse_1000_0  rmse_50_1  rmse_200_1  rmse_1000_1 
                                    -----------------------------------------------------------------------------------------------------------
                                     Logit regression                    10.16       8.85        10.65       7.10        6.09        6.32     
                                     Logit regression, with trimming     17.53      15.62        15.10       7.34        6.13        5.83     
                                     Random forest classifier            13.18      10.86        8.03        6.48        4.19        2.95     
                                     CBPS, over identified               10.88       7.40        5.35        7.07        6.06        6.19     
                                     CBPS, just identified               8.94        6.33        6.25        7.35        6.06        6.15     
                                     PCBPS 99%                           8.61        6.31        6.26        7.32        6.05        6.14     
                                     PCBPS 97%                           8.70        6.46        6.48        7.32        6.06        6.14     
                                     PCBPS 95%                           8.83        6.65        6.71        7.31        6.06        6.14     
                                     PCBPS 90%                           9.17        7.19        7.30        7.29        6.07        6.14     
                                     PCBPS 75%                           10.72       9.16        9.30        7.26        6.10        6.13     
                                     True propensity score               13.01       6.90        3.17        5.51        3.00        1.44     
                                     None (unweighted data)              22.36      20.61        20.11       7.73        6.87        6.62     
                                    -----------------------------------------------------------------------------------------------------------

columns refer to N and 0/1 for regression adjustment.


bias  (mean) bias
(132 observations deleted)

--------------------------------------------------------------
            |                 augmented and N                 
RECODE of   | --------- IPW --------    --------- WLS --------
estimator   |     50     200    1000        50     200    1000
------------+-------------------------------------------------
Logit regre |  -6.13   -1.97    1.17     -4.51   -5.21   -5.96
Logit regre | -15.56  -15.16  -15.00     -5.25   -5.59   -5.72
Random fore | -11.14  -10.40   -7.93     -4.22   -3.65   -2.83
CBPS, over  |  -8.93   -6.63   -4.78     -4.60   -5.23   -5.94
CBPS, just  |  -5.74   -5.31   -5.96     -4.42   -5.13   -5.90
  PCBPS 99% |  -5.62   -5.32   -5.99     -4.40   -5.13   -5.90
  PCBPS 97% |  -5.77   -5.52   -6.22     -4.42   -5.14   -5.90
  PCBPS 95% |  -6.00   -5.76   -6.47     -4.45   -5.15   -5.90
  PCBPS 90% |  -6.58   -6.42   -7.09     -4.49   -5.18   -5.90
  PCBPS 75% |  -8.59   -8.61   -9.16     -4.69   -5.30   -5.91
True propen |  -2.00   -0.46   -0.08     -0.97   -0.29   -0.04
None (unwei | -20.09  -20.00  -19.99     -5.78   -6.34   -6.51
--------------------------------------------------------------
(note: j = 50 200 1000)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       72   ->      24
Number of variables                   4   ->       5
j variable (3 values)                 N   ->   (dropped)
xij variables:
                                  bias_   ->   bias_50 bias_200 bias_1000
-----------------------------------------------------------------------------
(note: j = 0 1)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       24   ->      12
Number of variables                   5   ->       7
j variable (2 values)         augmented   ->   (dropped)
xij variables:
                               bias_50_   ->   bias_50_0 bias_50_1
                              bias_200_   ->   bias_200_0 bias_200_1
                             bias_1000_   ->   bias_1000_0 bias_1000_1
-----------------------------------------------------------------------------

                                    -----------------------------------------------------------------------------------------------------------
                                                                       bias_50_0  bias_200_0  bias_1000_0  bias_50_1  bias_200_1  bias_1000_1 
                                    -----------------------------------------------------------------------------------------------------------
                                     Logit regression                    -6.13      -1.97        1.17        -4.51      -5.21        -5.96    
                                     Logit regression, with trimming    -15.56      -15.16      -15.00       -5.25      -5.59        -5.72    
                                     Random forest classifier           -11.14      -10.40       -7.93       -4.22      -3.65        -2.83    
                                     CBPS, over identified               -8.93      -6.63        -4.78       -4.60      -5.23        -5.94    
                                     CBPS, just identified               -5.74      -5.31        -5.96       -4.42      -5.13        -5.90    
                                     PCBPS 99%                           -5.62      -5.32        -5.99       -4.40      -5.13        -5.90    
                                     PCBPS 97%                           -5.77      -5.52        -6.22       -4.42      -5.14        -5.90    
                                     PCBPS 95%                           -6.00      -5.76        -6.47       -4.45      -5.15        -5.90    
                                     PCBPS 90%                           -6.58      -6.42        -7.09       -4.49      -5.18        -5.90    
                                     PCBPS 75%                           -8.59      -8.61        -9.16       -4.69      -5.30        -5.91    
                                     True propensity score               -2.00      -0.46        -0.08       -0.97      -0.29        -0.04    
                                     None (unweighted data)             -20.09      -20.00      -19.99       -5.78      -6.34        -6.51    
                                    -----------------------------------------------------------------------------------------------------------

columns refer to N and 0/1 for regression adjustment.


impact_est_var  (firstnm) impact_est_var
(132 observations deleted)

--------------------------------------------------------------
            |                 augmented and N                 
RECODE of   | --------- IPW --------    --------- WLS --------
estimator   |     50     200    1000        50     200    1000
------------+-------------------------------------------------
Logit regre |  65.66   74.45  112.18     30.08   10.02    4.37
Logit regre |  65.27   14.20    3.01     26.30    6.27    1.30
Random fore |  49.55    9.61    1.65     24.17    4.24    0.65
CBPS, over  |  38.66   10.79    5.85     28.93    9.41    3.07
CBPS, just  |  47.10   11.91    3.58     34.47   10.39    2.97
  PCBPS 99% |  42.54   11.48    3.40     34.25   10.37    2.97
  PCBPS 97% |  42.44   11.24    3.29     34.05   10.30    2.94
  PCBPS 95% |  42.01   10.98    3.19     33.65   10.21    2.92
  PCBPS 90% |  40.91   10.47    2.96     32.93    9.97    2.85
  PCBPS 75% |  41.26    9.82    2.46     30.77    9.21    2.63
True propen | 165.23   47.37   10.04     29.42    8.94    2.07
None (unwei |  96.40   24.75    4.86     26.42    6.90    1.42
--------------------------------------------------------------
(note: j = 50 200 1000)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       72   ->      24
Number of variables                   4   ->       5
j variable (3 values)                 N   ->   (dropped)
xij variables:
                        impact_est_var_   ->   impact_est_var_50 impact_est_var_200 impact_est_var_1000
-----------------------------------------------------------------------------
(note: j = 0 1)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       24   ->      12
Number of variables                   5   ->       7
j variable (2 values)         augmented   ->   (dropped)
xij variables:
                     impact_est_var_50_   ->   impact_est_var_50_0 impact_est_var_50_1
                    impact_est_var_200_   ->   impact_est_var_200_0 impact_est_var_200_1
                   impact_est_var_1000_   ->   impact_est_var_1000_0 impact_est_var_1000_1
-----------------------------------------------------------------------------

      -----------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                         impact_est_var_50_0  impact_est_var_200_0  impact_est_var_1000_0  impact_est_var_50_1  impact_est_var_200_1  impact_est_var_1000_1 
      -----------------------------------------------------------------------------------------------------------------------------------------------------------------------
       Logit regression                         65.66                74.45                 112.18                 30.08                10.02                  4.37          
       Logit regression, with trimming          65.27                14.20                  3.01                  26.30                 6.27                  1.30          
       Random forest classifier                 49.55                 9.61                  1.65                  24.17                 4.24                  0.65          
       CBPS, over identified                    38.66                10.79                  5.85                  28.93                 9.41                  3.07          
       CBPS, just identified                    47.10                11.91                  3.58                  34.47                10.39                  2.97          
       PCBPS 99%                                42.54                11.48                  3.40                  34.25                10.37                  2.97          
       PCBPS 97%                                42.44                11.24                  3.29                  34.05                10.30                  2.94          
       PCBPS 95%                                42.01                10.98                  3.19                  33.65                10.21                  2.92          
       PCBPS 90%                                40.91                10.47                  2.96                  32.93                 9.97                  2.85          
       PCBPS 75%                                41.26                 9.82                  2.46                  30.77                 9.21                  2.63          
       True propensity score                   165.23                47.37                  10.04                 29.42                 8.94                  2.07          
       None (unweighted data)                   96.40                24.75                  4.86                  26.42                 6.90                  1.42          
      -----------------------------------------------------------------------------------------------------------------------------------------------------------------------

columns refer to N and 0/1 for regression adjustment.

. 
. // table with columns for each statistic
. preserve

.   keep if `ifstmnt' & `2ns'
(156 observations deleted)

.   keep estimator N augmented wgt_cv wgt_max bal_mean_asd bal_max_asd

.   keep if aug==0 // these stats are all identical for aug and non-aug estimators
(24 observations deleted)

.   local c=0

.   foreach v of var           wgt_cv wgt_max bal_mean_asd bal_max_asd {
  2.     rename `v' stat`++c'
  3.     local def `macval(def)' `c' "`v'"
  4.   }

.   qui reshape long stat, i(estimator N augmented)

.   label define statname `def'

.   label val _j statname

.   tabdisp estimator  N _j, by(augmented) c(stat) cellwidth(6) csep(2) stubwidth(13)

------------------------------------------------------------------------------------
augmented and |                               _j and N                              
RECODE of     | --- wgt_cv ---    --- wgt_max --    - bal_mean_a -    - bal_max_as -
estimator     |     50    1000        50    1000        50    1000        50    1000
--------------+---------------------------------------------------------------------
IPW           |
Logit regress |  0.678   1.357     4.370  34.315     0.147   0.108     0.270   0.224
Logit regress |  0.683   1.389     4.407  35.389     0.148   0.111     0.270   0.229
Random forest |  0.348   0.408     2.245   3.685     0.274   0.121     0.467   0.256
CBPS, over id |  0.524   0.766     3.317  16.321     0.152   0.044     0.284   0.082
CBPS, just id |  0.728   0.679     4.214  12.962     0.034   0.001     0.077   0.004
    PCBPS 99% |  0.727   0.677     4.211  12.900     0.032   0.002     0.072   0.005
    PCBPS 97% |  0.718   0.664     4.167  12.582     0.035   0.005     0.078   0.015
    PCBPS 95% |  0.706   0.651     4.105  12.260     0.040   0.009     0.088   0.024
    PCBPS 90% |  0.675   0.618     3.943  11.447     0.053   0.018     0.115   0.050
    PCBPS 75% |  0.572   0.518     3.420   9.019     0.099   0.049     0.213   0.139
True propensi |  0.574   0.672     3.535   9.379     0.289   0.073     0.512   0.132
None (unweigh |  0.000   0.000     1.000   1.000     0.414   0.342     0.783   0.733
------------------------------------------------------------------------------------

. 
. // rebuild and export to LaTeX snippet
. restore, preserve

.   keep if `ifstmnt' & `2ns'
(156 observations deleted)

.   keep estimator N augmented wgt_cv wgt_max bal_mean_asd bal_max_asd

.   keep if aug==0 // these stats are all identical for aug and non-aug estimators
(24 observations deleted)

.   reshape wide wgt_cv wgt_max bal_mean_asd bal_max_asd , i(estimator) j(N)
(note: j = 50 1000)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       24   ->      12
Number of variables                   7   ->      10
j variable (2 values)                 N   ->   (dropped)
xij variables:
                                 wgt_cv   ->   wgt_cv50 wgt_cv1000
                                wgt_max   ->   wgt_max50 wgt_max1000
                           bal_mean_asd   ->   bal_mean_asd50 bal_mean_asd1000
                            bal_max_asd   ->   bal_max_asd50 bal_max_asd1000
-----------------------------------------------------------------------------

.   unab vvv: wgt_cv* wgt_max* bal_mean_asd* bal_max_asd*

.   mata: st_matrix("dta", st_data(., "`vvv'"))

.   mata: st_matrixcolstripe("dta", (J(`:list sizeof vvv', 1, ""), tokens("`vvv'")'))

.   mata: st_matrixrowstripe("dta", (J(`c(N)', 1, ""), st_vlmap("estimator_recode", st_data(., "estimator"))))

.   frmttable using "sims/sim`sim'/LaTeX summary.tex", s(dta) tex addtable fragment sdec(3) coljust(r{r}r)

                ---------------------------------------------------------------------------------------------------------------------------------------------------
                                                   wgt_cv50  wgt_cv1000  wgt_max50  wgt_max1000  bal_mean_asd50  bal_mean_asd1000  bal_max_asd50  bal_max_asd1000 
                ---------------------------------------------------------------------------------------------------------------------------------------------------
                 Logit regression                   0.678      1.357       4.370      34.315         0.147            0.108            0.270           0.224      
                 Logit regression, with trimming    0.683      1.389       4.407      35.389         0.148            0.111            0.270           0.229      
                 Random forest classifier           0.348      0.408       2.245       3.685         0.274            0.121            0.467           0.256      
                 CBPS, over identified              0.524      0.766       3.317      16.321         0.152            0.044            0.284           0.082      
                 CBPS, just identified              0.728      0.679       4.214      12.962         0.034            0.001            0.077           0.004      
                 PCBPS 99%                          0.727      0.677       4.211      12.900         0.032            0.002            0.072           0.005      
                 PCBPS 97%                          0.718      0.664       4.167      12.582         0.035            0.005            0.078           0.015      
                 PCBPS 95%                          0.706      0.651       4.105      12.260         0.040            0.009            0.088           0.024      
                 PCBPS 90%                          0.675      0.618       3.943      11.447         0.053            0.018            0.115           0.050      
                 PCBPS 75%                          0.572      0.518       3.420       9.019         0.099            0.049            0.213           0.139      
                 True propensity score              0.574      0.672       3.535       9.379         0.289            0.073            0.512           0.132      
                 None (unweighted data)             0.000      0.000       1.000       1.000         0.414            0.342            0.783           0.733      
                ---------------------------------------------------------------------------------------------------------------------------------------------------


. 
. restore

. 
. log close sim`sim'_tables
      name:  sim11_tables
       log:  C:\Users\kkranker\Documents\Stata\psweight\code-psweight\sims/sim11/summary_tables.log
  log type:  text
 closed on:  21 Oct 2019, 13:14:47
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
